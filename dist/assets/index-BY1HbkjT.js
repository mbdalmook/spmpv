var op=Object.defineProperty;var lp=(r,n,s)=>n in r?op(r,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[n]=s;var Kd=(r,n,s)=>lp(r,typeof n!="symbol"?n+"":n,s);(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))o(u);new MutationObserver(u=>{for(const d of u)if(d.type==="childList")for(const f of d.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&o(f)}).observe(document,{childList:!0,subtree:!0});function s(u){const d={};return u.integrity&&(d.integrity=u.integrity),u.referrerPolicy&&(d.referrerPolicy=u.referrerPolicy),u.crossOrigin==="use-credentials"?d.credentials="include":u.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function o(u){if(u.ep)return;u.ep=!0;const d=s(u);fetch(u.href,d)}})();var Il={exports:{}},Vs={},Rl={exports:{}},Ee={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jd;function up(){if(Jd)return Ee;Jd=1;var r=Symbol.for("react.element"),n=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),u=Symbol.for("react.profiler"),d=Symbol.for("react.provider"),f=Symbol.for("react.context"),m=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),y=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),b=Symbol.iterator;function _(C){return C===null||typeof C!="object"?null:(C=b&&C[b]||C["@@iterator"],typeof C=="function"?C:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},T=Object.assign,j={};function E(C,N,ae){this.props=C,this.context=N,this.refs=j,this.updater=ae||w}E.prototype.isReactComponent={},E.prototype.setState=function(C,N){if(typeof C!="object"&&typeof C!="function"&&C!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,C,N,"setState")},E.prototype.forceUpdate=function(C){this.updater.enqueueForceUpdate(this,C,"forceUpdate")};function D(){}D.prototype=E.prototype;function V(C,N,ae){this.props=C,this.context=N,this.refs=j,this.updater=ae||w}var z=V.prototype=new D;z.constructor=V,T(z,E.prototype),z.isPureReactComponent=!0;var q=Array.isArray,$=Object.prototype.hasOwnProperty,M={current:null},Y={key:!0,ref:!0,__self:!0,__source:!0};function re(C,N,ae){var me,we={},H=null,L=null;if(N!=null)for(me in N.ref!==void 0&&(L=N.ref),N.key!==void 0&&(H=""+N.key),N)$.call(N,me)&&!Y.hasOwnProperty(me)&&(we[me]=N[me]);var te=arguments.length-2;if(te===1)we.children=ae;else if(1<te){for(var O=Array(te),Z=0;Z<te;Z++)O[Z]=arguments[Z+2];we.children=O}if(C&&C.defaultProps)for(me in te=C.defaultProps,te)we[me]===void 0&&(we[me]=te[me]);return{$$typeof:r,type:C,key:H,ref:L,props:we,_owner:M.current}}function K(C,N){return{$$typeof:r,type:C.type,key:N,ref:C.ref,props:C.props,_owner:C._owner}}function ve(C){return typeof C=="object"&&C!==null&&C.$$typeof===r}function xe(C){var N={"=":"=0",":":"=2"};return"$"+C.replace(/[=:]/g,function(ae){return N[ae]})}var _e=/\/+/g;function Ce(C,N){return typeof C=="object"&&C!==null&&C.key!=null?xe(""+C.key):N.toString(36)}function Ie(C,N,ae,me,we){var H=typeof C;(H==="undefined"||H==="boolean")&&(C=null);var L=!1;if(C===null)L=!0;else switch(H){case"string":case"number":L=!0;break;case"object":switch(C.$$typeof){case r:case n:L=!0}}if(L)return L=C,we=we(L),C=me===""?"."+Ce(L,0):me,q(we)?(ae="",C!=null&&(ae=C.replace(_e,"$&/")+"/"),Ie(we,N,ae,"",function(Z){return Z})):we!=null&&(ve(we)&&(we=K(we,ae+(!we.key||L&&L.key===we.key?"":(""+we.key).replace(_e,"$&/")+"/")+C)),N.push(we)),1;if(L=0,me=me===""?".":me+":",q(C))for(var te=0;te<C.length;te++){H=C[te];var O=me+Ce(H,te);L+=Ie(H,N,ae,O,we)}else if(O=_(C),typeof O=="function")for(C=O.call(C),te=0;!(H=C.next()).done;)H=H.value,O=me+Ce(H,te++),L+=Ie(H,N,ae,O,we);else if(H==="object")throw N=String(C),Error("Objects are not valid as a React child (found: "+(N==="[object Object]"?"object with keys {"+Object.keys(C).join(", ")+"}":N)+"). If you meant to render a collection of children, use an array instead.");return L}function Re(C,N,ae){if(C==null)return C;var me=[],we=0;return Ie(C,me,"","",function(H){return N.call(ae,H,we++)}),me}function ie(C){if(C._status===-1){var N=C._result;N=N(),N.then(function(ae){(C._status===0||C._status===-1)&&(C._status=1,C._result=ae)},function(ae){(C._status===0||C._status===-1)&&(C._status=2,C._result=ae)}),C._status===-1&&(C._status=0,C._result=N)}if(C._status===1)return C._result.default;throw C._result}var he={current:null},x={transition:null},B={ReactCurrentDispatcher:he,ReactCurrentBatchConfig:x,ReactCurrentOwner:M};function G(){throw Error("act(...) is not supported in production builds of React.")}return Ee.Children={map:Re,forEach:function(C,N,ae){Re(C,function(){N.apply(this,arguments)},ae)},count:function(C){var N=0;return Re(C,function(){N++}),N},toArray:function(C){return Re(C,function(N){return N})||[]},only:function(C){if(!ve(C))throw Error("React.Children.only expected to receive a single React element child.");return C}},Ee.Component=E,Ee.Fragment=s,Ee.Profiler=u,Ee.PureComponent=V,Ee.StrictMode=o,Ee.Suspense=p,Ee.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=B,Ee.act=G,Ee.cloneElement=function(C,N,ae){if(C==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+C+".");var me=T({},C.props),we=C.key,H=C.ref,L=C._owner;if(N!=null){if(N.ref!==void 0&&(H=N.ref,L=M.current),N.key!==void 0&&(we=""+N.key),C.type&&C.type.defaultProps)var te=C.type.defaultProps;for(O in N)$.call(N,O)&&!Y.hasOwnProperty(O)&&(me[O]=N[O]===void 0&&te!==void 0?te[O]:N[O])}var O=arguments.length-2;if(O===1)me.children=ae;else if(1<O){te=Array(O);for(var Z=0;Z<O;Z++)te[Z]=arguments[Z+2];me.children=te}return{$$typeof:r,type:C.type,key:we,ref:H,props:me,_owner:L}},Ee.createContext=function(C){return C={$$typeof:f,_currentValue:C,_currentValue2:C,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},C.Provider={$$typeof:d,_context:C},C.Consumer=C},Ee.createElement=re,Ee.createFactory=function(C){var N=re.bind(null,C);return N.type=C,N},Ee.createRef=function(){return{current:null}},Ee.forwardRef=function(C){return{$$typeof:m,render:C}},Ee.isValidElement=ve,Ee.lazy=function(C){return{$$typeof:v,_payload:{_status:-1,_result:C},_init:ie}},Ee.memo=function(C,N){return{$$typeof:y,type:C,compare:N===void 0?null:N}},Ee.startTransition=function(C){var N=x.transition;x.transition={};try{C()}finally{x.transition=N}},Ee.unstable_act=G,Ee.useCallback=function(C,N){return he.current.useCallback(C,N)},Ee.useContext=function(C){return he.current.useContext(C)},Ee.useDebugValue=function(){},Ee.useDeferredValue=function(C){return he.current.useDeferredValue(C)},Ee.useEffect=function(C,N){return he.current.useEffect(C,N)},Ee.useId=function(){return he.current.useId()},Ee.useImperativeHandle=function(C,N,ae){return he.current.useImperativeHandle(C,N,ae)},Ee.useInsertionEffect=function(C,N){return he.current.useInsertionEffect(C,N)},Ee.useLayoutEffect=function(C,N){return he.current.useLayoutEffect(C,N)},Ee.useMemo=function(C,N){return he.current.useMemo(C,N)},Ee.useReducer=function(C,N,ae){return he.current.useReducer(C,N,ae)},Ee.useRef=function(C){return he.current.useRef(C)},Ee.useState=function(C){return he.current.useState(C)},Ee.useSyncExternalStore=function(C,N,ae){return he.current.useSyncExternalStore(C,N,ae)},Ee.useTransition=function(){return he.current.useTransition()},Ee.version="18.3.1",Ee}var Qd;function tu(){return Qd||(Qd=1,Rl.exports=up()),Rl.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yd;function cp(){if(Yd)return Vs;Yd=1;var r=tu(),n=Symbol.for("react.element"),s=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,u=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,d={key:!0,ref:!0,__self:!0,__source:!0};function f(m,p,y){var v,b={},_=null,w=null;y!==void 0&&(_=""+y),p.key!==void 0&&(_=""+p.key),p.ref!==void 0&&(w=p.ref);for(v in p)o.call(p,v)&&!d.hasOwnProperty(v)&&(b[v]=p[v]);if(m&&m.defaultProps)for(v in p=m.defaultProps,p)b[v]===void 0&&(b[v]=p[v]);return{$$typeof:n,type:m,key:_,ref:w,props:b,_owner:u.current}}return Vs.Fragment=s,Vs.jsx=f,Vs.jsxs=f,Vs}var Xd;function dp(){return Xd||(Xd=1,Il.exports=cp()),Il.exports}var i=dp(),A=tu(),wi={},Ol={exports:{}},It={},Pl={exports:{}},Dl={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zd;function hp(){return Zd||(Zd=1,(function(r){function n(x,B){var G=x.length;x.push(B);e:for(;0<G;){var C=G-1>>>1,N=x[C];if(0<u(N,B))x[C]=B,x[G]=N,G=C;else break e}}function s(x){return x.length===0?null:x[0]}function o(x){if(x.length===0)return null;var B=x[0],G=x.pop();if(G!==B){x[0]=G;e:for(var C=0,N=x.length,ae=N>>>1;C<ae;){var me=2*(C+1)-1,we=x[me],H=me+1,L=x[H];if(0>u(we,G))H<N&&0>u(L,we)?(x[C]=L,x[H]=G,C=H):(x[C]=we,x[me]=G,C=me);else if(H<N&&0>u(L,G))x[C]=L,x[H]=G,C=H;else break e}}return B}function u(x,B){var G=x.sortIndex-B.sortIndex;return G!==0?G:x.id-B.id}if(typeof performance=="object"&&typeof performance.now=="function"){var d=performance;r.unstable_now=function(){return d.now()}}else{var f=Date,m=f.now();r.unstable_now=function(){return f.now()-m}}var p=[],y=[],v=1,b=null,_=3,w=!1,T=!1,j=!1,E=typeof setTimeout=="function"?setTimeout:null,D=typeof clearTimeout=="function"?clearTimeout:null,V=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function z(x){for(var B=s(y);B!==null;){if(B.callback===null)o(y);else if(B.startTime<=x)o(y),B.sortIndex=B.expirationTime,n(p,B);else break;B=s(y)}}function q(x){if(j=!1,z(x),!T)if(s(p)!==null)T=!0,ie($);else{var B=s(y);B!==null&&he(q,B.startTime-x)}}function $(x,B){T=!1,j&&(j=!1,D(re),re=-1),w=!0;var G=_;try{for(z(B),b=s(p);b!==null&&(!(b.expirationTime>B)||x&&!xe());){var C=b.callback;if(typeof C=="function"){b.callback=null,_=b.priorityLevel;var N=C(b.expirationTime<=B);B=r.unstable_now(),typeof N=="function"?b.callback=N:b===s(p)&&o(p),z(B)}else o(p);b=s(p)}if(b!==null)var ae=!0;else{var me=s(y);me!==null&&he(q,me.startTime-B),ae=!1}return ae}finally{b=null,_=G,w=!1}}var M=!1,Y=null,re=-1,K=5,ve=-1;function xe(){return!(r.unstable_now()-ve<K)}function _e(){if(Y!==null){var x=r.unstable_now();ve=x;var B=!0;try{B=Y(!0,x)}finally{B?Ce():(M=!1,Y=null)}}else M=!1}var Ce;if(typeof V=="function")Ce=function(){V(_e)};else if(typeof MessageChannel<"u"){var Ie=new MessageChannel,Re=Ie.port2;Ie.port1.onmessage=_e,Ce=function(){Re.postMessage(null)}}else Ce=function(){E(_e,0)};function ie(x){Y=x,M||(M=!0,Ce())}function he(x,B){re=E(function(){x(r.unstable_now())},B)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(x){x.callback=null},r.unstable_continueExecution=function(){T||w||(T=!0,ie($))},r.unstable_forceFrameRate=function(x){0>x||125<x?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):K=0<x?Math.floor(1e3/x):5},r.unstable_getCurrentPriorityLevel=function(){return _},r.unstable_getFirstCallbackNode=function(){return s(p)},r.unstable_next=function(x){switch(_){case 1:case 2:case 3:var B=3;break;default:B=_}var G=_;_=B;try{return x()}finally{_=G}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function(x,B){switch(x){case 1:case 2:case 3:case 4:case 5:break;default:x=3}var G=_;_=x;try{return B()}finally{_=G}},r.unstable_scheduleCallback=function(x,B,G){var C=r.unstable_now();switch(typeof G=="object"&&G!==null?(G=G.delay,G=typeof G=="number"&&0<G?C+G:C):G=C,x){case 1:var N=-1;break;case 2:N=250;break;case 5:N=1073741823;break;case 4:N=1e4;break;default:N=5e3}return N=G+N,x={id:v++,callback:B,priorityLevel:x,startTime:G,expirationTime:N,sortIndex:-1},G>C?(x.sortIndex=G,n(y,x),s(p)===null&&x===s(y)&&(j?(D(re),re=-1):j=!0,he(q,G-C))):(x.sortIndex=N,n(p,x),T||w||(T=!0,ie($))),x},r.unstable_shouldYield=xe,r.unstable_wrapCallback=function(x){var B=_;return function(){var G=_;_=B;try{return x.apply(this,arguments)}finally{_=G}}}})(Dl)),Dl}var eh;function fp(){return eh||(eh=1,Pl.exports=hp()),Pl.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var th;function mp(){if(th)return It;th=1;var r=tu(),n=fp();function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,a=1;a<arguments.length;a++)t+="&args[]="+encodeURIComponent(arguments[a]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,u={};function d(e,t){f(e,t),f(e+"Capture",t)}function f(e,t){for(u[e]=t,e=0;e<t.length;e++)o.add(t[e])}var m=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),p=Object.prototype.hasOwnProperty,y=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,v={},b={};function _(e){return p.call(b,e)?!0:p.call(v,e)?!1:y.test(e)?b[e]=!0:(v[e]=!0,!1)}function w(e,t,a,l){if(a!==null&&a.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return l?!1:a!==null?!a.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function T(e,t,a,l){if(t===null||typeof t>"u"||w(e,t,a,l))return!0;if(l)return!1;if(a!==null)switch(a.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function j(e,t,a,l,c,h,g){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=l,this.attributeNamespace=c,this.mustUseProperty=a,this.propertyName=e,this.type=t,this.sanitizeURL=h,this.removeEmptyString=g}var E={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){E[e]=new j(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];E[t]=new j(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){E[e]=new j(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){E[e]=new j(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){E[e]=new j(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){E[e]=new j(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){E[e]=new j(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){E[e]=new j(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){E[e]=new j(e,5,!1,e.toLowerCase(),null,!1,!1)});var D=/[\-:]([a-z])/g;function V(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(D,V);E[t]=new j(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(D,V);E[t]=new j(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(D,V);E[t]=new j(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){E[e]=new j(e,1,!1,e.toLowerCase(),null,!1,!1)}),E.xlinkHref=new j("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){E[e]=new j(e,1,!1,e.toLowerCase(),null,!0,!0)});function z(e,t,a,l){var c=E.hasOwnProperty(t)?E[t]:null;(c!==null?c.type!==0:l||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(T(t,a,c,l)&&(a=null),l||c===null?_(t)&&(a===null?e.removeAttribute(t):e.setAttribute(t,""+a)):c.mustUseProperty?e[c.propertyName]=a===null?c.type===3?!1:"":a:(t=c.attributeName,l=c.attributeNamespace,a===null?e.removeAttribute(t):(c=c.type,a=c===3||c===4&&a===!0?"":""+a,l?e.setAttributeNS(l,t,a):e.setAttribute(t,a))))}var q=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,$=Symbol.for("react.element"),M=Symbol.for("react.portal"),Y=Symbol.for("react.fragment"),re=Symbol.for("react.strict_mode"),K=Symbol.for("react.profiler"),ve=Symbol.for("react.provider"),xe=Symbol.for("react.context"),_e=Symbol.for("react.forward_ref"),Ce=Symbol.for("react.suspense"),Ie=Symbol.for("react.suspense_list"),Re=Symbol.for("react.memo"),ie=Symbol.for("react.lazy"),he=Symbol.for("react.offscreen"),x=Symbol.iterator;function B(e){return e===null||typeof e!="object"?null:(e=x&&e[x]||e["@@iterator"],typeof e=="function"?e:null)}var G=Object.assign,C;function N(e){if(C===void 0)try{throw Error()}catch(a){var t=a.stack.trim().match(/\n( *(at )?)/);C=t&&t[1]||""}return`
`+C+e}var ae=!1;function me(e,t){if(!e||ae)return"";ae=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(F){var l=F}Reflect.construct(e,[],t)}else{try{t.call()}catch(F){l=F}e.call(t.prototype)}else{try{throw Error()}catch(F){l=F}e()}}catch(F){if(F&&l&&typeof F.stack=="string"){for(var c=F.stack.split(`
`),h=l.stack.split(`
`),g=c.length-1,k=h.length-1;1<=g&&0<=k&&c[g]!==h[k];)k--;for(;1<=g&&0<=k;g--,k--)if(c[g]!==h[k]){if(g!==1||k!==1)do if(g--,k--,0>k||c[g]!==h[k]){var S=`
`+c[g].replace(" at new "," at ");return e.displayName&&S.includes("<anonymous>")&&(S=S.replace("<anonymous>",e.displayName)),S}while(1<=g&&0<=k);break}}}finally{ae=!1,Error.prepareStackTrace=a}return(e=e?e.displayName||e.name:"")?N(e):""}function we(e){switch(e.tag){case 5:return N(e.type);case 16:return N("Lazy");case 13:return N("Suspense");case 19:return N("SuspenseList");case 0:case 2:case 15:return e=me(e.type,!1),e;case 11:return e=me(e.type.render,!1),e;case 1:return e=me(e.type,!0),e;default:return""}}function H(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Y:return"Fragment";case M:return"Portal";case K:return"Profiler";case re:return"StrictMode";case Ce:return"Suspense";case Ie:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case xe:return(e.displayName||"Context")+".Consumer";case ve:return(e._context.displayName||"Context")+".Provider";case _e:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Re:return t=e.displayName||null,t!==null?t:H(e.type)||"Memo";case ie:t=e._payload,e=e._init;try{return H(e(t))}catch{}}return null}function L(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return H(t);case 8:return t===re?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function te(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function O(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Z(e){var t=O(e)?"checked":"value",a=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),l=""+e[t];if(!e.hasOwnProperty(t)&&typeof a<"u"&&typeof a.get=="function"&&typeof a.set=="function"){var c=a.get,h=a.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return c.call(this)},set:function(g){l=""+g,h.call(this,g)}}),Object.defineProperty(e,t,{enumerable:a.enumerable}),{getValue:function(){return l},setValue:function(g){l=""+g},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Te(e){e._valueTracker||(e._valueTracker=Z(e))}function Pe(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var a=t.getValue(),l="";return e&&(l=O(e)?e.checked?"true":"false":e.value),e=l,e!==a?(t.setValue(e),!0):!1}function $e(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function U(e,t){var a=t.checked;return G({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:a??e._wrapperState.initialChecked})}function ne(e,t){var a=t.defaultValue==null?"":t.defaultValue,l=t.checked!=null?t.checked:t.defaultChecked;a=te(t.value!=null?t.value:a),e._wrapperState={initialChecked:l,initialValue:a,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function ke(e,t){t=t.checked,t!=null&&z(e,"checked",t,!1)}function pn(e,t){ke(e,t);var a=te(t.value),l=t.type;if(a!=null)l==="number"?(a===0&&e.value===""||e.value!=a)&&(e.value=""+a):e.value!==""+a&&(e.value=""+a);else if(l==="submit"||l==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?St(e,t.type,a):t.hasOwnProperty("defaultValue")&&St(e,t.type,te(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function gn(e,t,a){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var l=t.type;if(!(l!=="submit"&&l!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,a||t===e.value||(e.value=t),e.defaultValue=t}a=e.name,a!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,a!==""&&(e.name=a)}function St(e,t,a){(t!=="number"||$e(e.ownerDocument)!==e)&&(a==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+a&&(e.defaultValue=""+a))}var Ht=Array.isArray;function W(e,t,a,l){if(e=e.options,t){t={};for(var c=0;c<a.length;c++)t["$"+a[c]]=!0;for(a=0;a<e.length;a++)c=t.hasOwnProperty("$"+e[a].value),e[a].selected!==c&&(e[a].selected=c),c&&l&&(e[a].defaultSelected=!0)}else{for(a=""+te(a),t=null,c=0;c<e.length;c++){if(e[c].value===a){e[c].selected=!0,l&&(e[c].defaultSelected=!0);return}t!==null||e[c].disabled||(t=e[c])}t!==null&&(t.selected=!0)}}function fe(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(s(91));return G({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function We(e,t){var a=t.value;if(a==null){if(a=t.children,t=t.defaultValue,a!=null){if(t!=null)throw Error(s(92));if(Ht(a)){if(1<a.length)throw Error(s(93));a=a[0]}t=a}t==null&&(t=""),a=t}e._wrapperState={initialValue:te(a)}}function da(e,t){var a=te(t.value),l=te(t.defaultValue);a!=null&&(a=""+a,a!==e.value&&(e.value=a),t.defaultValue==null&&e.defaultValue!==a&&(e.defaultValue=a)),l!=null&&(e.defaultValue=""+l)}function iu(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function ou(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function zi(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?ou(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var ha,lu=(function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,a,l,c){MSApp.execUnsafeLocalFunction(function(){return e(t,a,l,c)})}:e})(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(ha=ha||document.createElement("div"),ha.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ha.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function os(e,t){if(t){var a=e.firstChild;if(a&&a===e.lastChild&&a.nodeType===3){a.nodeValue=t;return}}e.textContent=t}var ls={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},df=["Webkit","ms","Moz","O"];Object.keys(ls).forEach(function(e){df.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ls[t]=ls[e]})});function uu(e,t,a){return t==null||typeof t=="boolean"||t===""?"":a||typeof t!="number"||t===0||ls.hasOwnProperty(e)&&ls[e]?(""+t).trim():t+"px"}function cu(e,t){e=e.style;for(var a in t)if(t.hasOwnProperty(a)){var l=a.indexOf("--")===0,c=uu(a,t[a],l);a==="float"&&(a="cssFloat"),l?e.setProperty(a,c):e[a]=c}}var hf=G({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Bi(e,t){if(t){if(hf[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(s(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(s(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(s(61))}if(t.style!=null&&typeof t.style!="object")throw Error(s(62))}}function Wi(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var qi=null;function Vi(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Hi=null,_r=null,kr=null;function du(e){if(e=As(e)){if(typeof Hi!="function")throw Error(s(280));var t=e.stateNode;t&&(t=Da(t),Hi(e.stateNode,e.type,t))}}function hu(e){_r?kr?kr.push(e):kr=[e]:_r=e}function fu(){if(_r){var e=_r,t=kr;if(kr=_r=null,du(e),t)for(e=0;e<t.length;e++)du(t[e])}}function mu(e,t){return e(t)}function pu(){}var Gi=!1;function gu(e,t,a){if(Gi)return e(t,a);Gi=!0;try{return mu(e,t,a)}finally{Gi=!1,(_r!==null||kr!==null)&&(pu(),fu())}}function us(e,t){var a=e.stateNode;if(a===null)return null;var l=Da(a);if(l===null)return null;a=l[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(l=!l.disabled)||(e=e.type,l=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!l;break e;default:e=!1}if(e)return null;if(a&&typeof a!="function")throw Error(s(231,t,typeof a));return a}var Ki=!1;if(m)try{var cs={};Object.defineProperty(cs,"passive",{get:function(){Ki=!0}}),window.addEventListener("test",cs,cs),window.removeEventListener("test",cs,cs)}catch{Ki=!1}function ff(e,t,a,l,c,h,g,k,S){var F=Array.prototype.slice.call(arguments,3);try{t.apply(a,F)}catch(Q){this.onError(Q)}}var ds=!1,fa=null,ma=!1,Ji=null,mf={onError:function(e){ds=!0,fa=e}};function pf(e,t,a,l,c,h,g,k,S){ds=!1,fa=null,ff.apply(mf,arguments)}function gf(e,t,a,l,c,h,g,k,S){if(pf.apply(this,arguments),ds){if(ds){var F=fa;ds=!1,fa=null}else throw Error(s(198));ma||(ma=!0,Ji=F)}}function nr(e){var t=e,a=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(a=t.return),e=t.return;while(e)}return t.tag===3?a:null}function yu(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function vu(e){if(nr(e)!==e)throw Error(s(188))}function yf(e){var t=e.alternate;if(!t){if(t=nr(e),t===null)throw Error(s(188));return t!==e?null:e}for(var a=e,l=t;;){var c=a.return;if(c===null)break;var h=c.alternate;if(h===null){if(l=c.return,l!==null){a=l;continue}break}if(c.child===h.child){for(h=c.child;h;){if(h===a)return vu(c),e;if(h===l)return vu(c),t;h=h.sibling}throw Error(s(188))}if(a.return!==l.return)a=c,l=h;else{for(var g=!1,k=c.child;k;){if(k===a){g=!0,a=c,l=h;break}if(k===l){g=!0,l=c,a=h;break}k=k.sibling}if(!g){for(k=h.child;k;){if(k===a){g=!0,a=h,l=c;break}if(k===l){g=!0,l=h,a=c;break}k=k.sibling}if(!g)throw Error(s(189))}}if(a.alternate!==l)throw Error(s(190))}if(a.tag!==3)throw Error(s(188));return a.stateNode.current===a?e:t}function xu(e){return e=yf(e),e!==null?wu(e):null}function wu(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=wu(e);if(t!==null)return t;e=e.sibling}return null}var bu=n.unstable_scheduleCallback,_u=n.unstable_cancelCallback,vf=n.unstable_shouldYield,xf=n.unstable_requestPaint,Je=n.unstable_now,wf=n.unstable_getCurrentPriorityLevel,Qi=n.unstable_ImmediatePriority,ku=n.unstable_UserBlockingPriority,pa=n.unstable_NormalPriority,bf=n.unstable_LowPriority,ju=n.unstable_IdlePriority,ga=null,on=null;function _f(e){if(on&&typeof on.onCommitFiberRoot=="function")try{on.onCommitFiberRoot(ga,e,void 0,(e.current.flags&128)===128)}catch{}}var Gt=Math.clz32?Math.clz32:Sf,kf=Math.log,jf=Math.LN2;function Sf(e){return e>>>=0,e===0?32:31-(kf(e)/jf|0)|0}var ya=64,va=4194304;function hs(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function xa(e,t){var a=e.pendingLanes;if(a===0)return 0;var l=0,c=e.suspendedLanes,h=e.pingedLanes,g=a&268435455;if(g!==0){var k=g&~c;k!==0?l=hs(k):(h&=g,h!==0&&(l=hs(h)))}else g=a&~c,g!==0?l=hs(g):h!==0&&(l=hs(h));if(l===0)return 0;if(t!==0&&t!==l&&(t&c)===0&&(c=l&-l,h=t&-t,c>=h||c===16&&(h&4194240)!==0))return t;if((l&4)!==0&&(l|=a&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=l;0<t;)a=31-Gt(t),c=1<<a,l|=e[a],t&=~c;return l}function Nf(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ef(e,t){for(var a=e.suspendedLanes,l=e.pingedLanes,c=e.expirationTimes,h=e.pendingLanes;0<h;){var g=31-Gt(h),k=1<<g,S=c[g];S===-1?((k&a)===0||(k&l)!==0)&&(c[g]=Nf(k,t)):S<=t&&(e.expiredLanes|=k),h&=~k}}function Yi(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Su(){var e=ya;return ya<<=1,(ya&4194240)===0&&(ya=64),e}function Xi(e){for(var t=[],a=0;31>a;a++)t.push(e);return t}function fs(e,t,a){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Gt(t),e[t]=a}function Cf(e,t){var a=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var l=e.eventTimes;for(e=e.expirationTimes;0<a;){var c=31-Gt(a),h=1<<c;t[c]=0,l[c]=-1,e[c]=-1,a&=~h}}function Zi(e,t){var a=e.entangledLanes|=t;for(e=e.entanglements;a;){var l=31-Gt(a),c=1<<l;c&t|e[l]&t&&(e[l]|=t),a&=~c}}var De=0;function Nu(e){return e&=-e,1<e?4<e?(e&268435455)!==0?16:536870912:4:1}var Eu,eo,Cu,Tu,Au,to=!1,wa=[],In=null,Rn=null,On=null,ms=new Map,ps=new Map,Pn=[],Tf="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Iu(e,t){switch(e){case"focusin":case"focusout":In=null;break;case"dragenter":case"dragleave":Rn=null;break;case"mouseover":case"mouseout":On=null;break;case"pointerover":case"pointerout":ms.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":ps.delete(t.pointerId)}}function gs(e,t,a,l,c,h){return e===null||e.nativeEvent!==h?(e={blockedOn:t,domEventName:a,eventSystemFlags:l,nativeEvent:h,targetContainers:[c]},t!==null&&(t=As(t),t!==null&&eo(t)),e):(e.eventSystemFlags|=l,t=e.targetContainers,c!==null&&t.indexOf(c)===-1&&t.push(c),e)}function Af(e,t,a,l,c){switch(t){case"focusin":return In=gs(In,e,t,a,l,c),!0;case"dragenter":return Rn=gs(Rn,e,t,a,l,c),!0;case"mouseover":return On=gs(On,e,t,a,l,c),!0;case"pointerover":var h=c.pointerId;return ms.set(h,gs(ms.get(h)||null,e,t,a,l,c)),!0;case"gotpointercapture":return h=c.pointerId,ps.set(h,gs(ps.get(h)||null,e,t,a,l,c)),!0}return!1}function Ru(e){var t=rr(e.target);if(t!==null){var a=nr(t);if(a!==null){if(t=a.tag,t===13){if(t=yu(a),t!==null){e.blockedOn=t,Au(e.priority,function(){Cu(a)});return}}else if(t===3&&a.stateNode.current.memoizedState.isDehydrated){e.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}e.blockedOn=null}function ba(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var a=ro(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(a===null){a=e.nativeEvent;var l=new a.constructor(a.type,a);qi=l,a.target.dispatchEvent(l),qi=null}else return t=As(a),t!==null&&eo(t),e.blockedOn=a,!1;t.shift()}return!0}function Ou(e,t,a){ba(e)&&a.delete(t)}function If(){to=!1,In!==null&&ba(In)&&(In=null),Rn!==null&&ba(Rn)&&(Rn=null),On!==null&&ba(On)&&(On=null),ms.forEach(Ou),ps.forEach(Ou)}function ys(e,t){e.blockedOn===t&&(e.blockedOn=null,to||(to=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,If)))}function vs(e){function t(c){return ys(c,e)}if(0<wa.length){ys(wa[0],e);for(var a=1;a<wa.length;a++){var l=wa[a];l.blockedOn===e&&(l.blockedOn=null)}}for(In!==null&&ys(In,e),Rn!==null&&ys(Rn,e),On!==null&&ys(On,e),ms.forEach(t),ps.forEach(t),a=0;a<Pn.length;a++)l=Pn[a],l.blockedOn===e&&(l.blockedOn=null);for(;0<Pn.length&&(a=Pn[0],a.blockedOn===null);)Ru(a),a.blockedOn===null&&Pn.shift()}var jr=q.ReactCurrentBatchConfig,_a=!0;function Rf(e,t,a,l){var c=De,h=jr.transition;jr.transition=null;try{De=1,no(e,t,a,l)}finally{De=c,jr.transition=h}}function Of(e,t,a,l){var c=De,h=jr.transition;jr.transition=null;try{De=4,no(e,t,a,l)}finally{De=c,jr.transition=h}}function no(e,t,a,l){if(_a){var c=ro(e,t,a,l);if(c===null)bo(e,t,l,ka,a),Iu(e,l);else if(Af(c,e,t,a,l))l.stopPropagation();else if(Iu(e,l),t&4&&-1<Tf.indexOf(e)){for(;c!==null;){var h=As(c);if(h!==null&&Eu(h),h=ro(e,t,a,l),h===null&&bo(e,t,l,ka,a),h===c)break;c=h}c!==null&&l.stopPropagation()}else bo(e,t,l,null,a)}}var ka=null;function ro(e,t,a,l){if(ka=null,e=Vi(l),e=rr(e),e!==null)if(t=nr(e),t===null)e=null;else if(a=t.tag,a===13){if(e=yu(t),e!==null)return e;e=null}else if(a===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return ka=e,null}function Pu(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(wf()){case Qi:return 1;case ku:return 4;case pa:case bf:return 16;case ju:return 536870912;default:return 16}default:return 16}}var Dn=null,so=null,ja=null;function Du(){if(ja)return ja;var e,t=so,a=t.length,l,c="value"in Dn?Dn.value:Dn.textContent,h=c.length;for(e=0;e<a&&t[e]===c[e];e++);var g=a-e;for(l=1;l<=g&&t[a-l]===c[h-l];l++);return ja=c.slice(e,1<l?1-l:void 0)}function Sa(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Na(){return!0}function Lu(){return!1}function Ot(e){function t(a,l,c,h,g){this._reactName=a,this._targetInst=c,this.type=l,this.nativeEvent=h,this.target=g,this.currentTarget=null;for(var k in e)e.hasOwnProperty(k)&&(a=e[k],this[k]=a?a(h):h[k]);return this.isDefaultPrevented=(h.defaultPrevented!=null?h.defaultPrevented:h.returnValue===!1)?Na:Lu,this.isPropagationStopped=Lu,this}return G(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=Na)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=Na)},persist:function(){},isPersistent:Na}),t}var Sr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ao=Ot(Sr),xs=G({},Sr,{view:0,detail:0}),Pf=Ot(xs),io,oo,ws,Ea=G({},xs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:uo,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ws&&(ws&&e.type==="mousemove"?(io=e.screenX-ws.screenX,oo=e.screenY-ws.screenY):oo=io=0,ws=e),io)},movementY:function(e){return"movementY"in e?e.movementY:oo}}),$u=Ot(Ea),Df=G({},Ea,{dataTransfer:0}),Lf=Ot(Df),$f=G({},xs,{relatedTarget:0}),lo=Ot($f),Mf=G({},Sr,{animationName:0,elapsedTime:0,pseudoElement:0}),Uf=Ot(Mf),Ff=G({},Sr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),zf=Ot(Ff),Bf=G({},Sr,{data:0}),Mu=Ot(Bf),Wf={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},qf={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Vf={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Hf(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Vf[e])?!!t[e]:!1}function uo(){return Hf}var Gf=G({},xs,{key:function(e){if(e.key){var t=Wf[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Sa(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?qf[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:uo,charCode:function(e){return e.type==="keypress"?Sa(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Sa(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Kf=Ot(Gf),Jf=G({},Ea,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Uu=Ot(Jf),Qf=G({},xs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:uo}),Yf=Ot(Qf),Xf=G({},Sr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Zf=Ot(Xf),em=G({},Ea,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),tm=Ot(em),nm=[9,13,27,32],co=m&&"CompositionEvent"in window,bs=null;m&&"documentMode"in document&&(bs=document.documentMode);var rm=m&&"TextEvent"in window&&!bs,Fu=m&&(!co||bs&&8<bs&&11>=bs),zu=" ",Bu=!1;function Wu(e,t){switch(e){case"keyup":return nm.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function qu(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Nr=!1;function sm(e,t){switch(e){case"compositionend":return qu(t);case"keypress":return t.which!==32?null:(Bu=!0,zu);case"textInput":return e=t.data,e===zu&&Bu?null:e;default:return null}}function am(e,t){if(Nr)return e==="compositionend"||!co&&Wu(e,t)?(e=Du(),ja=so=Dn=null,Nr=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Fu&&t.locale!=="ko"?null:t.data;default:return null}}var im={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Vu(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!im[e.type]:t==="textarea"}function Hu(e,t,a,l){hu(l),t=Ra(t,"onChange"),0<t.length&&(a=new ao("onChange","change",null,a,l),e.push({event:a,listeners:t}))}var _s=null,ks=null;function om(e){cc(e,0)}function Ca(e){var t=Ir(e);if(Pe(t))return e}function lm(e,t){if(e==="change")return t}var Gu=!1;if(m){var ho;if(m){var fo="oninput"in document;if(!fo){var Ku=document.createElement("div");Ku.setAttribute("oninput","return;"),fo=typeof Ku.oninput=="function"}ho=fo}else ho=!1;Gu=ho&&(!document.documentMode||9<document.documentMode)}function Ju(){_s&&(_s.detachEvent("onpropertychange",Qu),ks=_s=null)}function Qu(e){if(e.propertyName==="value"&&Ca(ks)){var t=[];Hu(t,ks,e,Vi(e)),gu(om,t)}}function um(e,t,a){e==="focusin"?(Ju(),_s=t,ks=a,_s.attachEvent("onpropertychange",Qu)):e==="focusout"&&Ju()}function cm(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Ca(ks)}function dm(e,t){if(e==="click")return Ca(t)}function hm(e,t){if(e==="input"||e==="change")return Ca(t)}function fm(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Kt=typeof Object.is=="function"?Object.is:fm;function js(e,t){if(Kt(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var a=Object.keys(e),l=Object.keys(t);if(a.length!==l.length)return!1;for(l=0;l<a.length;l++){var c=a[l];if(!p.call(t,c)||!Kt(e[c],t[c]))return!1}return!0}function Yu(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Xu(e,t){var a=Yu(e);e=0;for(var l;a;){if(a.nodeType===3){if(l=e+a.textContent.length,e<=t&&l>=t)return{node:a,offset:t-e};e=l}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=Yu(a)}}function Zu(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Zu(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function ec(){for(var e=window,t=$e();t instanceof e.HTMLIFrameElement;){try{var a=typeof t.contentWindow.location.href=="string"}catch{a=!1}if(a)e=t.contentWindow;else break;t=$e(e.document)}return t}function mo(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function mm(e){var t=ec(),a=e.focusedElem,l=e.selectionRange;if(t!==a&&a&&a.ownerDocument&&Zu(a.ownerDocument.documentElement,a)){if(l!==null&&mo(a)){if(t=l.start,e=l.end,e===void 0&&(e=t),"selectionStart"in a)a.selectionStart=t,a.selectionEnd=Math.min(e,a.value.length);else if(e=(t=a.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var c=a.textContent.length,h=Math.min(l.start,c);l=l.end===void 0?h:Math.min(l.end,c),!e.extend&&h>l&&(c=l,l=h,h=c),c=Xu(a,h);var g=Xu(a,l);c&&g&&(e.rangeCount!==1||e.anchorNode!==c.node||e.anchorOffset!==c.offset||e.focusNode!==g.node||e.focusOffset!==g.offset)&&(t=t.createRange(),t.setStart(c.node,c.offset),e.removeAllRanges(),h>l?(e.addRange(t),e.extend(g.node,g.offset)):(t.setEnd(g.node,g.offset),e.addRange(t)))}}for(t=[],e=a;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof a.focus=="function"&&a.focus(),a=0;a<t.length;a++)e=t[a],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var pm=m&&"documentMode"in document&&11>=document.documentMode,Er=null,po=null,Ss=null,go=!1;function tc(e,t,a){var l=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;go||Er==null||Er!==$e(l)||(l=Er,"selectionStart"in l&&mo(l)?l={start:l.selectionStart,end:l.selectionEnd}:(l=(l.ownerDocument&&l.ownerDocument.defaultView||window).getSelection(),l={anchorNode:l.anchorNode,anchorOffset:l.anchorOffset,focusNode:l.focusNode,focusOffset:l.focusOffset}),Ss&&js(Ss,l)||(Ss=l,l=Ra(po,"onSelect"),0<l.length&&(t=new ao("onSelect","select",null,t,a),e.push({event:t,listeners:l}),t.target=Er)))}function Ta(e,t){var a={};return a[e.toLowerCase()]=t.toLowerCase(),a["Webkit"+e]="webkit"+t,a["Moz"+e]="moz"+t,a}var Cr={animationend:Ta("Animation","AnimationEnd"),animationiteration:Ta("Animation","AnimationIteration"),animationstart:Ta("Animation","AnimationStart"),transitionend:Ta("Transition","TransitionEnd")},yo={},nc={};m&&(nc=document.createElement("div").style,"AnimationEvent"in window||(delete Cr.animationend.animation,delete Cr.animationiteration.animation,delete Cr.animationstart.animation),"TransitionEvent"in window||delete Cr.transitionend.transition);function Aa(e){if(yo[e])return yo[e];if(!Cr[e])return e;var t=Cr[e],a;for(a in t)if(t.hasOwnProperty(a)&&a in nc)return yo[e]=t[a];return e}var rc=Aa("animationend"),sc=Aa("animationiteration"),ac=Aa("animationstart"),ic=Aa("transitionend"),oc=new Map,lc="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ln(e,t){oc.set(e,t),d(t,[e])}for(var vo=0;vo<lc.length;vo++){var xo=lc[vo],gm=xo.toLowerCase(),ym=xo[0].toUpperCase()+xo.slice(1);Ln(gm,"on"+ym)}Ln(rc,"onAnimationEnd"),Ln(sc,"onAnimationIteration"),Ln(ac,"onAnimationStart"),Ln("dblclick","onDoubleClick"),Ln("focusin","onFocus"),Ln("focusout","onBlur"),Ln(ic,"onTransitionEnd"),f("onMouseEnter",["mouseout","mouseover"]),f("onMouseLeave",["mouseout","mouseover"]),f("onPointerEnter",["pointerout","pointerover"]),f("onPointerLeave",["pointerout","pointerover"]),d("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),d("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),d("onBeforeInput",["compositionend","keypress","textInput","paste"]),d("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),d("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),d("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ns="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),vm=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ns));function uc(e,t,a){var l=e.type||"unknown-event";e.currentTarget=a,gf(l,t,void 0,e),e.currentTarget=null}function cc(e,t){t=(t&4)!==0;for(var a=0;a<e.length;a++){var l=e[a],c=l.event;l=l.listeners;e:{var h=void 0;if(t)for(var g=l.length-1;0<=g;g--){var k=l[g],S=k.instance,F=k.currentTarget;if(k=k.listener,S!==h&&c.isPropagationStopped())break e;uc(c,k,F),h=S}else for(g=0;g<l.length;g++){if(k=l[g],S=k.instance,F=k.currentTarget,k=k.listener,S!==h&&c.isPropagationStopped())break e;uc(c,k,F),h=S}}}if(ma)throw e=Ji,ma=!1,Ji=null,e}function Fe(e,t){var a=t[Eo];a===void 0&&(a=t[Eo]=new Set);var l=e+"__bubble";a.has(l)||(dc(t,e,2,!1),a.add(l))}function wo(e,t,a){var l=0;t&&(l|=4),dc(a,e,l,t)}var Ia="_reactListening"+Math.random().toString(36).slice(2);function Es(e){if(!e[Ia]){e[Ia]=!0,o.forEach(function(a){a!=="selectionchange"&&(vm.has(a)||wo(a,!1,e),wo(a,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Ia]||(t[Ia]=!0,wo("selectionchange",!1,t))}}function dc(e,t,a,l){switch(Pu(t)){case 1:var c=Rf;break;case 4:c=Of;break;default:c=no}a=c.bind(null,t,a,e),c=void 0,!Ki||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(c=!0),l?c!==void 0?e.addEventListener(t,a,{capture:!0,passive:c}):e.addEventListener(t,a,!0):c!==void 0?e.addEventListener(t,a,{passive:c}):e.addEventListener(t,a,!1)}function bo(e,t,a,l,c){var h=l;if((t&1)===0&&(t&2)===0&&l!==null)e:for(;;){if(l===null)return;var g=l.tag;if(g===3||g===4){var k=l.stateNode.containerInfo;if(k===c||k.nodeType===8&&k.parentNode===c)break;if(g===4)for(g=l.return;g!==null;){var S=g.tag;if((S===3||S===4)&&(S=g.stateNode.containerInfo,S===c||S.nodeType===8&&S.parentNode===c))return;g=g.return}for(;k!==null;){if(g=rr(k),g===null)return;if(S=g.tag,S===5||S===6){l=h=g;continue e}k=k.parentNode}}l=l.return}gu(function(){var F=h,Q=Vi(a),X=[];e:{var J=oc.get(e);if(J!==void 0){var se=ao,le=e;switch(e){case"keypress":if(Sa(a)===0)break e;case"keydown":case"keyup":se=Kf;break;case"focusin":le="focus",se=lo;break;case"focusout":le="blur",se=lo;break;case"beforeblur":case"afterblur":se=lo;break;case"click":if(a.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":se=$u;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":se=Lf;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":se=Yf;break;case rc:case sc:case ac:se=Uf;break;case ic:se=Zf;break;case"scroll":se=Pf;break;case"wheel":se=tm;break;case"copy":case"cut":case"paste":se=zf;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":se=Uu}var ue=(t&4)!==0,Qe=!ue&&e==="scroll",R=ue?J!==null?J+"Capture":null:J;ue=[];for(var I=F,P;I!==null;){P=I;var ee=P.stateNode;if(P.tag===5&&ee!==null&&(P=ee,R!==null&&(ee=us(I,R),ee!=null&&ue.push(Cs(I,ee,P)))),Qe)break;I=I.return}0<ue.length&&(J=new se(J,le,null,a,Q),X.push({event:J,listeners:ue}))}}if((t&7)===0){e:{if(J=e==="mouseover"||e==="pointerover",se=e==="mouseout"||e==="pointerout",J&&a!==qi&&(le=a.relatedTarget||a.fromElement)&&(rr(le)||le[yn]))break e;if((se||J)&&(J=Q.window===Q?Q:(J=Q.ownerDocument)?J.defaultView||J.parentWindow:window,se?(le=a.relatedTarget||a.toElement,se=F,le=le?rr(le):null,le!==null&&(Qe=nr(le),le!==Qe||le.tag!==5&&le.tag!==6)&&(le=null)):(se=null,le=F),se!==le)){if(ue=$u,ee="onMouseLeave",R="onMouseEnter",I="mouse",(e==="pointerout"||e==="pointerover")&&(ue=Uu,ee="onPointerLeave",R="onPointerEnter",I="pointer"),Qe=se==null?J:Ir(se),P=le==null?J:Ir(le),J=new ue(ee,I+"leave",se,a,Q),J.target=Qe,J.relatedTarget=P,ee=null,rr(Q)===F&&(ue=new ue(R,I+"enter",le,a,Q),ue.target=P,ue.relatedTarget=Qe,ee=ue),Qe=ee,se&&le)t:{for(ue=se,R=le,I=0,P=ue;P;P=Tr(P))I++;for(P=0,ee=R;ee;ee=Tr(ee))P++;for(;0<I-P;)ue=Tr(ue),I--;for(;0<P-I;)R=Tr(R),P--;for(;I--;){if(ue===R||R!==null&&ue===R.alternate)break t;ue=Tr(ue),R=Tr(R)}ue=null}else ue=null;se!==null&&hc(X,J,se,ue,!1),le!==null&&Qe!==null&&hc(X,Qe,le,ue,!0)}}e:{if(J=F?Ir(F):window,se=J.nodeName&&J.nodeName.toLowerCase(),se==="select"||se==="input"&&J.type==="file")var ce=lm;else if(Vu(J))if(Gu)ce=hm;else{ce=cm;var pe=um}else(se=J.nodeName)&&se.toLowerCase()==="input"&&(J.type==="checkbox"||J.type==="radio")&&(ce=dm);if(ce&&(ce=ce(e,F))){Hu(X,ce,a,Q);break e}pe&&pe(e,J,F),e==="focusout"&&(pe=J._wrapperState)&&pe.controlled&&J.type==="number"&&St(J,"number",J.value)}switch(pe=F?Ir(F):window,e){case"focusin":(Vu(pe)||pe.contentEditable==="true")&&(Er=pe,po=F,Ss=null);break;case"focusout":Ss=po=Er=null;break;case"mousedown":go=!0;break;case"contextmenu":case"mouseup":case"dragend":go=!1,tc(X,a,Q);break;case"selectionchange":if(pm)break;case"keydown":case"keyup":tc(X,a,Q)}var ge;if(co)e:{switch(e){case"compositionstart":var je="onCompositionStart";break e;case"compositionend":je="onCompositionEnd";break e;case"compositionupdate":je="onCompositionUpdate";break e}je=void 0}else Nr?Wu(e,a)&&(je="onCompositionEnd"):e==="keydown"&&a.keyCode===229&&(je="onCompositionStart");je&&(Fu&&a.locale!=="ko"&&(Nr||je!=="onCompositionStart"?je==="onCompositionEnd"&&Nr&&(ge=Du()):(Dn=Q,so="value"in Dn?Dn.value:Dn.textContent,Nr=!0)),pe=Ra(F,je),0<pe.length&&(je=new Mu(je,e,null,a,Q),X.push({event:je,listeners:pe}),ge?je.data=ge:(ge=qu(a),ge!==null&&(je.data=ge)))),(ge=rm?sm(e,a):am(e,a))&&(F=Ra(F,"onBeforeInput"),0<F.length&&(Q=new Mu("onBeforeInput","beforeinput",null,a,Q),X.push({event:Q,listeners:F}),Q.data=ge))}cc(X,t)})}function Cs(e,t,a){return{instance:e,listener:t,currentTarget:a}}function Ra(e,t){for(var a=t+"Capture",l=[];e!==null;){var c=e,h=c.stateNode;c.tag===5&&h!==null&&(c=h,h=us(e,a),h!=null&&l.unshift(Cs(e,h,c)),h=us(e,t),h!=null&&l.push(Cs(e,h,c))),e=e.return}return l}function Tr(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function hc(e,t,a,l,c){for(var h=t._reactName,g=[];a!==null&&a!==l;){var k=a,S=k.alternate,F=k.stateNode;if(S!==null&&S===l)break;k.tag===5&&F!==null&&(k=F,c?(S=us(a,h),S!=null&&g.unshift(Cs(a,S,k))):c||(S=us(a,h),S!=null&&g.push(Cs(a,S,k)))),a=a.return}g.length!==0&&e.push({event:t,listeners:g})}var xm=/\r\n?/g,wm=/\u0000|\uFFFD/g;function fc(e){return(typeof e=="string"?e:""+e).replace(xm,`
`).replace(wm,"")}function Oa(e,t,a){if(t=fc(t),fc(e)!==t&&a)throw Error(s(425))}function Pa(){}var _o=null,ko=null;function jo(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var So=typeof setTimeout=="function"?setTimeout:void 0,bm=typeof clearTimeout=="function"?clearTimeout:void 0,mc=typeof Promise=="function"?Promise:void 0,_m=typeof queueMicrotask=="function"?queueMicrotask:typeof mc<"u"?function(e){return mc.resolve(null).then(e).catch(km)}:So;function km(e){setTimeout(function(){throw e})}function No(e,t){var a=t,l=0;do{var c=a.nextSibling;if(e.removeChild(a),c&&c.nodeType===8)if(a=c.data,a==="/$"){if(l===0){e.removeChild(c),vs(t);return}l--}else a!=="$"&&a!=="$?"&&a!=="$!"||l++;a=c}while(a);vs(t)}function $n(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function pc(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var a=e.data;if(a==="$"||a==="$!"||a==="$?"){if(t===0)return e;t--}else a==="/$"&&t++}e=e.previousSibling}return null}var Ar=Math.random().toString(36).slice(2),ln="__reactFiber$"+Ar,Ts="__reactProps$"+Ar,yn="__reactContainer$"+Ar,Eo="__reactEvents$"+Ar,jm="__reactListeners$"+Ar,Sm="__reactHandles$"+Ar;function rr(e){var t=e[ln];if(t)return t;for(var a=e.parentNode;a;){if(t=a[yn]||a[ln]){if(a=t.alternate,t.child!==null||a!==null&&a.child!==null)for(e=pc(e);e!==null;){if(a=e[ln])return a;e=pc(e)}return t}e=a,a=e.parentNode}return null}function As(e){return e=e[ln]||e[yn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Ir(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(s(33))}function Da(e){return e[Ts]||null}var Co=[],Rr=-1;function Mn(e){return{current:e}}function ze(e){0>Rr||(e.current=Co[Rr],Co[Rr]=null,Rr--)}function Me(e,t){Rr++,Co[Rr]=e.current,e.current=t}var Un={},yt=Mn(Un),Nt=Mn(!1),sr=Un;function Or(e,t){var a=e.type.contextTypes;if(!a)return Un;var l=e.stateNode;if(l&&l.__reactInternalMemoizedUnmaskedChildContext===t)return l.__reactInternalMemoizedMaskedChildContext;var c={},h;for(h in a)c[h]=t[h];return l&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=c),c}function Et(e){return e=e.childContextTypes,e!=null}function La(){ze(Nt),ze(yt)}function gc(e,t,a){if(yt.current!==Un)throw Error(s(168));Me(yt,t),Me(Nt,a)}function yc(e,t,a){var l=e.stateNode;if(t=t.childContextTypes,typeof l.getChildContext!="function")return a;l=l.getChildContext();for(var c in l)if(!(c in t))throw Error(s(108,L(e)||"Unknown",c));return G({},a,l)}function $a(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Un,sr=yt.current,Me(yt,e),Me(Nt,Nt.current),!0}function vc(e,t,a){var l=e.stateNode;if(!l)throw Error(s(169));a?(e=yc(e,t,sr),l.__reactInternalMemoizedMergedChildContext=e,ze(Nt),ze(yt),Me(yt,e)):ze(Nt),Me(Nt,a)}var vn=null,Ma=!1,To=!1;function xc(e){vn===null?vn=[e]:vn.push(e)}function Nm(e){Ma=!0,xc(e)}function Fn(){if(!To&&vn!==null){To=!0;var e=0,t=De;try{var a=vn;for(De=1;e<a.length;e++){var l=a[e];do l=l(!0);while(l!==null)}vn=null,Ma=!1}catch(c){throw vn!==null&&(vn=vn.slice(e+1)),bu(Qi,Fn),c}finally{De=t,To=!1}}return null}var Pr=[],Dr=0,Ua=null,Fa=0,Ut=[],Ft=0,ar=null,xn=1,wn="";function ir(e,t){Pr[Dr++]=Fa,Pr[Dr++]=Ua,Ua=e,Fa=t}function wc(e,t,a){Ut[Ft++]=xn,Ut[Ft++]=wn,Ut[Ft++]=ar,ar=e;var l=xn;e=wn;var c=32-Gt(l)-1;l&=~(1<<c),a+=1;var h=32-Gt(t)+c;if(30<h){var g=c-c%5;h=(l&(1<<g)-1).toString(32),l>>=g,c-=g,xn=1<<32-Gt(t)+c|a<<c|l,wn=h+e}else xn=1<<h|a<<c|l,wn=e}function Ao(e){e.return!==null&&(ir(e,1),wc(e,1,0))}function Io(e){for(;e===Ua;)Ua=Pr[--Dr],Pr[Dr]=null,Fa=Pr[--Dr],Pr[Dr]=null;for(;e===ar;)ar=Ut[--Ft],Ut[Ft]=null,wn=Ut[--Ft],Ut[Ft]=null,xn=Ut[--Ft],Ut[Ft]=null}var Pt=null,Dt=null,qe=!1,Jt=null;function bc(e,t){var a=qt(5,null,null,0);a.elementType="DELETED",a.stateNode=t,a.return=e,t=e.deletions,t===null?(e.deletions=[a],e.flags|=16):t.push(a)}function _c(e,t){switch(e.tag){case 5:var a=e.type;return t=t.nodeType!==1||a.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Pt=e,Dt=$n(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Pt=e,Dt=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(a=ar!==null?{id:xn,overflow:wn}:null,e.memoizedState={dehydrated:t,treeContext:a,retryLane:1073741824},a=qt(18,null,null,0),a.stateNode=t,a.return=e,e.child=a,Pt=e,Dt=null,!0):!1;default:return!1}}function Ro(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Oo(e){if(qe){var t=Dt;if(t){var a=t;if(!_c(e,t)){if(Ro(e))throw Error(s(418));t=$n(a.nextSibling);var l=Pt;t&&_c(e,t)?bc(l,a):(e.flags=e.flags&-4097|2,qe=!1,Pt=e)}}else{if(Ro(e))throw Error(s(418));e.flags=e.flags&-4097|2,qe=!1,Pt=e}}}function kc(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Pt=e}function za(e){if(e!==Pt)return!1;if(!qe)return kc(e),qe=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!jo(e.type,e.memoizedProps)),t&&(t=Dt)){if(Ro(e))throw jc(),Error(s(418));for(;t;)bc(e,t),t=$n(t.nextSibling)}if(kc(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(s(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var a=e.data;if(a==="/$"){if(t===0){Dt=$n(e.nextSibling);break e}t--}else a!=="$"&&a!=="$!"&&a!=="$?"||t++}e=e.nextSibling}Dt=null}}else Dt=Pt?$n(e.stateNode.nextSibling):null;return!0}function jc(){for(var e=Dt;e;)e=$n(e.nextSibling)}function Lr(){Dt=Pt=null,qe=!1}function Po(e){Jt===null?Jt=[e]:Jt.push(e)}var Em=q.ReactCurrentBatchConfig;function Is(e,t,a){if(e=a.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(a._owner){if(a=a._owner,a){if(a.tag!==1)throw Error(s(309));var l=a.stateNode}if(!l)throw Error(s(147,e));var c=l,h=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===h?t.ref:(t=function(g){var k=c.refs;g===null?delete k[h]:k[h]=g},t._stringRef=h,t)}if(typeof e!="string")throw Error(s(284));if(!a._owner)throw Error(s(290,e))}return e}function Ba(e,t){throw e=Object.prototype.toString.call(t),Error(s(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Sc(e){var t=e._init;return t(e._payload)}function Nc(e){function t(R,I){if(e){var P=R.deletions;P===null?(R.deletions=[I],R.flags|=16):P.push(I)}}function a(R,I){if(!e)return null;for(;I!==null;)t(R,I),I=I.sibling;return null}function l(R,I){for(R=new Map;I!==null;)I.key!==null?R.set(I.key,I):R.set(I.index,I),I=I.sibling;return R}function c(R,I){return R=Kn(R,I),R.index=0,R.sibling=null,R}function h(R,I,P){return R.index=P,e?(P=R.alternate,P!==null?(P=P.index,P<I?(R.flags|=2,I):P):(R.flags|=2,I)):(R.flags|=1048576,I)}function g(R){return e&&R.alternate===null&&(R.flags|=2),R}function k(R,I,P,ee){return I===null||I.tag!==6?(I=Sl(P,R.mode,ee),I.return=R,I):(I=c(I,P),I.return=R,I)}function S(R,I,P,ee){var ce=P.type;return ce===Y?Q(R,I,P.props.children,ee,P.key):I!==null&&(I.elementType===ce||typeof ce=="object"&&ce!==null&&ce.$$typeof===ie&&Sc(ce)===I.type)?(ee=c(I,P.props),ee.ref=Is(R,I,P),ee.return=R,ee):(ee=hi(P.type,P.key,P.props,null,R.mode,ee),ee.ref=Is(R,I,P),ee.return=R,ee)}function F(R,I,P,ee){return I===null||I.tag!==4||I.stateNode.containerInfo!==P.containerInfo||I.stateNode.implementation!==P.implementation?(I=Nl(P,R.mode,ee),I.return=R,I):(I=c(I,P.children||[]),I.return=R,I)}function Q(R,I,P,ee,ce){return I===null||I.tag!==7?(I=mr(P,R.mode,ee,ce),I.return=R,I):(I=c(I,P),I.return=R,I)}function X(R,I,P){if(typeof I=="string"&&I!==""||typeof I=="number")return I=Sl(""+I,R.mode,P),I.return=R,I;if(typeof I=="object"&&I!==null){switch(I.$$typeof){case $:return P=hi(I.type,I.key,I.props,null,R.mode,P),P.ref=Is(R,null,I),P.return=R,P;case M:return I=Nl(I,R.mode,P),I.return=R,I;case ie:var ee=I._init;return X(R,ee(I._payload),P)}if(Ht(I)||B(I))return I=mr(I,R.mode,P,null),I.return=R,I;Ba(R,I)}return null}function J(R,I,P,ee){var ce=I!==null?I.key:null;if(typeof P=="string"&&P!==""||typeof P=="number")return ce!==null?null:k(R,I,""+P,ee);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case $:return P.key===ce?S(R,I,P,ee):null;case M:return P.key===ce?F(R,I,P,ee):null;case ie:return ce=P._init,J(R,I,ce(P._payload),ee)}if(Ht(P)||B(P))return ce!==null?null:Q(R,I,P,ee,null);Ba(R,P)}return null}function se(R,I,P,ee,ce){if(typeof ee=="string"&&ee!==""||typeof ee=="number")return R=R.get(P)||null,k(I,R,""+ee,ce);if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case $:return R=R.get(ee.key===null?P:ee.key)||null,S(I,R,ee,ce);case M:return R=R.get(ee.key===null?P:ee.key)||null,F(I,R,ee,ce);case ie:var pe=ee._init;return se(R,I,P,pe(ee._payload),ce)}if(Ht(ee)||B(ee))return R=R.get(P)||null,Q(I,R,ee,ce,null);Ba(I,ee)}return null}function le(R,I,P,ee){for(var ce=null,pe=null,ge=I,je=I=0,ct=null;ge!==null&&je<P.length;je++){ge.index>je?(ct=ge,ge=null):ct=ge.sibling;var Oe=J(R,ge,P[je],ee);if(Oe===null){ge===null&&(ge=ct);break}e&&ge&&Oe.alternate===null&&t(R,ge),I=h(Oe,I,je),pe===null?ce=Oe:pe.sibling=Oe,pe=Oe,ge=ct}if(je===P.length)return a(R,ge),qe&&ir(R,je),ce;if(ge===null){for(;je<P.length;je++)ge=X(R,P[je],ee),ge!==null&&(I=h(ge,I,je),pe===null?ce=ge:pe.sibling=ge,pe=ge);return qe&&ir(R,je),ce}for(ge=l(R,ge);je<P.length;je++)ct=se(ge,R,je,P[je],ee),ct!==null&&(e&&ct.alternate!==null&&ge.delete(ct.key===null?je:ct.key),I=h(ct,I,je),pe===null?ce=ct:pe.sibling=ct,pe=ct);return e&&ge.forEach(function(Jn){return t(R,Jn)}),qe&&ir(R,je),ce}function ue(R,I,P,ee){var ce=B(P);if(typeof ce!="function")throw Error(s(150));if(P=ce.call(P),P==null)throw Error(s(151));for(var pe=ce=null,ge=I,je=I=0,ct=null,Oe=P.next();ge!==null&&!Oe.done;je++,Oe=P.next()){ge.index>je?(ct=ge,ge=null):ct=ge.sibling;var Jn=J(R,ge,Oe.value,ee);if(Jn===null){ge===null&&(ge=ct);break}e&&ge&&Jn.alternate===null&&t(R,ge),I=h(Jn,I,je),pe===null?ce=Jn:pe.sibling=Jn,pe=Jn,ge=ct}if(Oe.done)return a(R,ge),qe&&ir(R,je),ce;if(ge===null){for(;!Oe.done;je++,Oe=P.next())Oe=X(R,Oe.value,ee),Oe!==null&&(I=h(Oe,I,je),pe===null?ce=Oe:pe.sibling=Oe,pe=Oe);return qe&&ir(R,je),ce}for(ge=l(R,ge);!Oe.done;je++,Oe=P.next())Oe=se(ge,R,je,Oe.value,ee),Oe!==null&&(e&&Oe.alternate!==null&&ge.delete(Oe.key===null?je:Oe.key),I=h(Oe,I,je),pe===null?ce=Oe:pe.sibling=Oe,pe=Oe);return e&&ge.forEach(function(ip){return t(R,ip)}),qe&&ir(R,je),ce}function Qe(R,I,P,ee){if(typeof P=="object"&&P!==null&&P.type===Y&&P.key===null&&(P=P.props.children),typeof P=="object"&&P!==null){switch(P.$$typeof){case $:e:{for(var ce=P.key,pe=I;pe!==null;){if(pe.key===ce){if(ce=P.type,ce===Y){if(pe.tag===7){a(R,pe.sibling),I=c(pe,P.props.children),I.return=R,R=I;break e}}else if(pe.elementType===ce||typeof ce=="object"&&ce!==null&&ce.$$typeof===ie&&Sc(ce)===pe.type){a(R,pe.sibling),I=c(pe,P.props),I.ref=Is(R,pe,P),I.return=R,R=I;break e}a(R,pe);break}else t(R,pe);pe=pe.sibling}P.type===Y?(I=mr(P.props.children,R.mode,ee,P.key),I.return=R,R=I):(ee=hi(P.type,P.key,P.props,null,R.mode,ee),ee.ref=Is(R,I,P),ee.return=R,R=ee)}return g(R);case M:e:{for(pe=P.key;I!==null;){if(I.key===pe)if(I.tag===4&&I.stateNode.containerInfo===P.containerInfo&&I.stateNode.implementation===P.implementation){a(R,I.sibling),I=c(I,P.children||[]),I.return=R,R=I;break e}else{a(R,I);break}else t(R,I);I=I.sibling}I=Nl(P,R.mode,ee),I.return=R,R=I}return g(R);case ie:return pe=P._init,Qe(R,I,pe(P._payload),ee)}if(Ht(P))return le(R,I,P,ee);if(B(P))return ue(R,I,P,ee);Ba(R,P)}return typeof P=="string"&&P!==""||typeof P=="number"?(P=""+P,I!==null&&I.tag===6?(a(R,I.sibling),I=c(I,P),I.return=R,R=I):(a(R,I),I=Sl(P,R.mode,ee),I.return=R,R=I),g(R)):a(R,I)}return Qe}var $r=Nc(!0),Ec=Nc(!1),Wa=Mn(null),qa=null,Mr=null,Do=null;function Lo(){Do=Mr=qa=null}function $o(e){var t=Wa.current;ze(Wa),e._currentValue=t}function Mo(e,t,a){for(;e!==null;){var l=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,l!==null&&(l.childLanes|=t)):l!==null&&(l.childLanes&t)!==t&&(l.childLanes|=t),e===a)break;e=e.return}}function Ur(e,t){qa=e,Do=Mr=null,e=e.dependencies,e!==null&&e.firstContext!==null&&((e.lanes&t)!==0&&(Ct=!0),e.firstContext=null)}function zt(e){var t=e._currentValue;if(Do!==e)if(e={context:e,memoizedValue:t,next:null},Mr===null){if(qa===null)throw Error(s(308));Mr=e,qa.dependencies={lanes:0,firstContext:e}}else Mr=Mr.next=e;return t}var or=null;function Uo(e){or===null?or=[e]:or.push(e)}function Cc(e,t,a,l){var c=t.interleaved;return c===null?(a.next=a,Uo(t)):(a.next=c.next,c.next=a),t.interleaved=a,bn(e,l)}function bn(e,t){e.lanes|=t;var a=e.alternate;for(a!==null&&(a.lanes|=t),a=e,e=e.return;e!==null;)e.childLanes|=t,a=e.alternate,a!==null&&(a.childLanes|=t),a=e,e=e.return;return a.tag===3?a.stateNode:null}var zn=!1;function Fo(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Tc(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function _n(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Bn(e,t,a){var l=e.updateQueue;if(l===null)return null;if(l=l.shared,(Ae&2)!==0){var c=l.pending;return c===null?t.next=t:(t.next=c.next,c.next=t),l.pending=t,bn(e,a)}return c=l.interleaved,c===null?(t.next=t,Uo(l)):(t.next=c.next,c.next=t),l.interleaved=t,bn(e,a)}function Va(e,t,a){if(t=t.updateQueue,t!==null&&(t=t.shared,(a&4194240)!==0)){var l=t.lanes;l&=e.pendingLanes,a|=l,t.lanes=a,Zi(e,a)}}function Ac(e,t){var a=e.updateQueue,l=e.alternate;if(l!==null&&(l=l.updateQueue,a===l)){var c=null,h=null;if(a=a.firstBaseUpdate,a!==null){do{var g={eventTime:a.eventTime,lane:a.lane,tag:a.tag,payload:a.payload,callback:a.callback,next:null};h===null?c=h=g:h=h.next=g,a=a.next}while(a!==null);h===null?c=h=t:h=h.next=t}else c=h=t;a={baseState:l.baseState,firstBaseUpdate:c,lastBaseUpdate:h,shared:l.shared,effects:l.effects},e.updateQueue=a;return}e=a.lastBaseUpdate,e===null?a.firstBaseUpdate=t:e.next=t,a.lastBaseUpdate=t}function Ha(e,t,a,l){var c=e.updateQueue;zn=!1;var h=c.firstBaseUpdate,g=c.lastBaseUpdate,k=c.shared.pending;if(k!==null){c.shared.pending=null;var S=k,F=S.next;S.next=null,g===null?h=F:g.next=F,g=S;var Q=e.alternate;Q!==null&&(Q=Q.updateQueue,k=Q.lastBaseUpdate,k!==g&&(k===null?Q.firstBaseUpdate=F:k.next=F,Q.lastBaseUpdate=S))}if(h!==null){var X=c.baseState;g=0,Q=F=S=null,k=h;do{var J=k.lane,se=k.eventTime;if((l&J)===J){Q!==null&&(Q=Q.next={eventTime:se,lane:0,tag:k.tag,payload:k.payload,callback:k.callback,next:null});e:{var le=e,ue=k;switch(J=t,se=a,ue.tag){case 1:if(le=ue.payload,typeof le=="function"){X=le.call(se,X,J);break e}X=le;break e;case 3:le.flags=le.flags&-65537|128;case 0:if(le=ue.payload,J=typeof le=="function"?le.call(se,X,J):le,J==null)break e;X=G({},X,J);break e;case 2:zn=!0}}k.callback!==null&&k.lane!==0&&(e.flags|=64,J=c.effects,J===null?c.effects=[k]:J.push(k))}else se={eventTime:se,lane:J,tag:k.tag,payload:k.payload,callback:k.callback,next:null},Q===null?(F=Q=se,S=X):Q=Q.next=se,g|=J;if(k=k.next,k===null){if(k=c.shared.pending,k===null)break;J=k,k=J.next,J.next=null,c.lastBaseUpdate=J,c.shared.pending=null}}while(!0);if(Q===null&&(S=X),c.baseState=S,c.firstBaseUpdate=F,c.lastBaseUpdate=Q,t=c.shared.interleaved,t!==null){c=t;do g|=c.lane,c=c.next;while(c!==t)}else h===null&&(c.shared.lanes=0);cr|=g,e.lanes=g,e.memoizedState=X}}function Ic(e,t,a){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var l=e[t],c=l.callback;if(c!==null){if(l.callback=null,l=a,typeof c!="function")throw Error(s(191,c));c.call(l)}}}var Rs={},un=Mn(Rs),Os=Mn(Rs),Ps=Mn(Rs);function lr(e){if(e===Rs)throw Error(s(174));return e}function zo(e,t){switch(Me(Ps,t),Me(Os,e),Me(un,Rs),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:zi(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=zi(t,e)}ze(un),Me(un,t)}function Fr(){ze(un),ze(Os),ze(Ps)}function Rc(e){lr(Ps.current);var t=lr(un.current),a=zi(t,e.type);t!==a&&(Me(Os,e),Me(un,a))}function Bo(e){Os.current===e&&(ze(un),ze(Os))}var Ve=Mn(0);function Ga(e){for(var t=e;t!==null;){if(t.tag===13){var a=t.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||a.data==="$?"||a.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Wo=[];function qo(){for(var e=0;e<Wo.length;e++)Wo[e]._workInProgressVersionPrimary=null;Wo.length=0}var Ka=q.ReactCurrentDispatcher,Vo=q.ReactCurrentBatchConfig,ur=0,He=null,st=null,lt=null,Ja=!1,Ds=!1,Ls=0,Cm=0;function vt(){throw Error(s(321))}function Ho(e,t){if(t===null)return!1;for(var a=0;a<t.length&&a<e.length;a++)if(!Kt(e[a],t[a]))return!1;return!0}function Go(e,t,a,l,c,h){if(ur=h,He=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Ka.current=e===null||e.memoizedState===null?Rm:Om,e=a(l,c),Ds){h=0;do{if(Ds=!1,Ls=0,25<=h)throw Error(s(301));h+=1,lt=st=null,t.updateQueue=null,Ka.current=Pm,e=a(l,c)}while(Ds)}if(Ka.current=Xa,t=st!==null&&st.next!==null,ur=0,lt=st=He=null,Ja=!1,t)throw Error(s(300));return e}function Ko(){var e=Ls!==0;return Ls=0,e}function cn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return lt===null?He.memoizedState=lt=e:lt=lt.next=e,lt}function Bt(){if(st===null){var e=He.alternate;e=e!==null?e.memoizedState:null}else e=st.next;var t=lt===null?He.memoizedState:lt.next;if(t!==null)lt=t,st=e;else{if(e===null)throw Error(s(310));st=e,e={memoizedState:st.memoizedState,baseState:st.baseState,baseQueue:st.baseQueue,queue:st.queue,next:null},lt===null?He.memoizedState=lt=e:lt=lt.next=e}return lt}function $s(e,t){return typeof t=="function"?t(e):t}function Jo(e){var t=Bt(),a=t.queue;if(a===null)throw Error(s(311));a.lastRenderedReducer=e;var l=st,c=l.baseQueue,h=a.pending;if(h!==null){if(c!==null){var g=c.next;c.next=h.next,h.next=g}l.baseQueue=c=h,a.pending=null}if(c!==null){h=c.next,l=l.baseState;var k=g=null,S=null,F=h;do{var Q=F.lane;if((ur&Q)===Q)S!==null&&(S=S.next={lane:0,action:F.action,hasEagerState:F.hasEagerState,eagerState:F.eagerState,next:null}),l=F.hasEagerState?F.eagerState:e(l,F.action);else{var X={lane:Q,action:F.action,hasEagerState:F.hasEagerState,eagerState:F.eagerState,next:null};S===null?(k=S=X,g=l):S=S.next=X,He.lanes|=Q,cr|=Q}F=F.next}while(F!==null&&F!==h);S===null?g=l:S.next=k,Kt(l,t.memoizedState)||(Ct=!0),t.memoizedState=l,t.baseState=g,t.baseQueue=S,a.lastRenderedState=l}if(e=a.interleaved,e!==null){c=e;do h=c.lane,He.lanes|=h,cr|=h,c=c.next;while(c!==e)}else c===null&&(a.lanes=0);return[t.memoizedState,a.dispatch]}function Qo(e){var t=Bt(),a=t.queue;if(a===null)throw Error(s(311));a.lastRenderedReducer=e;var l=a.dispatch,c=a.pending,h=t.memoizedState;if(c!==null){a.pending=null;var g=c=c.next;do h=e(h,g.action),g=g.next;while(g!==c);Kt(h,t.memoizedState)||(Ct=!0),t.memoizedState=h,t.baseQueue===null&&(t.baseState=h),a.lastRenderedState=h}return[h,l]}function Oc(){}function Pc(e,t){var a=He,l=Bt(),c=t(),h=!Kt(l.memoizedState,c);if(h&&(l.memoizedState=c,Ct=!0),l=l.queue,Yo($c.bind(null,a,l,e),[e]),l.getSnapshot!==t||h||lt!==null&&lt.memoizedState.tag&1){if(a.flags|=2048,Ms(9,Lc.bind(null,a,l,c,t),void 0,null),ut===null)throw Error(s(349));(ur&30)!==0||Dc(a,t,c)}return c}function Dc(e,t,a){e.flags|=16384,e={getSnapshot:t,value:a},t=He.updateQueue,t===null?(t={lastEffect:null,stores:null},He.updateQueue=t,t.stores=[e]):(a=t.stores,a===null?t.stores=[e]:a.push(e))}function Lc(e,t,a,l){t.value=a,t.getSnapshot=l,Mc(t)&&Uc(e)}function $c(e,t,a){return a(function(){Mc(t)&&Uc(e)})}function Mc(e){var t=e.getSnapshot;e=e.value;try{var a=t();return!Kt(e,a)}catch{return!0}}function Uc(e){var t=bn(e,1);t!==null&&Zt(t,e,1,-1)}function Fc(e){var t=cn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:$s,lastRenderedState:e},t.queue=e,e=e.dispatch=Im.bind(null,He,e),[t.memoizedState,e]}function Ms(e,t,a,l){return e={tag:e,create:t,destroy:a,deps:l,next:null},t=He.updateQueue,t===null?(t={lastEffect:null,stores:null},He.updateQueue=t,t.lastEffect=e.next=e):(a=t.lastEffect,a===null?t.lastEffect=e.next=e:(l=a.next,a.next=e,e.next=l,t.lastEffect=e)),e}function zc(){return Bt().memoizedState}function Qa(e,t,a,l){var c=cn();He.flags|=e,c.memoizedState=Ms(1|t,a,void 0,l===void 0?null:l)}function Ya(e,t,a,l){var c=Bt();l=l===void 0?null:l;var h=void 0;if(st!==null){var g=st.memoizedState;if(h=g.destroy,l!==null&&Ho(l,g.deps)){c.memoizedState=Ms(t,a,h,l);return}}He.flags|=e,c.memoizedState=Ms(1|t,a,h,l)}function Bc(e,t){return Qa(8390656,8,e,t)}function Yo(e,t){return Ya(2048,8,e,t)}function Wc(e,t){return Ya(4,2,e,t)}function qc(e,t){return Ya(4,4,e,t)}function Vc(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Hc(e,t,a){return a=a!=null?a.concat([e]):null,Ya(4,4,Vc.bind(null,t,e),a)}function Xo(){}function Gc(e,t){var a=Bt();t=t===void 0?null:t;var l=a.memoizedState;return l!==null&&t!==null&&Ho(t,l[1])?l[0]:(a.memoizedState=[e,t],e)}function Kc(e,t){var a=Bt();t=t===void 0?null:t;var l=a.memoizedState;return l!==null&&t!==null&&Ho(t,l[1])?l[0]:(e=e(),a.memoizedState=[e,t],e)}function Jc(e,t,a){return(ur&21)===0?(e.baseState&&(e.baseState=!1,Ct=!0),e.memoizedState=a):(Kt(a,t)||(a=Su(),He.lanes|=a,cr|=a,e.baseState=!0),t)}function Tm(e,t){var a=De;De=a!==0&&4>a?a:4,e(!0);var l=Vo.transition;Vo.transition={};try{e(!1),t()}finally{De=a,Vo.transition=l}}function Qc(){return Bt().memoizedState}function Am(e,t,a){var l=Hn(e);if(a={lane:l,action:a,hasEagerState:!1,eagerState:null,next:null},Yc(e))Xc(t,a);else if(a=Cc(e,t,a,l),a!==null){var c=_t();Zt(a,e,l,c),Zc(a,t,l)}}function Im(e,t,a){var l=Hn(e),c={lane:l,action:a,hasEagerState:!1,eagerState:null,next:null};if(Yc(e))Xc(t,c);else{var h=e.alternate;if(e.lanes===0&&(h===null||h.lanes===0)&&(h=t.lastRenderedReducer,h!==null))try{var g=t.lastRenderedState,k=h(g,a);if(c.hasEagerState=!0,c.eagerState=k,Kt(k,g)){var S=t.interleaved;S===null?(c.next=c,Uo(t)):(c.next=S.next,S.next=c),t.interleaved=c;return}}catch{}finally{}a=Cc(e,t,c,l),a!==null&&(c=_t(),Zt(a,e,l,c),Zc(a,t,l))}}function Yc(e){var t=e.alternate;return e===He||t!==null&&t===He}function Xc(e,t){Ds=Ja=!0;var a=e.pending;a===null?t.next=t:(t.next=a.next,a.next=t),e.pending=t}function Zc(e,t,a){if((a&4194240)!==0){var l=t.lanes;l&=e.pendingLanes,a|=l,t.lanes=a,Zi(e,a)}}var Xa={readContext:zt,useCallback:vt,useContext:vt,useEffect:vt,useImperativeHandle:vt,useInsertionEffect:vt,useLayoutEffect:vt,useMemo:vt,useReducer:vt,useRef:vt,useState:vt,useDebugValue:vt,useDeferredValue:vt,useTransition:vt,useMutableSource:vt,useSyncExternalStore:vt,useId:vt,unstable_isNewReconciler:!1},Rm={readContext:zt,useCallback:function(e,t){return cn().memoizedState=[e,t===void 0?null:t],e},useContext:zt,useEffect:Bc,useImperativeHandle:function(e,t,a){return a=a!=null?a.concat([e]):null,Qa(4194308,4,Vc.bind(null,t,e),a)},useLayoutEffect:function(e,t){return Qa(4194308,4,e,t)},useInsertionEffect:function(e,t){return Qa(4,2,e,t)},useMemo:function(e,t){var a=cn();return t=t===void 0?null:t,e=e(),a.memoizedState=[e,t],e},useReducer:function(e,t,a){var l=cn();return t=a!==void 0?a(t):t,l.memoizedState=l.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},l.queue=e,e=e.dispatch=Am.bind(null,He,e),[l.memoizedState,e]},useRef:function(e){var t=cn();return e={current:e},t.memoizedState=e},useState:Fc,useDebugValue:Xo,useDeferredValue:function(e){return cn().memoizedState=e},useTransition:function(){var e=Fc(!1),t=e[0];return e=Tm.bind(null,e[1]),cn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,a){var l=He,c=cn();if(qe){if(a===void 0)throw Error(s(407));a=a()}else{if(a=t(),ut===null)throw Error(s(349));(ur&30)!==0||Dc(l,t,a)}c.memoizedState=a;var h={value:a,getSnapshot:t};return c.queue=h,Bc($c.bind(null,l,h,e),[e]),l.flags|=2048,Ms(9,Lc.bind(null,l,h,a,t),void 0,null),a},useId:function(){var e=cn(),t=ut.identifierPrefix;if(qe){var a=wn,l=xn;a=(l&~(1<<32-Gt(l)-1)).toString(32)+a,t=":"+t+"R"+a,a=Ls++,0<a&&(t+="H"+a.toString(32)),t+=":"}else a=Cm++,t=":"+t+"r"+a.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Om={readContext:zt,useCallback:Gc,useContext:zt,useEffect:Yo,useImperativeHandle:Hc,useInsertionEffect:Wc,useLayoutEffect:qc,useMemo:Kc,useReducer:Jo,useRef:zc,useState:function(){return Jo($s)},useDebugValue:Xo,useDeferredValue:function(e){var t=Bt();return Jc(t,st.memoizedState,e)},useTransition:function(){var e=Jo($s)[0],t=Bt().memoizedState;return[e,t]},useMutableSource:Oc,useSyncExternalStore:Pc,useId:Qc,unstable_isNewReconciler:!1},Pm={readContext:zt,useCallback:Gc,useContext:zt,useEffect:Yo,useImperativeHandle:Hc,useInsertionEffect:Wc,useLayoutEffect:qc,useMemo:Kc,useReducer:Qo,useRef:zc,useState:function(){return Qo($s)},useDebugValue:Xo,useDeferredValue:function(e){var t=Bt();return st===null?t.memoizedState=e:Jc(t,st.memoizedState,e)},useTransition:function(){var e=Qo($s)[0],t=Bt().memoizedState;return[e,t]},useMutableSource:Oc,useSyncExternalStore:Pc,useId:Qc,unstable_isNewReconciler:!1};function Qt(e,t){if(e&&e.defaultProps){t=G({},t),e=e.defaultProps;for(var a in e)t[a]===void 0&&(t[a]=e[a]);return t}return t}function Zo(e,t,a,l){t=e.memoizedState,a=a(l,t),a=a==null?t:G({},t,a),e.memoizedState=a,e.lanes===0&&(e.updateQueue.baseState=a)}var Za={isMounted:function(e){return(e=e._reactInternals)?nr(e)===e:!1},enqueueSetState:function(e,t,a){e=e._reactInternals;var l=_t(),c=Hn(e),h=_n(l,c);h.payload=t,a!=null&&(h.callback=a),t=Bn(e,h,c),t!==null&&(Zt(t,e,c,l),Va(t,e,c))},enqueueReplaceState:function(e,t,a){e=e._reactInternals;var l=_t(),c=Hn(e),h=_n(l,c);h.tag=1,h.payload=t,a!=null&&(h.callback=a),t=Bn(e,h,c),t!==null&&(Zt(t,e,c,l),Va(t,e,c))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var a=_t(),l=Hn(e),c=_n(a,l);c.tag=2,t!=null&&(c.callback=t),t=Bn(e,c,l),t!==null&&(Zt(t,e,l,a),Va(t,e,l))}};function ed(e,t,a,l,c,h,g){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(l,h,g):t.prototype&&t.prototype.isPureReactComponent?!js(a,l)||!js(c,h):!0}function td(e,t,a){var l=!1,c=Un,h=t.contextType;return typeof h=="object"&&h!==null?h=zt(h):(c=Et(t)?sr:yt.current,l=t.contextTypes,h=(l=l!=null)?Or(e,c):Un),t=new t(a,h),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Za,e.stateNode=t,t._reactInternals=e,l&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=c,e.__reactInternalMemoizedMaskedChildContext=h),t}function nd(e,t,a,l){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(a,l),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(a,l),t.state!==e&&Za.enqueueReplaceState(t,t.state,null)}function el(e,t,a,l){var c=e.stateNode;c.props=a,c.state=e.memoizedState,c.refs={},Fo(e);var h=t.contextType;typeof h=="object"&&h!==null?c.context=zt(h):(h=Et(t)?sr:yt.current,c.context=Or(e,h)),c.state=e.memoizedState,h=t.getDerivedStateFromProps,typeof h=="function"&&(Zo(e,t,h,a),c.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof c.getSnapshotBeforeUpdate=="function"||typeof c.UNSAFE_componentWillMount!="function"&&typeof c.componentWillMount!="function"||(t=c.state,typeof c.componentWillMount=="function"&&c.componentWillMount(),typeof c.UNSAFE_componentWillMount=="function"&&c.UNSAFE_componentWillMount(),t!==c.state&&Za.enqueueReplaceState(c,c.state,null),Ha(e,a,c,l),c.state=e.memoizedState),typeof c.componentDidMount=="function"&&(e.flags|=4194308)}function zr(e,t){try{var a="",l=t;do a+=we(l),l=l.return;while(l);var c=a}catch(h){c=`
Error generating stack: `+h.message+`
`+h.stack}return{value:e,source:t,stack:c,digest:null}}function tl(e,t,a){return{value:e,source:null,stack:a??null,digest:t??null}}function nl(e,t){try{console.error(t.value)}catch(a){setTimeout(function(){throw a})}}var Dm=typeof WeakMap=="function"?WeakMap:Map;function rd(e,t,a){a=_n(-1,a),a.tag=3,a.payload={element:null};var l=t.value;return a.callback=function(){ii||(ii=!0,yl=l),nl(e,t)},a}function sd(e,t,a){a=_n(-1,a),a.tag=3;var l=e.type.getDerivedStateFromError;if(typeof l=="function"){var c=t.value;a.payload=function(){return l(c)},a.callback=function(){nl(e,t)}}var h=e.stateNode;return h!==null&&typeof h.componentDidCatch=="function"&&(a.callback=function(){nl(e,t),typeof l!="function"&&(qn===null?qn=new Set([this]):qn.add(this));var g=t.stack;this.componentDidCatch(t.value,{componentStack:g!==null?g:""})}),a}function ad(e,t,a){var l=e.pingCache;if(l===null){l=e.pingCache=new Dm;var c=new Set;l.set(t,c)}else c=l.get(t),c===void 0&&(c=new Set,l.set(t,c));c.has(a)||(c.add(a),e=Jm.bind(null,e,t,a),t.then(e,e))}function id(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function od(e,t,a,l,c){return(e.mode&1)===0?(e===t?e.flags|=65536:(e.flags|=128,a.flags|=131072,a.flags&=-52805,a.tag===1&&(a.alternate===null?a.tag=17:(t=_n(-1,1),t.tag=2,Bn(a,t,1))),a.lanes|=1),e):(e.flags|=65536,e.lanes=c,e)}var Lm=q.ReactCurrentOwner,Ct=!1;function bt(e,t,a,l){t.child=e===null?Ec(t,null,a,l):$r(t,e.child,a,l)}function ld(e,t,a,l,c){a=a.render;var h=t.ref;return Ur(t,c),l=Go(e,t,a,l,h,c),a=Ko(),e!==null&&!Ct?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~c,kn(e,t,c)):(qe&&a&&Ao(t),t.flags|=1,bt(e,t,l,c),t.child)}function ud(e,t,a,l,c){if(e===null){var h=a.type;return typeof h=="function"&&!jl(h)&&h.defaultProps===void 0&&a.compare===null&&a.defaultProps===void 0?(t.tag=15,t.type=h,cd(e,t,h,l,c)):(e=hi(a.type,null,l,t,t.mode,c),e.ref=t.ref,e.return=t,t.child=e)}if(h=e.child,(e.lanes&c)===0){var g=h.memoizedProps;if(a=a.compare,a=a!==null?a:js,a(g,l)&&e.ref===t.ref)return kn(e,t,c)}return t.flags|=1,e=Kn(h,l),e.ref=t.ref,e.return=t,t.child=e}function cd(e,t,a,l,c){if(e!==null){var h=e.memoizedProps;if(js(h,l)&&e.ref===t.ref)if(Ct=!1,t.pendingProps=l=h,(e.lanes&c)!==0)(e.flags&131072)!==0&&(Ct=!0);else return t.lanes=e.lanes,kn(e,t,c)}return rl(e,t,a,l,c)}function dd(e,t,a){var l=t.pendingProps,c=l.children,h=e!==null?e.memoizedState:null;if(l.mode==="hidden")if((t.mode&1)===0)t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Me(Wr,Lt),Lt|=a;else{if((a&1073741824)===0)return e=h!==null?h.baseLanes|a:a,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Me(Wr,Lt),Lt|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},l=h!==null?h.baseLanes:a,Me(Wr,Lt),Lt|=l}else h!==null?(l=h.baseLanes|a,t.memoizedState=null):l=a,Me(Wr,Lt),Lt|=l;return bt(e,t,c,a),t.child}function hd(e,t){var a=t.ref;(e===null&&a!==null||e!==null&&e.ref!==a)&&(t.flags|=512,t.flags|=2097152)}function rl(e,t,a,l,c){var h=Et(a)?sr:yt.current;return h=Or(t,h),Ur(t,c),a=Go(e,t,a,l,h,c),l=Ko(),e!==null&&!Ct?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~c,kn(e,t,c)):(qe&&l&&Ao(t),t.flags|=1,bt(e,t,a,c),t.child)}function fd(e,t,a,l,c){if(Et(a)){var h=!0;$a(t)}else h=!1;if(Ur(t,c),t.stateNode===null)ti(e,t),td(t,a,l),el(t,a,l,c),l=!0;else if(e===null){var g=t.stateNode,k=t.memoizedProps;g.props=k;var S=g.context,F=a.contextType;typeof F=="object"&&F!==null?F=zt(F):(F=Et(a)?sr:yt.current,F=Or(t,F));var Q=a.getDerivedStateFromProps,X=typeof Q=="function"||typeof g.getSnapshotBeforeUpdate=="function";X||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(k!==l||S!==F)&&nd(t,g,l,F),zn=!1;var J=t.memoizedState;g.state=J,Ha(t,l,g,c),S=t.memoizedState,k!==l||J!==S||Nt.current||zn?(typeof Q=="function"&&(Zo(t,a,Q,l),S=t.memoizedState),(k=zn||ed(t,a,k,l,J,S,F))?(X||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount()),typeof g.componentDidMount=="function"&&(t.flags|=4194308)):(typeof g.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=l,t.memoizedState=S),g.props=l,g.state=S,g.context=F,l=k):(typeof g.componentDidMount=="function"&&(t.flags|=4194308),l=!1)}else{g=t.stateNode,Tc(e,t),k=t.memoizedProps,F=t.type===t.elementType?k:Qt(t.type,k),g.props=F,X=t.pendingProps,J=g.context,S=a.contextType,typeof S=="object"&&S!==null?S=zt(S):(S=Et(a)?sr:yt.current,S=Or(t,S));var se=a.getDerivedStateFromProps;(Q=typeof se=="function"||typeof g.getSnapshotBeforeUpdate=="function")||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(k!==X||J!==S)&&nd(t,g,l,S),zn=!1,J=t.memoizedState,g.state=J,Ha(t,l,g,c);var le=t.memoizedState;k!==X||J!==le||Nt.current||zn?(typeof se=="function"&&(Zo(t,a,se,l),le=t.memoizedState),(F=zn||ed(t,a,F,l,J,le,S)||!1)?(Q||typeof g.UNSAFE_componentWillUpdate!="function"&&typeof g.componentWillUpdate!="function"||(typeof g.componentWillUpdate=="function"&&g.componentWillUpdate(l,le,S),typeof g.UNSAFE_componentWillUpdate=="function"&&g.UNSAFE_componentWillUpdate(l,le,S)),typeof g.componentDidUpdate=="function"&&(t.flags|=4),typeof g.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof g.componentDidUpdate!="function"||k===e.memoizedProps&&J===e.memoizedState||(t.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||k===e.memoizedProps&&J===e.memoizedState||(t.flags|=1024),t.memoizedProps=l,t.memoizedState=le),g.props=l,g.state=le,g.context=S,l=F):(typeof g.componentDidUpdate!="function"||k===e.memoizedProps&&J===e.memoizedState||(t.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||k===e.memoizedProps&&J===e.memoizedState||(t.flags|=1024),l=!1)}return sl(e,t,a,l,h,c)}function sl(e,t,a,l,c,h){hd(e,t);var g=(t.flags&128)!==0;if(!l&&!g)return c&&vc(t,a,!1),kn(e,t,h);l=t.stateNode,Lm.current=t;var k=g&&typeof a.getDerivedStateFromError!="function"?null:l.render();return t.flags|=1,e!==null&&g?(t.child=$r(t,e.child,null,h),t.child=$r(t,null,k,h)):bt(e,t,k,h),t.memoizedState=l.state,c&&vc(t,a,!0),t.child}function md(e){var t=e.stateNode;t.pendingContext?gc(e,t.pendingContext,t.pendingContext!==t.context):t.context&&gc(e,t.context,!1),zo(e,t.containerInfo)}function pd(e,t,a,l,c){return Lr(),Po(c),t.flags|=256,bt(e,t,a,l),t.child}var al={dehydrated:null,treeContext:null,retryLane:0};function il(e){return{baseLanes:e,cachePool:null,transitions:null}}function gd(e,t,a){var l=t.pendingProps,c=Ve.current,h=!1,g=(t.flags&128)!==0,k;if((k=g)||(k=e!==null&&e.memoizedState===null?!1:(c&2)!==0),k?(h=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(c|=1),Me(Ve,c&1),e===null)return Oo(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?((t.mode&1)===0?t.lanes=1:e.data==="$!"?t.lanes=8:t.lanes=1073741824,null):(g=l.children,e=l.fallback,h?(l=t.mode,h=t.child,g={mode:"hidden",children:g},(l&1)===0&&h!==null?(h.childLanes=0,h.pendingProps=g):h=fi(g,l,0,null),e=mr(e,l,a,null),h.return=t,e.return=t,h.sibling=e,t.child=h,t.child.memoizedState=il(a),t.memoizedState=al,e):ol(t,g));if(c=e.memoizedState,c!==null&&(k=c.dehydrated,k!==null))return $m(e,t,g,l,k,c,a);if(h){h=l.fallback,g=t.mode,c=e.child,k=c.sibling;var S={mode:"hidden",children:l.children};return(g&1)===0&&t.child!==c?(l=t.child,l.childLanes=0,l.pendingProps=S,t.deletions=null):(l=Kn(c,S),l.subtreeFlags=c.subtreeFlags&14680064),k!==null?h=Kn(k,h):(h=mr(h,g,a,null),h.flags|=2),h.return=t,l.return=t,l.sibling=h,t.child=l,l=h,h=t.child,g=e.child.memoizedState,g=g===null?il(a):{baseLanes:g.baseLanes|a,cachePool:null,transitions:g.transitions},h.memoizedState=g,h.childLanes=e.childLanes&~a,t.memoizedState=al,l}return h=e.child,e=h.sibling,l=Kn(h,{mode:"visible",children:l.children}),(t.mode&1)===0&&(l.lanes=a),l.return=t,l.sibling=null,e!==null&&(a=t.deletions,a===null?(t.deletions=[e],t.flags|=16):a.push(e)),t.child=l,t.memoizedState=null,l}function ol(e,t){return t=fi({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function ei(e,t,a,l){return l!==null&&Po(l),$r(t,e.child,null,a),e=ol(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function $m(e,t,a,l,c,h,g){if(a)return t.flags&256?(t.flags&=-257,l=tl(Error(s(422))),ei(e,t,g,l)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(h=l.fallback,c=t.mode,l=fi({mode:"visible",children:l.children},c,0,null),h=mr(h,c,g,null),h.flags|=2,l.return=t,h.return=t,l.sibling=h,t.child=l,(t.mode&1)!==0&&$r(t,e.child,null,g),t.child.memoizedState=il(g),t.memoizedState=al,h);if((t.mode&1)===0)return ei(e,t,g,null);if(c.data==="$!"){if(l=c.nextSibling&&c.nextSibling.dataset,l)var k=l.dgst;return l=k,h=Error(s(419)),l=tl(h,l,void 0),ei(e,t,g,l)}if(k=(g&e.childLanes)!==0,Ct||k){if(l=ut,l!==null){switch(g&-g){case 4:c=2;break;case 16:c=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:c=32;break;case 536870912:c=268435456;break;default:c=0}c=(c&(l.suspendedLanes|g))!==0?0:c,c!==0&&c!==h.retryLane&&(h.retryLane=c,bn(e,c),Zt(l,e,c,-1))}return kl(),l=tl(Error(s(421))),ei(e,t,g,l)}return c.data==="$?"?(t.flags|=128,t.child=e.child,t=Qm.bind(null,e),c._reactRetry=t,null):(e=h.treeContext,Dt=$n(c.nextSibling),Pt=t,qe=!0,Jt=null,e!==null&&(Ut[Ft++]=xn,Ut[Ft++]=wn,Ut[Ft++]=ar,xn=e.id,wn=e.overflow,ar=t),t=ol(t,l.children),t.flags|=4096,t)}function yd(e,t,a){e.lanes|=t;var l=e.alternate;l!==null&&(l.lanes|=t),Mo(e.return,t,a)}function ll(e,t,a,l,c){var h=e.memoizedState;h===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:l,tail:a,tailMode:c}:(h.isBackwards=t,h.rendering=null,h.renderingStartTime=0,h.last=l,h.tail=a,h.tailMode=c)}function vd(e,t,a){var l=t.pendingProps,c=l.revealOrder,h=l.tail;if(bt(e,t,l.children,a),l=Ve.current,(l&2)!==0)l=l&1|2,t.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&yd(e,a,t);else if(e.tag===19)yd(e,a,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}l&=1}if(Me(Ve,l),(t.mode&1)===0)t.memoizedState=null;else switch(c){case"forwards":for(a=t.child,c=null;a!==null;)e=a.alternate,e!==null&&Ga(e)===null&&(c=a),a=a.sibling;a=c,a===null?(c=t.child,t.child=null):(c=a.sibling,a.sibling=null),ll(t,!1,c,a,h);break;case"backwards":for(a=null,c=t.child,t.child=null;c!==null;){if(e=c.alternate,e!==null&&Ga(e)===null){t.child=c;break}e=c.sibling,c.sibling=a,a=c,c=e}ll(t,!0,a,null,h);break;case"together":ll(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function ti(e,t){(t.mode&1)===0&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function kn(e,t,a){if(e!==null&&(t.dependencies=e.dependencies),cr|=t.lanes,(a&t.childLanes)===0)return null;if(e!==null&&t.child!==e.child)throw Error(s(153));if(t.child!==null){for(e=t.child,a=Kn(e,e.pendingProps),t.child=a,a.return=t;e.sibling!==null;)e=e.sibling,a=a.sibling=Kn(e,e.pendingProps),a.return=t;a.sibling=null}return t.child}function Mm(e,t,a){switch(t.tag){case 3:md(t),Lr();break;case 5:Rc(t);break;case 1:Et(t.type)&&$a(t);break;case 4:zo(t,t.stateNode.containerInfo);break;case 10:var l=t.type._context,c=t.memoizedProps.value;Me(Wa,l._currentValue),l._currentValue=c;break;case 13:if(l=t.memoizedState,l!==null)return l.dehydrated!==null?(Me(Ve,Ve.current&1),t.flags|=128,null):(a&t.child.childLanes)!==0?gd(e,t,a):(Me(Ve,Ve.current&1),e=kn(e,t,a),e!==null?e.sibling:null);Me(Ve,Ve.current&1);break;case 19:if(l=(a&t.childLanes)!==0,(e.flags&128)!==0){if(l)return vd(e,t,a);t.flags|=128}if(c=t.memoizedState,c!==null&&(c.rendering=null,c.tail=null,c.lastEffect=null),Me(Ve,Ve.current),l)break;return null;case 22:case 23:return t.lanes=0,dd(e,t,a)}return kn(e,t,a)}var xd,ul,wd,bd;xd=function(e,t){for(var a=t.child;a!==null;){if(a.tag===5||a.tag===6)e.appendChild(a.stateNode);else if(a.tag!==4&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===t)break;for(;a.sibling===null;){if(a.return===null||a.return===t)return;a=a.return}a.sibling.return=a.return,a=a.sibling}},ul=function(){},wd=function(e,t,a,l){var c=e.memoizedProps;if(c!==l){e=t.stateNode,lr(un.current);var h=null;switch(a){case"input":c=U(e,c),l=U(e,l),h=[];break;case"select":c=G({},c,{value:void 0}),l=G({},l,{value:void 0}),h=[];break;case"textarea":c=fe(e,c),l=fe(e,l),h=[];break;default:typeof c.onClick!="function"&&typeof l.onClick=="function"&&(e.onclick=Pa)}Bi(a,l);var g;a=null;for(F in c)if(!l.hasOwnProperty(F)&&c.hasOwnProperty(F)&&c[F]!=null)if(F==="style"){var k=c[F];for(g in k)k.hasOwnProperty(g)&&(a||(a={}),a[g]="")}else F!=="dangerouslySetInnerHTML"&&F!=="children"&&F!=="suppressContentEditableWarning"&&F!=="suppressHydrationWarning"&&F!=="autoFocus"&&(u.hasOwnProperty(F)?h||(h=[]):(h=h||[]).push(F,null));for(F in l){var S=l[F];if(k=c!=null?c[F]:void 0,l.hasOwnProperty(F)&&S!==k&&(S!=null||k!=null))if(F==="style")if(k){for(g in k)!k.hasOwnProperty(g)||S&&S.hasOwnProperty(g)||(a||(a={}),a[g]="");for(g in S)S.hasOwnProperty(g)&&k[g]!==S[g]&&(a||(a={}),a[g]=S[g])}else a||(h||(h=[]),h.push(F,a)),a=S;else F==="dangerouslySetInnerHTML"?(S=S?S.__html:void 0,k=k?k.__html:void 0,S!=null&&k!==S&&(h=h||[]).push(F,S)):F==="children"?typeof S!="string"&&typeof S!="number"||(h=h||[]).push(F,""+S):F!=="suppressContentEditableWarning"&&F!=="suppressHydrationWarning"&&(u.hasOwnProperty(F)?(S!=null&&F==="onScroll"&&Fe("scroll",e),h||k===S||(h=[])):(h=h||[]).push(F,S))}a&&(h=h||[]).push("style",a);var F=h;(t.updateQueue=F)&&(t.flags|=4)}},bd=function(e,t,a,l){a!==l&&(t.flags|=4)};function Us(e,t){if(!qe)switch(e.tailMode){case"hidden":t=e.tail;for(var a=null;t!==null;)t.alternate!==null&&(a=t),t=t.sibling;a===null?e.tail=null:a.sibling=null;break;case"collapsed":a=e.tail;for(var l=null;a!==null;)a.alternate!==null&&(l=a),a=a.sibling;l===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:l.sibling=null}}function xt(e){var t=e.alternate!==null&&e.alternate.child===e.child,a=0,l=0;if(t)for(var c=e.child;c!==null;)a|=c.lanes|c.childLanes,l|=c.subtreeFlags&14680064,l|=c.flags&14680064,c.return=e,c=c.sibling;else for(c=e.child;c!==null;)a|=c.lanes|c.childLanes,l|=c.subtreeFlags,l|=c.flags,c.return=e,c=c.sibling;return e.subtreeFlags|=l,e.childLanes=a,t}function Um(e,t,a){var l=t.pendingProps;switch(Io(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return xt(t),null;case 1:return Et(t.type)&&La(),xt(t),null;case 3:return l=t.stateNode,Fr(),ze(Nt),ze(yt),qo(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(e===null||e.child===null)&&(za(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,Jt!==null&&(wl(Jt),Jt=null))),ul(e,t),xt(t),null;case 5:Bo(t);var c=lr(Ps.current);if(a=t.type,e!==null&&t.stateNode!=null)wd(e,t,a,l,c),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!l){if(t.stateNode===null)throw Error(s(166));return xt(t),null}if(e=lr(un.current),za(t)){l=t.stateNode,a=t.type;var h=t.memoizedProps;switch(l[ln]=t,l[Ts]=h,e=(t.mode&1)!==0,a){case"dialog":Fe("cancel",l),Fe("close",l);break;case"iframe":case"object":case"embed":Fe("load",l);break;case"video":case"audio":for(c=0;c<Ns.length;c++)Fe(Ns[c],l);break;case"source":Fe("error",l);break;case"img":case"image":case"link":Fe("error",l),Fe("load",l);break;case"details":Fe("toggle",l);break;case"input":ne(l,h),Fe("invalid",l);break;case"select":l._wrapperState={wasMultiple:!!h.multiple},Fe("invalid",l);break;case"textarea":We(l,h),Fe("invalid",l)}Bi(a,h),c=null;for(var g in h)if(h.hasOwnProperty(g)){var k=h[g];g==="children"?typeof k=="string"?l.textContent!==k&&(h.suppressHydrationWarning!==!0&&Oa(l.textContent,k,e),c=["children",k]):typeof k=="number"&&l.textContent!==""+k&&(h.suppressHydrationWarning!==!0&&Oa(l.textContent,k,e),c=["children",""+k]):u.hasOwnProperty(g)&&k!=null&&g==="onScroll"&&Fe("scroll",l)}switch(a){case"input":Te(l),gn(l,h,!0);break;case"textarea":Te(l),iu(l);break;case"select":case"option":break;default:typeof h.onClick=="function"&&(l.onclick=Pa)}l=c,t.updateQueue=l,l!==null&&(t.flags|=4)}else{g=c.nodeType===9?c:c.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=ou(a)),e==="http://www.w3.org/1999/xhtml"?a==="script"?(e=g.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof l.is=="string"?e=g.createElement(a,{is:l.is}):(e=g.createElement(a),a==="select"&&(g=e,l.multiple?g.multiple=!0:l.size&&(g.size=l.size))):e=g.createElementNS(e,a),e[ln]=t,e[Ts]=l,xd(e,t,!1,!1),t.stateNode=e;e:{switch(g=Wi(a,l),a){case"dialog":Fe("cancel",e),Fe("close",e),c=l;break;case"iframe":case"object":case"embed":Fe("load",e),c=l;break;case"video":case"audio":for(c=0;c<Ns.length;c++)Fe(Ns[c],e);c=l;break;case"source":Fe("error",e),c=l;break;case"img":case"image":case"link":Fe("error",e),Fe("load",e),c=l;break;case"details":Fe("toggle",e),c=l;break;case"input":ne(e,l),c=U(e,l),Fe("invalid",e);break;case"option":c=l;break;case"select":e._wrapperState={wasMultiple:!!l.multiple},c=G({},l,{value:void 0}),Fe("invalid",e);break;case"textarea":We(e,l),c=fe(e,l),Fe("invalid",e);break;default:c=l}Bi(a,c),k=c;for(h in k)if(k.hasOwnProperty(h)){var S=k[h];h==="style"?cu(e,S):h==="dangerouslySetInnerHTML"?(S=S?S.__html:void 0,S!=null&&lu(e,S)):h==="children"?typeof S=="string"?(a!=="textarea"||S!=="")&&os(e,S):typeof S=="number"&&os(e,""+S):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(u.hasOwnProperty(h)?S!=null&&h==="onScroll"&&Fe("scroll",e):S!=null&&z(e,h,S,g))}switch(a){case"input":Te(e),gn(e,l,!1);break;case"textarea":Te(e),iu(e);break;case"option":l.value!=null&&e.setAttribute("value",""+te(l.value));break;case"select":e.multiple=!!l.multiple,h=l.value,h!=null?W(e,!!l.multiple,h,!1):l.defaultValue!=null&&W(e,!!l.multiple,l.defaultValue,!0);break;default:typeof c.onClick=="function"&&(e.onclick=Pa)}switch(a){case"button":case"input":case"select":case"textarea":l=!!l.autoFocus;break e;case"img":l=!0;break e;default:l=!1}}l&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return xt(t),null;case 6:if(e&&t.stateNode!=null)bd(e,t,e.memoizedProps,l);else{if(typeof l!="string"&&t.stateNode===null)throw Error(s(166));if(a=lr(Ps.current),lr(un.current),za(t)){if(l=t.stateNode,a=t.memoizedProps,l[ln]=t,(h=l.nodeValue!==a)&&(e=Pt,e!==null))switch(e.tag){case 3:Oa(l.nodeValue,a,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Oa(l.nodeValue,a,(e.mode&1)!==0)}h&&(t.flags|=4)}else l=(a.nodeType===9?a:a.ownerDocument).createTextNode(l),l[ln]=t,t.stateNode=l}return xt(t),null;case 13:if(ze(Ve),l=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(qe&&Dt!==null&&(t.mode&1)!==0&&(t.flags&128)===0)jc(),Lr(),t.flags|=98560,h=!1;else if(h=za(t),l!==null&&l.dehydrated!==null){if(e===null){if(!h)throw Error(s(318));if(h=t.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(s(317));h[ln]=t}else Lr(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;xt(t),h=!1}else Jt!==null&&(wl(Jt),Jt=null),h=!0;if(!h)return t.flags&65536?t:null}return(t.flags&128)!==0?(t.lanes=a,t):(l=l!==null,l!==(e!==null&&e.memoizedState!==null)&&l&&(t.child.flags|=8192,(t.mode&1)!==0&&(e===null||(Ve.current&1)!==0?at===0&&(at=3):kl())),t.updateQueue!==null&&(t.flags|=4),xt(t),null);case 4:return Fr(),ul(e,t),e===null&&Es(t.stateNode.containerInfo),xt(t),null;case 10:return $o(t.type._context),xt(t),null;case 17:return Et(t.type)&&La(),xt(t),null;case 19:if(ze(Ve),h=t.memoizedState,h===null)return xt(t),null;if(l=(t.flags&128)!==0,g=h.rendering,g===null)if(l)Us(h,!1);else{if(at!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(g=Ga(e),g!==null){for(t.flags|=128,Us(h,!1),l=g.updateQueue,l!==null&&(t.updateQueue=l,t.flags|=4),t.subtreeFlags=0,l=a,a=t.child;a!==null;)h=a,e=l,h.flags&=14680066,g=h.alternate,g===null?(h.childLanes=0,h.lanes=e,h.child=null,h.subtreeFlags=0,h.memoizedProps=null,h.memoizedState=null,h.updateQueue=null,h.dependencies=null,h.stateNode=null):(h.childLanes=g.childLanes,h.lanes=g.lanes,h.child=g.child,h.subtreeFlags=0,h.deletions=null,h.memoizedProps=g.memoizedProps,h.memoizedState=g.memoizedState,h.updateQueue=g.updateQueue,h.type=g.type,e=g.dependencies,h.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),a=a.sibling;return Me(Ve,Ve.current&1|2),t.child}e=e.sibling}h.tail!==null&&Je()>qr&&(t.flags|=128,l=!0,Us(h,!1),t.lanes=4194304)}else{if(!l)if(e=Ga(g),e!==null){if(t.flags|=128,l=!0,a=e.updateQueue,a!==null&&(t.updateQueue=a,t.flags|=4),Us(h,!0),h.tail===null&&h.tailMode==="hidden"&&!g.alternate&&!qe)return xt(t),null}else 2*Je()-h.renderingStartTime>qr&&a!==1073741824&&(t.flags|=128,l=!0,Us(h,!1),t.lanes=4194304);h.isBackwards?(g.sibling=t.child,t.child=g):(a=h.last,a!==null?a.sibling=g:t.child=g,h.last=g)}return h.tail!==null?(t=h.tail,h.rendering=t,h.tail=t.sibling,h.renderingStartTime=Je(),t.sibling=null,a=Ve.current,Me(Ve,l?a&1|2:a&1),t):(xt(t),null);case 22:case 23:return _l(),l=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==l&&(t.flags|=8192),l&&(t.mode&1)!==0?(Lt&1073741824)!==0&&(xt(t),t.subtreeFlags&6&&(t.flags|=8192)):xt(t),null;case 24:return null;case 25:return null}throw Error(s(156,t.tag))}function Fm(e,t){switch(Io(t),t.tag){case 1:return Et(t.type)&&La(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Fr(),ze(Nt),ze(yt),qo(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 5:return Bo(t),null;case 13:if(ze(Ve),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(s(340));Lr()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return ze(Ve),null;case 4:return Fr(),null;case 10:return $o(t.type._context),null;case 22:case 23:return _l(),null;case 24:return null;default:return null}}var ni=!1,wt=!1,zm=typeof WeakSet=="function"?WeakSet:Set,oe=null;function Br(e,t){var a=e.ref;if(a!==null)if(typeof a=="function")try{a(null)}catch(l){Ge(e,t,l)}else a.current=null}function cl(e,t,a){try{a()}catch(l){Ge(e,t,l)}}var _d=!1;function Bm(e,t){if(_o=_a,e=ec(),mo(e)){if("selectionStart"in e)var a={start:e.selectionStart,end:e.selectionEnd};else e:{a=(a=e.ownerDocument)&&a.defaultView||window;var l=a.getSelection&&a.getSelection();if(l&&l.rangeCount!==0){a=l.anchorNode;var c=l.anchorOffset,h=l.focusNode;l=l.focusOffset;try{a.nodeType,h.nodeType}catch{a=null;break e}var g=0,k=-1,S=-1,F=0,Q=0,X=e,J=null;t:for(;;){for(var se;X!==a||c!==0&&X.nodeType!==3||(k=g+c),X!==h||l!==0&&X.nodeType!==3||(S=g+l),X.nodeType===3&&(g+=X.nodeValue.length),(se=X.firstChild)!==null;)J=X,X=se;for(;;){if(X===e)break t;if(J===a&&++F===c&&(k=g),J===h&&++Q===l&&(S=g),(se=X.nextSibling)!==null)break;X=J,J=X.parentNode}X=se}a=k===-1||S===-1?null:{start:k,end:S}}else a=null}a=a||{start:0,end:0}}else a=null;for(ko={focusedElem:e,selectionRange:a},_a=!1,oe=t;oe!==null;)if(t=oe,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,oe=e;else for(;oe!==null;){t=oe;try{var le=t.alternate;if((t.flags&1024)!==0)switch(t.tag){case 0:case 11:case 15:break;case 1:if(le!==null){var ue=le.memoizedProps,Qe=le.memoizedState,R=t.stateNode,I=R.getSnapshotBeforeUpdate(t.elementType===t.type?ue:Qt(t.type,ue),Qe);R.__reactInternalSnapshotBeforeUpdate=I}break;case 3:var P=t.stateNode.containerInfo;P.nodeType===1?P.textContent="":P.nodeType===9&&P.documentElement&&P.removeChild(P.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(s(163))}}catch(ee){Ge(t,t.return,ee)}if(e=t.sibling,e!==null){e.return=t.return,oe=e;break}oe=t.return}return le=_d,_d=!1,le}function Fs(e,t,a){var l=t.updateQueue;if(l=l!==null?l.lastEffect:null,l!==null){var c=l=l.next;do{if((c.tag&e)===e){var h=c.destroy;c.destroy=void 0,h!==void 0&&cl(t,a,h)}c=c.next}while(c!==l)}}function ri(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var a=t=t.next;do{if((a.tag&e)===e){var l=a.create;a.destroy=l()}a=a.next}while(a!==t)}}function dl(e){var t=e.ref;if(t!==null){var a=e.stateNode;switch(e.tag){case 5:e=a;break;default:e=a}typeof t=="function"?t(e):t.current=e}}function kd(e){var t=e.alternate;t!==null&&(e.alternate=null,kd(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[ln],delete t[Ts],delete t[Eo],delete t[jm],delete t[Sm])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function jd(e){return e.tag===5||e.tag===3||e.tag===4}function Sd(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||jd(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function hl(e,t,a){var l=e.tag;if(l===5||l===6)e=e.stateNode,t?a.nodeType===8?a.parentNode.insertBefore(e,t):a.insertBefore(e,t):(a.nodeType===8?(t=a.parentNode,t.insertBefore(e,a)):(t=a,t.appendChild(e)),a=a._reactRootContainer,a!=null||t.onclick!==null||(t.onclick=Pa));else if(l!==4&&(e=e.child,e!==null))for(hl(e,t,a),e=e.sibling;e!==null;)hl(e,t,a),e=e.sibling}function fl(e,t,a){var l=e.tag;if(l===5||l===6)e=e.stateNode,t?a.insertBefore(e,t):a.appendChild(e);else if(l!==4&&(e=e.child,e!==null))for(fl(e,t,a),e=e.sibling;e!==null;)fl(e,t,a),e=e.sibling}var dt=null,Yt=!1;function Wn(e,t,a){for(a=a.child;a!==null;)Nd(e,t,a),a=a.sibling}function Nd(e,t,a){if(on&&typeof on.onCommitFiberUnmount=="function")try{on.onCommitFiberUnmount(ga,a)}catch{}switch(a.tag){case 5:wt||Br(a,t);case 6:var l=dt,c=Yt;dt=null,Wn(e,t,a),dt=l,Yt=c,dt!==null&&(Yt?(e=dt,a=a.stateNode,e.nodeType===8?e.parentNode.removeChild(a):e.removeChild(a)):dt.removeChild(a.stateNode));break;case 18:dt!==null&&(Yt?(e=dt,a=a.stateNode,e.nodeType===8?No(e.parentNode,a):e.nodeType===1&&No(e,a),vs(e)):No(dt,a.stateNode));break;case 4:l=dt,c=Yt,dt=a.stateNode.containerInfo,Yt=!0,Wn(e,t,a),dt=l,Yt=c;break;case 0:case 11:case 14:case 15:if(!wt&&(l=a.updateQueue,l!==null&&(l=l.lastEffect,l!==null))){c=l=l.next;do{var h=c,g=h.destroy;h=h.tag,g!==void 0&&((h&2)!==0||(h&4)!==0)&&cl(a,t,g),c=c.next}while(c!==l)}Wn(e,t,a);break;case 1:if(!wt&&(Br(a,t),l=a.stateNode,typeof l.componentWillUnmount=="function"))try{l.props=a.memoizedProps,l.state=a.memoizedState,l.componentWillUnmount()}catch(k){Ge(a,t,k)}Wn(e,t,a);break;case 21:Wn(e,t,a);break;case 22:a.mode&1?(wt=(l=wt)||a.memoizedState!==null,Wn(e,t,a),wt=l):Wn(e,t,a);break;default:Wn(e,t,a)}}function Ed(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var a=e.stateNode;a===null&&(a=e.stateNode=new zm),t.forEach(function(l){var c=Ym.bind(null,e,l);a.has(l)||(a.add(l),l.then(c,c))})}}function Xt(e,t){var a=t.deletions;if(a!==null)for(var l=0;l<a.length;l++){var c=a[l];try{var h=e,g=t,k=g;e:for(;k!==null;){switch(k.tag){case 5:dt=k.stateNode,Yt=!1;break e;case 3:dt=k.stateNode.containerInfo,Yt=!0;break e;case 4:dt=k.stateNode.containerInfo,Yt=!0;break e}k=k.return}if(dt===null)throw Error(s(160));Nd(h,g,c),dt=null,Yt=!1;var S=c.alternate;S!==null&&(S.return=null),c.return=null}catch(F){Ge(c,t,F)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Cd(t,e),t=t.sibling}function Cd(e,t){var a=e.alternate,l=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Xt(t,e),dn(e),l&4){try{Fs(3,e,e.return),ri(3,e)}catch(ue){Ge(e,e.return,ue)}try{Fs(5,e,e.return)}catch(ue){Ge(e,e.return,ue)}}break;case 1:Xt(t,e),dn(e),l&512&&a!==null&&Br(a,a.return);break;case 5:if(Xt(t,e),dn(e),l&512&&a!==null&&Br(a,a.return),e.flags&32){var c=e.stateNode;try{os(c,"")}catch(ue){Ge(e,e.return,ue)}}if(l&4&&(c=e.stateNode,c!=null)){var h=e.memoizedProps,g=a!==null?a.memoizedProps:h,k=e.type,S=e.updateQueue;if(e.updateQueue=null,S!==null)try{k==="input"&&h.type==="radio"&&h.name!=null&&ke(c,h),Wi(k,g);var F=Wi(k,h);for(g=0;g<S.length;g+=2){var Q=S[g],X=S[g+1];Q==="style"?cu(c,X):Q==="dangerouslySetInnerHTML"?lu(c,X):Q==="children"?os(c,X):z(c,Q,X,F)}switch(k){case"input":pn(c,h);break;case"textarea":da(c,h);break;case"select":var J=c._wrapperState.wasMultiple;c._wrapperState.wasMultiple=!!h.multiple;var se=h.value;se!=null?W(c,!!h.multiple,se,!1):J!==!!h.multiple&&(h.defaultValue!=null?W(c,!!h.multiple,h.defaultValue,!0):W(c,!!h.multiple,h.multiple?[]:"",!1))}c[Ts]=h}catch(ue){Ge(e,e.return,ue)}}break;case 6:if(Xt(t,e),dn(e),l&4){if(e.stateNode===null)throw Error(s(162));c=e.stateNode,h=e.memoizedProps;try{c.nodeValue=h}catch(ue){Ge(e,e.return,ue)}}break;case 3:if(Xt(t,e),dn(e),l&4&&a!==null&&a.memoizedState.isDehydrated)try{vs(t.containerInfo)}catch(ue){Ge(e,e.return,ue)}break;case 4:Xt(t,e),dn(e);break;case 13:Xt(t,e),dn(e),c=e.child,c.flags&8192&&(h=c.memoizedState!==null,c.stateNode.isHidden=h,!h||c.alternate!==null&&c.alternate.memoizedState!==null||(gl=Je())),l&4&&Ed(e);break;case 22:if(Q=a!==null&&a.memoizedState!==null,e.mode&1?(wt=(F=wt)||Q,Xt(t,e),wt=F):Xt(t,e),dn(e),l&8192){if(F=e.memoizedState!==null,(e.stateNode.isHidden=F)&&!Q&&(e.mode&1)!==0)for(oe=e,Q=e.child;Q!==null;){for(X=oe=Q;oe!==null;){switch(J=oe,se=J.child,J.tag){case 0:case 11:case 14:case 15:Fs(4,J,J.return);break;case 1:Br(J,J.return);var le=J.stateNode;if(typeof le.componentWillUnmount=="function"){l=J,a=J.return;try{t=l,le.props=t.memoizedProps,le.state=t.memoizedState,le.componentWillUnmount()}catch(ue){Ge(l,a,ue)}}break;case 5:Br(J,J.return);break;case 22:if(J.memoizedState!==null){Id(X);continue}}se!==null?(se.return=J,oe=se):Id(X)}Q=Q.sibling}e:for(Q=null,X=e;;){if(X.tag===5){if(Q===null){Q=X;try{c=X.stateNode,F?(h=c.style,typeof h.setProperty=="function"?h.setProperty("display","none","important"):h.display="none"):(k=X.stateNode,S=X.memoizedProps.style,g=S!=null&&S.hasOwnProperty("display")?S.display:null,k.style.display=uu("display",g))}catch(ue){Ge(e,e.return,ue)}}}else if(X.tag===6){if(Q===null)try{X.stateNode.nodeValue=F?"":X.memoizedProps}catch(ue){Ge(e,e.return,ue)}}else if((X.tag!==22&&X.tag!==23||X.memoizedState===null||X===e)&&X.child!==null){X.child.return=X,X=X.child;continue}if(X===e)break e;for(;X.sibling===null;){if(X.return===null||X.return===e)break e;Q===X&&(Q=null),X=X.return}Q===X&&(Q=null),X.sibling.return=X.return,X=X.sibling}}break;case 19:Xt(t,e),dn(e),l&4&&Ed(e);break;case 21:break;default:Xt(t,e),dn(e)}}function dn(e){var t=e.flags;if(t&2){try{e:{for(var a=e.return;a!==null;){if(jd(a)){var l=a;break e}a=a.return}throw Error(s(160))}switch(l.tag){case 5:var c=l.stateNode;l.flags&32&&(os(c,""),l.flags&=-33);var h=Sd(e);fl(e,h,c);break;case 3:case 4:var g=l.stateNode.containerInfo,k=Sd(e);hl(e,k,g);break;default:throw Error(s(161))}}catch(S){Ge(e,e.return,S)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Wm(e,t,a){oe=e,Td(e)}function Td(e,t,a){for(var l=(e.mode&1)!==0;oe!==null;){var c=oe,h=c.child;if(c.tag===22&&l){var g=c.memoizedState!==null||ni;if(!g){var k=c.alternate,S=k!==null&&k.memoizedState!==null||wt;k=ni;var F=wt;if(ni=g,(wt=S)&&!F)for(oe=c;oe!==null;)g=oe,S=g.child,g.tag===22&&g.memoizedState!==null?Rd(c):S!==null?(S.return=g,oe=S):Rd(c);for(;h!==null;)oe=h,Td(h),h=h.sibling;oe=c,ni=k,wt=F}Ad(e)}else(c.subtreeFlags&8772)!==0&&h!==null?(h.return=c,oe=h):Ad(e)}}function Ad(e){for(;oe!==null;){var t=oe;if((t.flags&8772)!==0){var a=t.alternate;try{if((t.flags&8772)!==0)switch(t.tag){case 0:case 11:case 15:wt||ri(5,t);break;case 1:var l=t.stateNode;if(t.flags&4&&!wt)if(a===null)l.componentDidMount();else{var c=t.elementType===t.type?a.memoizedProps:Qt(t.type,a.memoizedProps);l.componentDidUpdate(c,a.memoizedState,l.__reactInternalSnapshotBeforeUpdate)}var h=t.updateQueue;h!==null&&Ic(t,h,l);break;case 3:var g=t.updateQueue;if(g!==null){if(a=null,t.child!==null)switch(t.child.tag){case 5:a=t.child.stateNode;break;case 1:a=t.child.stateNode}Ic(t,g,a)}break;case 5:var k=t.stateNode;if(a===null&&t.flags&4){a=k;var S=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":S.autoFocus&&a.focus();break;case"img":S.src&&(a.src=S.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var F=t.alternate;if(F!==null){var Q=F.memoizedState;if(Q!==null){var X=Q.dehydrated;X!==null&&vs(X)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(s(163))}wt||t.flags&512&&dl(t)}catch(J){Ge(t,t.return,J)}}if(t===e){oe=null;break}if(a=t.sibling,a!==null){a.return=t.return,oe=a;break}oe=t.return}}function Id(e){for(;oe!==null;){var t=oe;if(t===e){oe=null;break}var a=t.sibling;if(a!==null){a.return=t.return,oe=a;break}oe=t.return}}function Rd(e){for(;oe!==null;){var t=oe;try{switch(t.tag){case 0:case 11:case 15:var a=t.return;try{ri(4,t)}catch(S){Ge(t,a,S)}break;case 1:var l=t.stateNode;if(typeof l.componentDidMount=="function"){var c=t.return;try{l.componentDidMount()}catch(S){Ge(t,c,S)}}var h=t.return;try{dl(t)}catch(S){Ge(t,h,S)}break;case 5:var g=t.return;try{dl(t)}catch(S){Ge(t,g,S)}}}catch(S){Ge(t,t.return,S)}if(t===e){oe=null;break}var k=t.sibling;if(k!==null){k.return=t.return,oe=k;break}oe=t.return}}var qm=Math.ceil,si=q.ReactCurrentDispatcher,ml=q.ReactCurrentOwner,Wt=q.ReactCurrentBatchConfig,Ae=0,ut=null,et=null,ht=0,Lt=0,Wr=Mn(0),at=0,zs=null,cr=0,ai=0,pl=0,Bs=null,Tt=null,gl=0,qr=1/0,jn=null,ii=!1,yl=null,qn=null,oi=!1,Vn=null,li=0,Ws=0,vl=null,ui=-1,ci=0;function _t(){return(Ae&6)!==0?Je():ui!==-1?ui:ui=Je()}function Hn(e){return(e.mode&1)===0?1:(Ae&2)!==0&&ht!==0?ht&-ht:Em.transition!==null?(ci===0&&(ci=Su()),ci):(e=De,e!==0||(e=window.event,e=e===void 0?16:Pu(e.type)),e)}function Zt(e,t,a,l){if(50<Ws)throw Ws=0,vl=null,Error(s(185));fs(e,a,l),((Ae&2)===0||e!==ut)&&(e===ut&&((Ae&2)===0&&(ai|=a),at===4&&Gn(e,ht)),At(e,l),a===1&&Ae===0&&(t.mode&1)===0&&(qr=Je()+500,Ma&&Fn()))}function At(e,t){var a=e.callbackNode;Ef(e,t);var l=xa(e,e===ut?ht:0);if(l===0)a!==null&&_u(a),e.callbackNode=null,e.callbackPriority=0;else if(t=l&-l,e.callbackPriority!==t){if(a!=null&&_u(a),t===1)e.tag===0?Nm(Pd.bind(null,e)):xc(Pd.bind(null,e)),_m(function(){(Ae&6)===0&&Fn()}),a=null;else{switch(Nu(l)){case 1:a=Qi;break;case 4:a=ku;break;case 16:a=pa;break;case 536870912:a=ju;break;default:a=pa}a=Bd(a,Od.bind(null,e))}e.callbackPriority=t,e.callbackNode=a}}function Od(e,t){if(ui=-1,ci=0,(Ae&6)!==0)throw Error(s(327));var a=e.callbackNode;if(Vr()&&e.callbackNode!==a)return null;var l=xa(e,e===ut?ht:0);if(l===0)return null;if((l&30)!==0||(l&e.expiredLanes)!==0||t)t=di(e,l);else{t=l;var c=Ae;Ae|=2;var h=Ld();(ut!==e||ht!==t)&&(jn=null,qr=Je()+500,hr(e,t));do try{Gm();break}catch(k){Dd(e,k)}while(!0);Lo(),si.current=h,Ae=c,et!==null?t=0:(ut=null,ht=0,t=at)}if(t!==0){if(t===2&&(c=Yi(e),c!==0&&(l=c,t=xl(e,c))),t===1)throw a=zs,hr(e,0),Gn(e,l),At(e,Je()),a;if(t===6)Gn(e,l);else{if(c=e.current.alternate,(l&30)===0&&!Vm(c)&&(t=di(e,l),t===2&&(h=Yi(e),h!==0&&(l=h,t=xl(e,h))),t===1))throw a=zs,hr(e,0),Gn(e,l),At(e,Je()),a;switch(e.finishedWork=c,e.finishedLanes=l,t){case 0:case 1:throw Error(s(345));case 2:fr(e,Tt,jn);break;case 3:if(Gn(e,l),(l&130023424)===l&&(t=gl+500-Je(),10<t)){if(xa(e,0)!==0)break;if(c=e.suspendedLanes,(c&l)!==l){_t(),e.pingedLanes|=e.suspendedLanes&c;break}e.timeoutHandle=So(fr.bind(null,e,Tt,jn),t);break}fr(e,Tt,jn);break;case 4:if(Gn(e,l),(l&4194240)===l)break;for(t=e.eventTimes,c=-1;0<l;){var g=31-Gt(l);h=1<<g,g=t[g],g>c&&(c=g),l&=~h}if(l=c,l=Je()-l,l=(120>l?120:480>l?480:1080>l?1080:1920>l?1920:3e3>l?3e3:4320>l?4320:1960*qm(l/1960))-l,10<l){e.timeoutHandle=So(fr.bind(null,e,Tt,jn),l);break}fr(e,Tt,jn);break;case 5:fr(e,Tt,jn);break;default:throw Error(s(329))}}}return At(e,Je()),e.callbackNode===a?Od.bind(null,e):null}function xl(e,t){var a=Bs;return e.current.memoizedState.isDehydrated&&(hr(e,t).flags|=256),e=di(e,t),e!==2&&(t=Tt,Tt=a,t!==null&&wl(t)),e}function wl(e){Tt===null?Tt=e:Tt.push.apply(Tt,e)}function Vm(e){for(var t=e;;){if(t.flags&16384){var a=t.updateQueue;if(a!==null&&(a=a.stores,a!==null))for(var l=0;l<a.length;l++){var c=a[l],h=c.getSnapshot;c=c.value;try{if(!Kt(h(),c))return!1}catch{return!1}}}if(a=t.child,t.subtreeFlags&16384&&a!==null)a.return=t,t=a;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Gn(e,t){for(t&=~pl,t&=~ai,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var a=31-Gt(t),l=1<<a;e[a]=-1,t&=~l}}function Pd(e){if((Ae&6)!==0)throw Error(s(327));Vr();var t=xa(e,0);if((t&1)===0)return At(e,Je()),null;var a=di(e,t);if(e.tag!==0&&a===2){var l=Yi(e);l!==0&&(t=l,a=xl(e,l))}if(a===1)throw a=zs,hr(e,0),Gn(e,t),At(e,Je()),a;if(a===6)throw Error(s(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,fr(e,Tt,jn),At(e,Je()),null}function bl(e,t){var a=Ae;Ae|=1;try{return e(t)}finally{Ae=a,Ae===0&&(qr=Je()+500,Ma&&Fn())}}function dr(e){Vn!==null&&Vn.tag===0&&(Ae&6)===0&&Vr();var t=Ae;Ae|=1;var a=Wt.transition,l=De;try{if(Wt.transition=null,De=1,e)return e()}finally{De=l,Wt.transition=a,Ae=t,(Ae&6)===0&&Fn()}}function _l(){Lt=Wr.current,ze(Wr)}function hr(e,t){e.finishedWork=null,e.finishedLanes=0;var a=e.timeoutHandle;if(a!==-1&&(e.timeoutHandle=-1,bm(a)),et!==null)for(a=et.return;a!==null;){var l=a;switch(Io(l),l.tag){case 1:l=l.type.childContextTypes,l!=null&&La();break;case 3:Fr(),ze(Nt),ze(yt),qo();break;case 5:Bo(l);break;case 4:Fr();break;case 13:ze(Ve);break;case 19:ze(Ve);break;case 10:$o(l.type._context);break;case 22:case 23:_l()}a=a.return}if(ut=e,et=e=Kn(e.current,null),ht=Lt=t,at=0,zs=null,pl=ai=cr=0,Tt=Bs=null,or!==null){for(t=0;t<or.length;t++)if(a=or[t],l=a.interleaved,l!==null){a.interleaved=null;var c=l.next,h=a.pending;if(h!==null){var g=h.next;h.next=c,l.next=g}a.pending=l}or=null}return e}function Dd(e,t){do{var a=et;try{if(Lo(),Ka.current=Xa,Ja){for(var l=He.memoizedState;l!==null;){var c=l.queue;c!==null&&(c.pending=null),l=l.next}Ja=!1}if(ur=0,lt=st=He=null,Ds=!1,Ls=0,ml.current=null,a===null||a.return===null){at=1,zs=t,et=null;break}e:{var h=e,g=a.return,k=a,S=t;if(t=ht,k.flags|=32768,S!==null&&typeof S=="object"&&typeof S.then=="function"){var F=S,Q=k,X=Q.tag;if((Q.mode&1)===0&&(X===0||X===11||X===15)){var J=Q.alternate;J?(Q.updateQueue=J.updateQueue,Q.memoizedState=J.memoizedState,Q.lanes=J.lanes):(Q.updateQueue=null,Q.memoizedState=null)}var se=id(g);if(se!==null){se.flags&=-257,od(se,g,k,h,t),se.mode&1&&ad(h,F,t),t=se,S=F;var le=t.updateQueue;if(le===null){var ue=new Set;ue.add(S),t.updateQueue=ue}else le.add(S);break e}else{if((t&1)===0){ad(h,F,t),kl();break e}S=Error(s(426))}}else if(qe&&k.mode&1){var Qe=id(g);if(Qe!==null){(Qe.flags&65536)===0&&(Qe.flags|=256),od(Qe,g,k,h,t),Po(zr(S,k));break e}}h=S=zr(S,k),at!==4&&(at=2),Bs===null?Bs=[h]:Bs.push(h),h=g;do{switch(h.tag){case 3:h.flags|=65536,t&=-t,h.lanes|=t;var R=rd(h,S,t);Ac(h,R);break e;case 1:k=S;var I=h.type,P=h.stateNode;if((h.flags&128)===0&&(typeof I.getDerivedStateFromError=="function"||P!==null&&typeof P.componentDidCatch=="function"&&(qn===null||!qn.has(P)))){h.flags|=65536,t&=-t,h.lanes|=t;var ee=sd(h,k,t);Ac(h,ee);break e}}h=h.return}while(h!==null)}Md(a)}catch(ce){t=ce,et===a&&a!==null&&(et=a=a.return);continue}break}while(!0)}function Ld(){var e=si.current;return si.current=Xa,e===null?Xa:e}function kl(){(at===0||at===3||at===2)&&(at=4),ut===null||(cr&268435455)===0&&(ai&268435455)===0||Gn(ut,ht)}function di(e,t){var a=Ae;Ae|=2;var l=Ld();(ut!==e||ht!==t)&&(jn=null,hr(e,t));do try{Hm();break}catch(c){Dd(e,c)}while(!0);if(Lo(),Ae=a,si.current=l,et!==null)throw Error(s(261));return ut=null,ht=0,at}function Hm(){for(;et!==null;)$d(et)}function Gm(){for(;et!==null&&!vf();)$d(et)}function $d(e){var t=zd(e.alternate,e,Lt);e.memoizedProps=e.pendingProps,t===null?Md(e):et=t,ml.current=null}function Md(e){var t=e;do{var a=t.alternate;if(e=t.return,(t.flags&32768)===0){if(a=Um(a,t,Lt),a!==null){et=a;return}}else{if(a=Fm(a,t),a!==null){a.flags&=32767,et=a;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{at=6,et=null;return}}if(t=t.sibling,t!==null){et=t;return}et=t=e}while(t!==null);at===0&&(at=5)}function fr(e,t,a){var l=De,c=Wt.transition;try{Wt.transition=null,De=1,Km(e,t,a,l)}finally{Wt.transition=c,De=l}return null}function Km(e,t,a,l){do Vr();while(Vn!==null);if((Ae&6)!==0)throw Error(s(327));a=e.finishedWork;var c=e.finishedLanes;if(a===null)return null;if(e.finishedWork=null,e.finishedLanes=0,a===e.current)throw Error(s(177));e.callbackNode=null,e.callbackPriority=0;var h=a.lanes|a.childLanes;if(Cf(e,h),e===ut&&(et=ut=null,ht=0),(a.subtreeFlags&2064)===0&&(a.flags&2064)===0||oi||(oi=!0,Bd(pa,function(){return Vr(),null})),h=(a.flags&15990)!==0,(a.subtreeFlags&15990)!==0||h){h=Wt.transition,Wt.transition=null;var g=De;De=1;var k=Ae;Ae|=4,ml.current=null,Bm(e,a),Cd(a,e),mm(ko),_a=!!_o,ko=_o=null,e.current=a,Wm(a),xf(),Ae=k,De=g,Wt.transition=h}else e.current=a;if(oi&&(oi=!1,Vn=e,li=c),h=e.pendingLanes,h===0&&(qn=null),_f(a.stateNode),At(e,Je()),t!==null)for(l=e.onRecoverableError,a=0;a<t.length;a++)c=t[a],l(c.value,{componentStack:c.stack,digest:c.digest});if(ii)throw ii=!1,e=yl,yl=null,e;return(li&1)!==0&&e.tag!==0&&Vr(),h=e.pendingLanes,(h&1)!==0?e===vl?Ws++:(Ws=0,vl=e):Ws=0,Fn(),null}function Vr(){if(Vn!==null){var e=Nu(li),t=Wt.transition,a=De;try{if(Wt.transition=null,De=16>e?16:e,Vn===null)var l=!1;else{if(e=Vn,Vn=null,li=0,(Ae&6)!==0)throw Error(s(331));var c=Ae;for(Ae|=4,oe=e.current;oe!==null;){var h=oe,g=h.child;if((oe.flags&16)!==0){var k=h.deletions;if(k!==null){for(var S=0;S<k.length;S++){var F=k[S];for(oe=F;oe!==null;){var Q=oe;switch(Q.tag){case 0:case 11:case 15:Fs(8,Q,h)}var X=Q.child;if(X!==null)X.return=Q,oe=X;else for(;oe!==null;){Q=oe;var J=Q.sibling,se=Q.return;if(kd(Q),Q===F){oe=null;break}if(J!==null){J.return=se,oe=J;break}oe=se}}}var le=h.alternate;if(le!==null){var ue=le.child;if(ue!==null){le.child=null;do{var Qe=ue.sibling;ue.sibling=null,ue=Qe}while(ue!==null)}}oe=h}}if((h.subtreeFlags&2064)!==0&&g!==null)g.return=h,oe=g;else e:for(;oe!==null;){if(h=oe,(h.flags&2048)!==0)switch(h.tag){case 0:case 11:case 15:Fs(9,h,h.return)}var R=h.sibling;if(R!==null){R.return=h.return,oe=R;break e}oe=h.return}}var I=e.current;for(oe=I;oe!==null;){g=oe;var P=g.child;if((g.subtreeFlags&2064)!==0&&P!==null)P.return=g,oe=P;else e:for(g=I;oe!==null;){if(k=oe,(k.flags&2048)!==0)try{switch(k.tag){case 0:case 11:case 15:ri(9,k)}}catch(ce){Ge(k,k.return,ce)}if(k===g){oe=null;break e}var ee=k.sibling;if(ee!==null){ee.return=k.return,oe=ee;break e}oe=k.return}}if(Ae=c,Fn(),on&&typeof on.onPostCommitFiberRoot=="function")try{on.onPostCommitFiberRoot(ga,e)}catch{}l=!0}return l}finally{De=a,Wt.transition=t}}return!1}function Ud(e,t,a){t=zr(a,t),t=rd(e,t,1),e=Bn(e,t,1),t=_t(),e!==null&&(fs(e,1,t),At(e,t))}function Ge(e,t,a){if(e.tag===3)Ud(e,e,a);else for(;t!==null;){if(t.tag===3){Ud(t,e,a);break}else if(t.tag===1){var l=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof l.componentDidCatch=="function"&&(qn===null||!qn.has(l))){e=zr(a,e),e=sd(t,e,1),t=Bn(t,e,1),e=_t(),t!==null&&(fs(t,1,e),At(t,e));break}}t=t.return}}function Jm(e,t,a){var l=e.pingCache;l!==null&&l.delete(t),t=_t(),e.pingedLanes|=e.suspendedLanes&a,ut===e&&(ht&a)===a&&(at===4||at===3&&(ht&130023424)===ht&&500>Je()-gl?hr(e,0):pl|=a),At(e,t)}function Fd(e,t){t===0&&((e.mode&1)===0?t=1:(t=va,va<<=1,(va&130023424)===0&&(va=4194304)));var a=_t();e=bn(e,t),e!==null&&(fs(e,t,a),At(e,a))}function Qm(e){var t=e.memoizedState,a=0;t!==null&&(a=t.retryLane),Fd(e,a)}function Ym(e,t){var a=0;switch(e.tag){case 13:var l=e.stateNode,c=e.memoizedState;c!==null&&(a=c.retryLane);break;case 19:l=e.stateNode;break;default:throw Error(s(314))}l!==null&&l.delete(t),Fd(e,a)}var zd;zd=function(e,t,a){if(e!==null)if(e.memoizedProps!==t.pendingProps||Nt.current)Ct=!0;else{if((e.lanes&a)===0&&(t.flags&128)===0)return Ct=!1,Mm(e,t,a);Ct=(e.flags&131072)!==0}else Ct=!1,qe&&(t.flags&1048576)!==0&&wc(t,Fa,t.index);switch(t.lanes=0,t.tag){case 2:var l=t.type;ti(e,t),e=t.pendingProps;var c=Or(t,yt.current);Ur(t,a),c=Go(null,t,l,e,c,a);var h=Ko();return t.flags|=1,typeof c=="object"&&c!==null&&typeof c.render=="function"&&c.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Et(l)?(h=!0,$a(t)):h=!1,t.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,Fo(t),c.updater=Za,t.stateNode=c,c._reactInternals=t,el(t,l,e,a),t=sl(null,t,l,!0,h,a)):(t.tag=0,qe&&h&&Ao(t),bt(null,t,c,a),t=t.child),t;case 16:l=t.elementType;e:{switch(ti(e,t),e=t.pendingProps,c=l._init,l=c(l._payload),t.type=l,c=t.tag=Zm(l),e=Qt(l,e),c){case 0:t=rl(null,t,l,e,a);break e;case 1:t=fd(null,t,l,e,a);break e;case 11:t=ld(null,t,l,e,a);break e;case 14:t=ud(null,t,l,Qt(l.type,e),a);break e}throw Error(s(306,l,""))}return t;case 0:return l=t.type,c=t.pendingProps,c=t.elementType===l?c:Qt(l,c),rl(e,t,l,c,a);case 1:return l=t.type,c=t.pendingProps,c=t.elementType===l?c:Qt(l,c),fd(e,t,l,c,a);case 3:e:{if(md(t),e===null)throw Error(s(387));l=t.pendingProps,h=t.memoizedState,c=h.element,Tc(e,t),Ha(t,l,null,a);var g=t.memoizedState;if(l=g.element,h.isDehydrated)if(h={element:l,isDehydrated:!1,cache:g.cache,pendingSuspenseBoundaries:g.pendingSuspenseBoundaries,transitions:g.transitions},t.updateQueue.baseState=h,t.memoizedState=h,t.flags&256){c=zr(Error(s(423)),t),t=pd(e,t,l,a,c);break e}else if(l!==c){c=zr(Error(s(424)),t),t=pd(e,t,l,a,c);break e}else for(Dt=$n(t.stateNode.containerInfo.firstChild),Pt=t,qe=!0,Jt=null,a=Ec(t,null,l,a),t.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling;else{if(Lr(),l===c){t=kn(e,t,a);break e}bt(e,t,l,a)}t=t.child}return t;case 5:return Rc(t),e===null&&Oo(t),l=t.type,c=t.pendingProps,h=e!==null?e.memoizedProps:null,g=c.children,jo(l,c)?g=null:h!==null&&jo(l,h)&&(t.flags|=32),hd(e,t),bt(e,t,g,a),t.child;case 6:return e===null&&Oo(t),null;case 13:return gd(e,t,a);case 4:return zo(t,t.stateNode.containerInfo),l=t.pendingProps,e===null?t.child=$r(t,null,l,a):bt(e,t,l,a),t.child;case 11:return l=t.type,c=t.pendingProps,c=t.elementType===l?c:Qt(l,c),ld(e,t,l,c,a);case 7:return bt(e,t,t.pendingProps,a),t.child;case 8:return bt(e,t,t.pendingProps.children,a),t.child;case 12:return bt(e,t,t.pendingProps.children,a),t.child;case 10:e:{if(l=t.type._context,c=t.pendingProps,h=t.memoizedProps,g=c.value,Me(Wa,l._currentValue),l._currentValue=g,h!==null)if(Kt(h.value,g)){if(h.children===c.children&&!Nt.current){t=kn(e,t,a);break e}}else for(h=t.child,h!==null&&(h.return=t);h!==null;){var k=h.dependencies;if(k!==null){g=h.child;for(var S=k.firstContext;S!==null;){if(S.context===l){if(h.tag===1){S=_n(-1,a&-a),S.tag=2;var F=h.updateQueue;if(F!==null){F=F.shared;var Q=F.pending;Q===null?S.next=S:(S.next=Q.next,Q.next=S),F.pending=S}}h.lanes|=a,S=h.alternate,S!==null&&(S.lanes|=a),Mo(h.return,a,t),k.lanes|=a;break}S=S.next}}else if(h.tag===10)g=h.type===t.type?null:h.child;else if(h.tag===18){if(g=h.return,g===null)throw Error(s(341));g.lanes|=a,k=g.alternate,k!==null&&(k.lanes|=a),Mo(g,a,t),g=h.sibling}else g=h.child;if(g!==null)g.return=h;else for(g=h;g!==null;){if(g===t){g=null;break}if(h=g.sibling,h!==null){h.return=g.return,g=h;break}g=g.return}h=g}bt(e,t,c.children,a),t=t.child}return t;case 9:return c=t.type,l=t.pendingProps.children,Ur(t,a),c=zt(c),l=l(c),t.flags|=1,bt(e,t,l,a),t.child;case 14:return l=t.type,c=Qt(l,t.pendingProps),c=Qt(l.type,c),ud(e,t,l,c,a);case 15:return cd(e,t,t.type,t.pendingProps,a);case 17:return l=t.type,c=t.pendingProps,c=t.elementType===l?c:Qt(l,c),ti(e,t),t.tag=1,Et(l)?(e=!0,$a(t)):e=!1,Ur(t,a),td(t,l,c),el(t,l,c,a),sl(null,t,l,!0,e,a);case 19:return vd(e,t,a);case 22:return dd(e,t,a)}throw Error(s(156,t.tag))};function Bd(e,t){return bu(e,t)}function Xm(e,t,a,l){this.tag=e,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=l,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function qt(e,t,a,l){return new Xm(e,t,a,l)}function jl(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Zm(e){if(typeof e=="function")return jl(e)?1:0;if(e!=null){if(e=e.$$typeof,e===_e)return 11;if(e===Re)return 14}return 2}function Kn(e,t){var a=e.alternate;return a===null?(a=qt(e.tag,t,e.key,e.mode),a.elementType=e.elementType,a.type=e.type,a.stateNode=e.stateNode,a.alternate=e,e.alternate=a):(a.pendingProps=t,a.type=e.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=e.flags&14680064,a.childLanes=e.childLanes,a.lanes=e.lanes,a.child=e.child,a.memoizedProps=e.memoizedProps,a.memoizedState=e.memoizedState,a.updateQueue=e.updateQueue,t=e.dependencies,a.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},a.sibling=e.sibling,a.index=e.index,a.ref=e.ref,a}function hi(e,t,a,l,c,h){var g=2;if(l=e,typeof e=="function")jl(e)&&(g=1);else if(typeof e=="string")g=5;else e:switch(e){case Y:return mr(a.children,c,h,t);case re:g=8,c|=8;break;case K:return e=qt(12,a,t,c|2),e.elementType=K,e.lanes=h,e;case Ce:return e=qt(13,a,t,c),e.elementType=Ce,e.lanes=h,e;case Ie:return e=qt(19,a,t,c),e.elementType=Ie,e.lanes=h,e;case he:return fi(a,c,h,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case ve:g=10;break e;case xe:g=9;break e;case _e:g=11;break e;case Re:g=14;break e;case ie:g=16,l=null;break e}throw Error(s(130,e==null?e:typeof e,""))}return t=qt(g,a,t,c),t.elementType=e,t.type=l,t.lanes=h,t}function mr(e,t,a,l){return e=qt(7,e,l,t),e.lanes=a,e}function fi(e,t,a,l){return e=qt(22,e,l,t),e.elementType=he,e.lanes=a,e.stateNode={isHidden:!1},e}function Sl(e,t,a){return e=qt(6,e,null,t),e.lanes=a,e}function Nl(e,t,a){return t=qt(4,e.children!==null?e.children:[],e.key,t),t.lanes=a,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function ep(e,t,a,l,c){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Xi(0),this.expirationTimes=Xi(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Xi(0),this.identifierPrefix=l,this.onRecoverableError=c,this.mutableSourceEagerHydrationData=null}function El(e,t,a,l,c,h,g,k,S){return e=new ep(e,t,a,k,S),t===1?(t=1,h===!0&&(t|=8)):t=0,h=qt(3,null,null,t),e.current=h,h.stateNode=e,h.memoizedState={element:l,isDehydrated:a,cache:null,transitions:null,pendingSuspenseBoundaries:null},Fo(h),e}function tp(e,t,a){var l=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:M,key:l==null?null:""+l,children:e,containerInfo:t,implementation:a}}function Wd(e){if(!e)return Un;e=e._reactInternals;e:{if(nr(e)!==e||e.tag!==1)throw Error(s(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Et(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(s(171))}if(e.tag===1){var a=e.type;if(Et(a))return yc(e,a,t)}return t}function qd(e,t,a,l,c,h,g,k,S){return e=El(a,l,!0,e,c,h,g,k,S),e.context=Wd(null),a=e.current,l=_t(),c=Hn(a),h=_n(l,c),h.callback=t??null,Bn(a,h,c),e.current.lanes=c,fs(e,c,l),At(e,l),e}function mi(e,t,a,l){var c=t.current,h=_t(),g=Hn(c);return a=Wd(a),t.context===null?t.context=a:t.pendingContext=a,t=_n(h,g),t.payload={element:e},l=l===void 0?null:l,l!==null&&(t.callback=l),e=Bn(c,t,g),e!==null&&(Zt(e,c,g,h),Va(e,c,g)),g}function pi(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Vd(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var a=e.retryLane;e.retryLane=a!==0&&a<t?a:t}}function Cl(e,t){Vd(e,t),(e=e.alternate)&&Vd(e,t)}function np(){return null}var Hd=typeof reportError=="function"?reportError:function(e){console.error(e)};function Tl(e){this._internalRoot=e}gi.prototype.render=Tl.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(s(409));mi(e,t,null,null)},gi.prototype.unmount=Tl.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;dr(function(){mi(null,e,null,null)}),t[yn]=null}};function gi(e){this._internalRoot=e}gi.prototype.unstable_scheduleHydration=function(e){if(e){var t=Tu();e={blockedOn:null,target:e,priority:t};for(var a=0;a<Pn.length&&t!==0&&t<Pn[a].priority;a++);Pn.splice(a,0,e),a===0&&Ru(e)}};function Al(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function yi(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Gd(){}function rp(e,t,a,l,c){if(c){if(typeof l=="function"){var h=l;l=function(){var F=pi(g);h.call(F)}}var g=qd(t,l,e,0,null,!1,!1,"",Gd);return e._reactRootContainer=g,e[yn]=g.current,Es(e.nodeType===8?e.parentNode:e),dr(),g}for(;c=e.lastChild;)e.removeChild(c);if(typeof l=="function"){var k=l;l=function(){var F=pi(S);k.call(F)}}var S=El(e,0,!1,null,null,!1,!1,"",Gd);return e._reactRootContainer=S,e[yn]=S.current,Es(e.nodeType===8?e.parentNode:e),dr(function(){mi(t,S,a,l)}),S}function vi(e,t,a,l,c){var h=a._reactRootContainer;if(h){var g=h;if(typeof c=="function"){var k=c;c=function(){var S=pi(g);k.call(S)}}mi(t,g,e,c)}else g=rp(a,t,e,c,l);return pi(g)}Eu=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var a=hs(t.pendingLanes);a!==0&&(Zi(t,a|1),At(t,Je()),(Ae&6)===0&&(qr=Je()+500,Fn()))}break;case 13:dr(function(){var l=bn(e,1);if(l!==null){var c=_t();Zt(l,e,1,c)}}),Cl(e,1)}},eo=function(e){if(e.tag===13){var t=bn(e,134217728);if(t!==null){var a=_t();Zt(t,e,134217728,a)}Cl(e,134217728)}},Cu=function(e){if(e.tag===13){var t=Hn(e),a=bn(e,t);if(a!==null){var l=_t();Zt(a,e,t,l)}Cl(e,t)}},Tu=function(){return De},Au=function(e,t){var a=De;try{return De=e,t()}finally{De=a}},Hi=function(e,t,a){switch(t){case"input":if(pn(e,a),t=a.name,a.type==="radio"&&t!=null){for(a=e;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<a.length;t++){var l=a[t];if(l!==e&&l.form===e.form){var c=Da(l);if(!c)throw Error(s(90));Pe(l),pn(l,c)}}}break;case"textarea":da(e,a);break;case"select":t=a.value,t!=null&&W(e,!!a.multiple,t,!1)}},mu=bl,pu=dr;var sp={usingClientEntryPoint:!1,Events:[As,Ir,Da,hu,fu,bl]},qs={findFiberByHostInstance:rr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ap={bundleType:qs.bundleType,version:qs.version,rendererPackageName:qs.rendererPackageName,rendererConfig:qs.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:q.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=xu(e),e===null?null:e.stateNode},findFiberByHostInstance:qs.findFiberByHostInstance||np,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var xi=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!xi.isDisabled&&xi.supportsFiber)try{ga=xi.inject(ap),on=xi}catch{}}return It.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sp,It.createPortal=function(e,t){var a=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Al(t))throw Error(s(200));return tp(e,t,null,a)},It.createRoot=function(e,t){if(!Al(e))throw Error(s(299));var a=!1,l="",c=Hd;return t!=null&&(t.unstable_strictMode===!0&&(a=!0),t.identifierPrefix!==void 0&&(l=t.identifierPrefix),t.onRecoverableError!==void 0&&(c=t.onRecoverableError)),t=El(e,1,!1,null,null,a,!1,l,c),e[yn]=t.current,Es(e.nodeType===8?e.parentNode:e),new Tl(t)},It.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(s(188)):(e=Object.keys(e).join(","),Error(s(268,e)));return e=xu(t),e=e===null?null:e.stateNode,e},It.flushSync=function(e){return dr(e)},It.hydrate=function(e,t,a){if(!yi(t))throw Error(s(200));return vi(null,e,t,!0,a)},It.hydrateRoot=function(e,t,a){if(!Al(e))throw Error(s(405));var l=a!=null&&a.hydratedSources||null,c=!1,h="",g=Hd;if(a!=null&&(a.unstable_strictMode===!0&&(c=!0),a.identifierPrefix!==void 0&&(h=a.identifierPrefix),a.onRecoverableError!==void 0&&(g=a.onRecoverableError)),t=qd(t,null,e,1,a??null,c,!1,h,g),e[yn]=t.current,Es(e),l)for(e=0;e<l.length;e++)a=l[e],c=a._getVersion,c=c(a._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[a,c]:t.mutableSourceEagerHydrationData.push(a,c);return new gi(t)},It.render=function(e,t,a){if(!yi(t))throw Error(s(200));return vi(null,e,t,!1,a)},It.unmountComponentAtNode=function(e){if(!yi(e))throw Error(s(40));return e._reactRootContainer?(dr(function(){vi(null,null,e,!1,function(){e._reactRootContainer=null,e[yn]=null})}),!0):!1},It.unstable_batchedUpdates=bl,It.unstable_renderSubtreeIntoContainer=function(e,t,a,l){if(!yi(a))throw Error(s(200));if(e==null||e._reactInternals===void 0)throw Error(s(38));return vi(e,t,a,!1,l)},It.version="18.3.1-next-f1338f8080-20240426",It}var nh;function pp(){if(nh)return Ol.exports;nh=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(n){console.error(n)}}return r(),Ol.exports=mp(),Ol.exports}var rh;function gp(){if(rh)return wi;rh=1;var r=pp();return wi.createRoot=r.createRoot,wi.hydrateRoot=r.hydrateRoot,wi}var yp=gp();function Pi(r,n){var s={};for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&n.indexOf(o)<0&&(s[o]=r[o]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var u=0,o=Object.getOwnPropertySymbols(r);u<o.length;u++)n.indexOf(o[u])<0&&Object.prototype.propertyIsEnumerable.call(r,o[u])&&(s[o[u]]=r[o[u]]);return s}function vp(r,n,s,o){function u(d){return d instanceof s?d:new s(function(f){f(d)})}return new(s||(s=Promise))(function(d,f){function m(v){try{y(o.next(v))}catch(b){f(b)}}function p(v){try{y(o.throw(v))}catch(b){f(b)}}function y(v){v.done?d(v.value):u(v.value).then(m,p)}y((o=o.apply(r,n||[])).next())})}const xp=r=>r?(...n)=>r(...n):(...n)=>fetch(...n);class nu extends Error{constructor(n,s="FunctionsError",o){super(n),this.name=s,this.context=o}}class wp extends nu{constructor(n){super("Failed to send a request to the Edge Function","FunctionsFetchError",n)}}class sh extends nu{constructor(n){super("Relay Error invoking the Edge Function","FunctionsRelayError",n)}}class ah extends nu{constructor(n){super("Edge Function returned a non-2xx status code","FunctionsHttpError",n)}}var Vl;(function(r){r.Any="any",r.ApNortheast1="ap-northeast-1",r.ApNortheast2="ap-northeast-2",r.ApSouth1="ap-south-1",r.ApSoutheast1="ap-southeast-1",r.ApSoutheast2="ap-southeast-2",r.CaCentral1="ca-central-1",r.EuCentral1="eu-central-1",r.EuWest1="eu-west-1",r.EuWest2="eu-west-2",r.EuWest3="eu-west-3",r.SaEast1="sa-east-1",r.UsEast1="us-east-1",r.UsWest1="us-west-1",r.UsWest2="us-west-2"})(Vl||(Vl={}));class bp{constructor(n,{headers:s={},customFetch:o,region:u=Vl.Any}={}){this.url=n,this.headers=s,this.region=u,this.fetch=xp(o)}setAuth(n){this.headers.Authorization=`Bearer ${n}`}invoke(n){return vp(this,arguments,void 0,function*(s,o={}){var u;let d,f;try{const{headers:m,method:p,body:y,signal:v,timeout:b}=o;let _={},{region:w}=o;w||(w=this.region);const T=new URL(`${this.url}/${s}`);w&&w!=="any"&&(_["x-region"]=w,T.searchParams.set("forceFunctionRegion",w));let j;y&&(m&&!Object.prototype.hasOwnProperty.call(m,"Content-Type")||!m)?typeof Blob<"u"&&y instanceof Blob||y instanceof ArrayBuffer?(_["Content-Type"]="application/octet-stream",j=y):typeof y=="string"?(_["Content-Type"]="text/plain",j=y):typeof FormData<"u"&&y instanceof FormData?j=y:(_["Content-Type"]="application/json",j=JSON.stringify(y)):y&&typeof y!="string"&&!(typeof Blob<"u"&&y instanceof Blob)&&!(y instanceof ArrayBuffer)&&!(typeof FormData<"u"&&y instanceof FormData)?j=JSON.stringify(y):j=y;let E=v;b&&(f=new AbortController,d=setTimeout(()=>f.abort(),b),v?(E=f.signal,v.addEventListener("abort",()=>f.abort())):E=f.signal);const D=yield this.fetch(T.toString(),{method:p||"POST",headers:Object.assign(Object.assign(Object.assign({},_),this.headers),m),body:j,signal:E}).catch($=>{throw new wp($)}),V=D.headers.get("x-relay-error");if(V&&V==="true")throw new sh(D);if(!D.ok)throw new ah(D);let z=((u=D.headers.get("Content-Type"))!==null&&u!==void 0?u:"text/plain").split(";")[0].trim(),q;return z==="application/json"?q=yield D.json():z==="application/octet-stream"||z==="application/pdf"?q=yield D.blob():z==="text/event-stream"?q=D:z==="multipart/form-data"?q=yield D.formData():q=yield D.text(),{data:q,error:null,response:D}}catch(m){return{data:null,error:m,response:m instanceof ah||m instanceof sh?m.context:void 0}}finally{d&&clearTimeout(d)}})}}var _p=class extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}},kp=class{constructor(r){var n,s,o;this.shouldThrowOnError=!1,this.method=r.method,this.url=r.url,this.headers=new Headers(r.headers),this.schema=r.schema,this.body=r.body,this.shouldThrowOnError=(n=r.shouldThrowOnError)!==null&&n!==void 0?n:!1,this.signal=r.signal,this.isMaybeSingle=(s=r.isMaybeSingle)!==null&&s!==void 0?s:!1,this.urlLengthLimit=(o=r.urlLengthLimit)!==null&&o!==void 0?o:8e3,r.fetch?this.fetch=r.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(r,n){return this.headers=new Headers(this.headers),this.headers.set(r,n),this}then(r,n){var s=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const o=this.fetch;let u=o(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async d=>{let f=null,m=null,p=null,y=d.status,v=d.statusText;if(d.ok){var b,_;if(s.method!=="HEAD"){var w;const D=await d.text();D===""||(s.headers.get("Accept")==="text/csv"||s.headers.get("Accept")&&(!((w=s.headers.get("Accept"))===null||w===void 0)&&w.includes("application/vnd.pgrst.plan+text"))?m=D:m=JSON.parse(D))}const j=(b=s.headers.get("Prefer"))===null||b===void 0?void 0:b.match(/count=(exact|planned|estimated)/),E=(_=d.headers.get("content-range"))===null||_===void 0?void 0:_.split("/");j&&E&&E.length>1&&(p=parseInt(E[1])),s.isMaybeSingle&&s.method==="GET"&&Array.isArray(m)&&(m.length>1?(f={code:"PGRST116",details:`Results contain ${m.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},m=null,p=null,y=406,v="Not Acceptable"):m.length===1?m=m[0]:m=null)}else{var T;const j=await d.text();try{f=JSON.parse(j),Array.isArray(f)&&d.status===404&&(m=[],f=null,y=200,v="OK")}catch{d.status===404&&j===""?(y=204,v="No Content"):f={message:j}}if(f&&s.isMaybeSingle&&(!(f==null||(T=f.details)===null||T===void 0)&&T.includes("0 rows"))&&(f=null,y=200,v="OK"),f&&s.shouldThrowOnError)throw new _p(f)}return{error:f,data:m,count:p,status:y,statusText:v}});return this.shouldThrowOnError||(u=u.catch(d=>{var f;let m="",p="",y="";const v=d==null?void 0:d.cause;if(v){var b,_,w,T;const D=(b=v==null?void 0:v.message)!==null&&b!==void 0?b:"",V=(_=v==null?void 0:v.code)!==null&&_!==void 0?_:"";m=`${(w=d==null?void 0:d.name)!==null&&w!==void 0?w:"FetchError"}: ${d==null?void 0:d.message}`,m+=`

Caused by: ${(T=v==null?void 0:v.name)!==null&&T!==void 0?T:"Error"}: ${D}`,V&&(m+=` (${V})`),v!=null&&v.stack&&(m+=`
${v.stack}`)}else{var j;m=(j=d==null?void 0:d.stack)!==null&&j!==void 0?j:""}const E=this.url.toString().length;return(d==null?void 0:d.name)==="AbortError"||(d==null?void 0:d.code)==="ABORT_ERR"?(y="",p="Request was aborted (timeout or manual cancellation)",E>this.urlLengthLimit&&(p+=`. Note: Your request URL is ${E} characters, which may exceed server limits. If selecting many fields, consider using views. If filtering with large arrays (e.g., .in('id', [many IDs])), consider using an RPC function to pass values server-side.`)):((v==null?void 0:v.name)==="HeadersOverflowError"||(v==null?void 0:v.code)==="UND_ERR_HEADERS_OVERFLOW")&&(y="",p="HTTP headers exceeded server limits (typically 16KB)",E>this.urlLengthLimit&&(p+=`. Your request URL is ${E} characters. If selecting many fields, consider using views. If filtering with large arrays (e.g., .in('id', [200+ IDs])), consider using an RPC function instead.`)),{error:{message:`${(f=d==null?void 0:d.name)!==null&&f!==void 0?f:"FetchError"}: ${d==null?void 0:d.message}`,details:m,hint:p,code:y},data:null,count:null,status:0,statusText:""}})),u.then(r,n)}returns(){return this}overrideTypes(){return this}},jp=class extends kp{select(r){let n=!1;const s=(r??"*").split("").map(o=>/\s/.test(o)&&!n?"":(o==='"'&&(n=!n),o)).join("");return this.url.searchParams.set("select",s),this.headers.append("Prefer","return=representation"),this}order(r,{ascending:n=!0,nullsFirst:s,foreignTable:o,referencedTable:u=o}={}){const d=u?`${u}.order`:"order",f=this.url.searchParams.get(d);return this.url.searchParams.set(d,`${f?`${f},`:""}${r}.${n?"asc":"desc"}${s===void 0?"":s?".nullsfirst":".nullslast"}`),this}limit(r,{foreignTable:n,referencedTable:s=n}={}){const o=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(o,`${r}`),this}range(r,n,{foreignTable:s,referencedTable:o=s}={}){const u=typeof o>"u"?"offset":`${o}.offset`,d=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(u,`${r}`),this.url.searchParams.set(d,`${n-r+1}`),this}abortSignal(r){return this.signal=r,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:r=!1,verbose:n=!1,settings:s=!1,buffers:o=!1,wal:u=!1,format:d="text"}={}){var f;const m=[r?"analyze":null,n?"verbose":null,s?"settings":null,o?"buffers":null,u?"wal":null].filter(Boolean).join("|"),p=(f=this.headers.get("Accept"))!==null&&f!==void 0?f:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${d}; for="${p}"; options=${m};`),d==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(r){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${r}`),this}};const ih=new RegExp("[,()]");var Xr=class extends jp{eq(r,n){return this.url.searchParams.append(r,`eq.${n}`),this}neq(r,n){return this.url.searchParams.append(r,`neq.${n}`),this}gt(r,n){return this.url.searchParams.append(r,`gt.${n}`),this}gte(r,n){return this.url.searchParams.append(r,`gte.${n}`),this}lt(r,n){return this.url.searchParams.append(r,`lt.${n}`),this}lte(r,n){return this.url.searchParams.append(r,`lte.${n}`),this}like(r,n){return this.url.searchParams.append(r,`like.${n}`),this}likeAllOf(r,n){return this.url.searchParams.append(r,`like(all).{${n.join(",")}}`),this}likeAnyOf(r,n){return this.url.searchParams.append(r,`like(any).{${n.join(",")}}`),this}ilike(r,n){return this.url.searchParams.append(r,`ilike.${n}`),this}ilikeAllOf(r,n){return this.url.searchParams.append(r,`ilike(all).{${n.join(",")}}`),this}ilikeAnyOf(r,n){return this.url.searchParams.append(r,`ilike(any).{${n.join(",")}}`),this}regexMatch(r,n){return this.url.searchParams.append(r,`match.${n}`),this}regexIMatch(r,n){return this.url.searchParams.append(r,`imatch.${n}`),this}is(r,n){return this.url.searchParams.append(r,`is.${n}`),this}isDistinct(r,n){return this.url.searchParams.append(r,`isdistinct.${n}`),this}in(r,n){const s=Array.from(new Set(n)).map(o=>typeof o=="string"&&ih.test(o)?`"${o}"`:`${o}`).join(",");return this.url.searchParams.append(r,`in.(${s})`),this}notIn(r,n){const s=Array.from(new Set(n)).map(o=>typeof o=="string"&&ih.test(o)?`"${o}"`:`${o}`).join(",");return this.url.searchParams.append(r,`not.in.(${s})`),this}contains(r,n){return typeof n=="string"?this.url.searchParams.append(r,`cs.${n}`):Array.isArray(n)?this.url.searchParams.append(r,`cs.{${n.join(",")}}`):this.url.searchParams.append(r,`cs.${JSON.stringify(n)}`),this}containedBy(r,n){return typeof n=="string"?this.url.searchParams.append(r,`cd.${n}`):Array.isArray(n)?this.url.searchParams.append(r,`cd.{${n.join(",")}}`):this.url.searchParams.append(r,`cd.${JSON.stringify(n)}`),this}rangeGt(r,n){return this.url.searchParams.append(r,`sr.${n}`),this}rangeGte(r,n){return this.url.searchParams.append(r,`nxl.${n}`),this}rangeLt(r,n){return this.url.searchParams.append(r,`sl.${n}`),this}rangeLte(r,n){return this.url.searchParams.append(r,`nxr.${n}`),this}rangeAdjacent(r,n){return this.url.searchParams.append(r,`adj.${n}`),this}overlaps(r,n){return typeof n=="string"?this.url.searchParams.append(r,`ov.${n}`):this.url.searchParams.append(r,`ov.{${n.join(",")}}`),this}textSearch(r,n,{config:s,type:o}={}){let u="";o==="plain"?u="pl":o==="phrase"?u="ph":o==="websearch"&&(u="w");const d=s===void 0?"":`(${s})`;return this.url.searchParams.append(r,`${u}fts${d}.${n}`),this}match(r){return Object.entries(r).forEach(([n,s])=>{this.url.searchParams.append(n,`eq.${s}`)}),this}not(r,n,s){return this.url.searchParams.append(r,`not.${n}.${s}`),this}or(r,{foreignTable:n,referencedTable:s=n}={}){const o=s?`${s}.or`:"or";return this.url.searchParams.append(o,`(${r})`),this}filter(r,n,s){return this.url.searchParams.append(r,`${n}.${s}`),this}},Sp=class{constructor(r,{headers:n={},schema:s,fetch:o,urlLengthLimit:u=8e3}){this.url=r,this.headers=new Headers(n),this.schema=s,this.fetch=o,this.urlLengthLimit=u}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(r,n){const{head:s=!1,count:o}=n??{},u=s?"HEAD":"GET";let d=!1;const f=(r??"*").split("").map(y=>/\s/.test(y)&&!d?"":(y==='"'&&(d=!d),y)).join(""),{url:m,headers:p}=this.cloneRequestState();return m.searchParams.set("select",f),o&&p.append("Prefer",`count=${o}`),new Xr({method:u,url:m,headers:p,schema:this.schema,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}insert(r,{count:n,defaultToNull:s=!0}={}){var o;const u="POST",{url:d,headers:f}=this.cloneRequestState();if(n&&f.append("Prefer",`count=${n}`),s||f.append("Prefer","missing=default"),Array.isArray(r)){const m=r.reduce((p,y)=>p.concat(Object.keys(y)),[]);if(m.length>0){const p=[...new Set(m)].map(y=>`"${y}"`);d.searchParams.set("columns",p.join(","))}}return new Xr({method:u,url:d,headers:f,schema:this.schema,body:r,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch,urlLengthLimit:this.urlLengthLimit})}upsert(r,{onConflict:n,ignoreDuplicates:s=!1,count:o,defaultToNull:u=!0}={}){var d;const f="POST",{url:m,headers:p}=this.cloneRequestState();if(p.append("Prefer",`resolution=${s?"ignore":"merge"}-duplicates`),n!==void 0&&m.searchParams.set("on_conflict",n),o&&p.append("Prefer",`count=${o}`),u||p.append("Prefer","missing=default"),Array.isArray(r)){const y=r.reduce((v,b)=>v.concat(Object.keys(b)),[]);if(y.length>0){const v=[...new Set(y)].map(b=>`"${b}"`);m.searchParams.set("columns",v.join(","))}}return new Xr({method:f,url:m,headers:p,schema:this.schema,body:r,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch,urlLengthLimit:this.urlLengthLimit})}update(r,{count:n}={}){var s;const o="PATCH",{url:u,headers:d}=this.cloneRequestState();return n&&d.append("Prefer",`count=${n}`),new Xr({method:o,url:u,headers:d,schema:this.schema,body:r,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch,urlLengthLimit:this.urlLengthLimit})}delete({count:r}={}){var n;const s="DELETE",{url:o,headers:u}=this.cloneRequestState();return r&&u.append("Prefer",`count=${r}`),new Xr({method:s,url:o,headers:u,schema:this.schema,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch,urlLengthLimit:this.urlLengthLimit})}};function Xs(r){"@babel/helpers - typeof";return Xs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Xs(r)}function Np(r,n){if(Xs(r)!="object"||!r)return r;var s=r[Symbol.toPrimitive];if(s!==void 0){var o=s.call(r,n);if(Xs(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(r)}function Ep(r){var n=Np(r,"string");return Xs(n)=="symbol"?n:n+""}function Cp(r,n,s){return(n=Ep(n))in r?Object.defineProperty(r,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):r[n]=s,r}function oh(r,n){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(r);n&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(r,u).enumerable})),s.push.apply(s,o)}return s}function bi(r){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?oh(Object(s),!0).forEach(function(o){Cp(r,o,s[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):oh(Object(s)).forEach(function(o){Object.defineProperty(r,o,Object.getOwnPropertyDescriptor(s,o))})}return r}var Tp=class Oh{constructor(n,{headers:s={},schema:o,fetch:u,timeout:d,urlLengthLimit:f=8e3}={}){this.url=n,this.headers=new Headers(s),this.schemaName=o,this.urlLengthLimit=f;const m=u??globalThis.fetch;d!==void 0&&d>0?this.fetch=(p,y)=>{const v=new AbortController,b=setTimeout(()=>v.abort(),d),_=y==null?void 0:y.signal;if(_){if(_.aborted)return clearTimeout(b),m(p,y);const w=()=>{clearTimeout(b),v.abort()};return _.addEventListener("abort",w,{once:!0}),m(p,bi(bi({},y),{},{signal:v.signal})).finally(()=>{clearTimeout(b),_.removeEventListener("abort",w)})}return m(p,bi(bi({},y),{},{signal:v.signal})).finally(()=>clearTimeout(b))}:this.fetch=m}from(n){if(!n||typeof n!="string"||n.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new Sp(new URL(`${this.url}/${n}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}schema(n){return new Oh(this.url,{headers:this.headers,schema:n,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}rpc(n,s={},{head:o=!1,get:u=!1,count:d}={}){var f;let m;const p=new URL(`${this.url}/rpc/${n}`);let y;const v=w=>w!==null&&typeof w=="object"&&(!Array.isArray(w)||w.some(v)),b=o&&Object.values(s).some(v);b?(m="POST",y=s):o||u?(m=o?"HEAD":"GET",Object.entries(s).filter(([w,T])=>T!==void 0).map(([w,T])=>[w,Array.isArray(T)?`{${T.join(",")}}`:`${T}`]).forEach(([w,T])=>{p.searchParams.append(w,T)})):(m="POST",y=s);const _=new Headers(this.headers);return b?_.set("Prefer",d?`count=${d},return=minimal`:"return=minimal"):d&&_.set("Prefer",`count=${d}`),new Xr({method:m,url:p,headers:_,schema:this.schemaName,body:y,fetch:(f=this.fetch)!==null&&f!==void 0?f:fetch,urlLengthLimit:this.urlLengthLimit})}};class Ap{constructor(){}static detectEnvironment(){var n;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((n=navigator.userAgent)===null||n===void 0)&&n.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const s=globalThis.process;if(s){const o=s.versions;if(o&&o.node){const u=o.node,d=parseInt(u.replace(/^v/,"").split(".")[0]);return d>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${d} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${d} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const n=this.detectEnvironment();if(n.constructor)return n.constructor;let s=n.error||"WebSocket not supported in this environment.";throw n.workaround&&(s+=`

Suggested solution: ${n.workaround}`),new Error(s)}static createWebSocket(n,s){const o=this.getWebSocketConstructor();return new o(n,s)}static isWebSocketSupported(){try{const n=this.detectEnvironment();return n.type==="native"||n.type==="ws"}catch{return!1}}}const Ip="2.95.3",Rp=`realtime-js/${Ip}`,Op="1.0.0",Ph="2.0.0",lh=Ph,Hl=1e4,Pp=1e3,Dp=100;var Xn;(function(r){r[r.connecting=0]="connecting",r[r.open=1]="open",r[r.closing=2]="closing",r[r.closed=3]="closed"})(Xn||(Xn={}));var it;(function(r){r.closed="closed",r.errored="errored",r.joined="joined",r.joining="joining",r.leaving="leaving"})(it||(it={}));var nn;(function(r){r.close="phx_close",r.error="phx_error",r.join="phx_join",r.reply="phx_reply",r.leave="phx_leave",r.access_token="access_token"})(nn||(nn={}));var Gl;(function(r){r.websocket="websocket"})(Gl||(Gl={}));var vr;(function(r){r.Connecting="connecting",r.Open="open",r.Closing="closing",r.Closed="closed"})(vr||(vr={}));class Lp{constructor(n){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=n??[]}encode(n,s){if(n.event===this.BROADCAST_EVENT&&!(n.payload instanceof ArrayBuffer)&&typeof n.payload.event=="string")return s(this._binaryEncodeUserBroadcastPush(n));let o=[n.join_ref,n.ref,n.topic,n.event,n.payload];return s(JSON.stringify(o))}_binaryEncodeUserBroadcastPush(n){var s;return this._isArrayBuffer((s=n.payload)===null||s===void 0?void 0:s.payload)?this._encodeBinaryUserBroadcastPush(n):this._encodeJsonUserBroadcastPush(n)}_encodeBinaryUserBroadcastPush(n){var s,o;const u=(o=(s=n.payload)===null||s===void 0?void 0:s.payload)!==null&&o!==void 0?o:new ArrayBuffer(0);return this._encodeUserBroadcastPush(n,this.BINARY_ENCODING,u)}_encodeJsonUserBroadcastPush(n){var s,o;const u=(o=(s=n.payload)===null||s===void 0?void 0:s.payload)!==null&&o!==void 0?o:{},f=new TextEncoder().encode(JSON.stringify(u)).buffer;return this._encodeUserBroadcastPush(n,this.JSON_ENCODING,f)}_encodeUserBroadcastPush(n,s,o){var u,d;const f=n.topic,m=(u=n.ref)!==null&&u!==void 0?u:"",p=(d=n.join_ref)!==null&&d!==void 0?d:"",y=n.payload.event,v=this.allowedMetadataKeys?this._pick(n.payload,this.allowedMetadataKeys):{},b=Object.keys(v).length===0?"":JSON.stringify(v);if(p.length>255)throw new Error(`joinRef length ${p.length} exceeds maximum of 255`);if(m.length>255)throw new Error(`ref length ${m.length} exceeds maximum of 255`);if(f.length>255)throw new Error(`topic length ${f.length} exceeds maximum of 255`);if(y.length>255)throw new Error(`userEvent length ${y.length} exceeds maximum of 255`);if(b.length>255)throw new Error(`metadata length ${b.length} exceeds maximum of 255`);const _=this.USER_BROADCAST_PUSH_META_LENGTH+p.length+m.length+f.length+y.length+b.length,w=new ArrayBuffer(this.HEADER_LENGTH+_);let T=new DataView(w),j=0;T.setUint8(j++,this.KINDS.userBroadcastPush),T.setUint8(j++,p.length),T.setUint8(j++,m.length),T.setUint8(j++,f.length),T.setUint8(j++,y.length),T.setUint8(j++,b.length),T.setUint8(j++,s),Array.from(p,D=>T.setUint8(j++,D.charCodeAt(0))),Array.from(m,D=>T.setUint8(j++,D.charCodeAt(0))),Array.from(f,D=>T.setUint8(j++,D.charCodeAt(0))),Array.from(y,D=>T.setUint8(j++,D.charCodeAt(0))),Array.from(b,D=>T.setUint8(j++,D.charCodeAt(0)));var E=new Uint8Array(w.byteLength+o.byteLength);return E.set(new Uint8Array(w),0),E.set(new Uint8Array(o),w.byteLength),E.buffer}decode(n,s){if(this._isArrayBuffer(n)){let o=this._binaryDecode(n);return s(o)}if(typeof n=="string"){const o=JSON.parse(n),[u,d,f,m,p]=o;return s({join_ref:u,ref:d,topic:f,event:m,payload:p})}return s({})}_binaryDecode(n){const s=new DataView(n),o=s.getUint8(0),u=new TextDecoder;switch(o){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(n,s,u)}}_decodeUserBroadcast(n,s,o){const u=s.getUint8(1),d=s.getUint8(2),f=s.getUint8(3),m=s.getUint8(4);let p=this.HEADER_LENGTH+4;const y=o.decode(n.slice(p,p+u));p=p+u;const v=o.decode(n.slice(p,p+d));p=p+d;const b=o.decode(n.slice(p,p+f));p=p+f;const _=n.slice(p,n.byteLength),w=m===this.JSON_ENCODING?JSON.parse(o.decode(_)):_,T={type:this.BROADCAST_EVENT,event:v,payload:w};return f>0&&(T.meta=JSON.parse(b)),{join_ref:null,ref:null,topic:y,event:this.BROADCAST_EVENT,payload:T}}_isArrayBuffer(n){var s;return n instanceof ArrayBuffer||((s=n==null?void 0:n.constructor)===null||s===void 0?void 0:s.name)==="ArrayBuffer"}_pick(n,s){return!n||typeof n!="object"?{}:Object.fromEntries(Object.entries(n).filter(([o])=>s.includes(o)))}}class Dh{constructor(n,s){this.callback=n,this.timerCalc=s,this.timer=void 0,this.tries=0,this.callback=n,this.timerCalc=s}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Ue;(function(r){r.abstime="abstime",r.bool="bool",r.date="date",r.daterange="daterange",r.float4="float4",r.float8="float8",r.int2="int2",r.int4="int4",r.int4range="int4range",r.int8="int8",r.int8range="int8range",r.json="json",r.jsonb="jsonb",r.money="money",r.numeric="numeric",r.oid="oid",r.reltime="reltime",r.text="text",r.time="time",r.timestamp="timestamp",r.timestamptz="timestamptz",r.timetz="timetz",r.tsrange="tsrange",r.tstzrange="tstzrange"})(Ue||(Ue={}));const uh=(r,n,s={})=>{var o;const u=(o=s.skipTypes)!==null&&o!==void 0?o:[];return n?Object.keys(n).reduce((d,f)=>(d[f]=$p(f,r,n,u),d),{}):{}},$p=(r,n,s,o)=>{const u=n.find(m=>m.name===r),d=u==null?void 0:u.type,f=s[r];return d&&!o.includes(d)?Lh(d,f):Kl(f)},Lh=(r,n)=>{if(r.charAt(0)==="_"){const s=r.slice(1,r.length);return zp(n,s)}switch(r){case Ue.bool:return Mp(n);case Ue.float4:case Ue.float8:case Ue.int2:case Ue.int4:case Ue.int8:case Ue.numeric:case Ue.oid:return Up(n);case Ue.json:case Ue.jsonb:return Fp(n);case Ue.timestamp:return Bp(n);case Ue.abstime:case Ue.date:case Ue.daterange:case Ue.int4range:case Ue.int8range:case Ue.money:case Ue.reltime:case Ue.text:case Ue.time:case Ue.timestamptz:case Ue.timetz:case Ue.tsrange:case Ue.tstzrange:return Kl(n);default:return Kl(n)}},Kl=r=>r,Mp=r=>{switch(r){case"t":return!0;case"f":return!1;default:return r}},Up=r=>{if(typeof r=="string"){const n=parseFloat(r);if(!Number.isNaN(n))return n}return r},Fp=r=>{if(typeof r=="string")try{return JSON.parse(r)}catch{return r}return r},zp=(r,n)=>{if(typeof r!="string")return r;const s=r.length-1,o=r[s];if(r[0]==="{"&&o==="}"){let d;const f=r.slice(1,s);try{d=JSON.parse("["+f+"]")}catch{d=f?f.split(","):[]}return d.map(m=>Lh(n,m))}return r},Bp=r=>typeof r=="string"?r.replace(" ","T"):r,$h=r=>{const n=new URL(r);return n.protocol=n.protocol.replace(/^ws/i,"http"),n.pathname=n.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),n.pathname===""||n.pathname==="/"?n.pathname="/api/broadcast":n.pathname=n.pathname+"/api/broadcast",n.href};class Ll{constructor(n,s,o={},u=Hl){this.channel=n,this.event=s,this.payload=o,this.timeout=u,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(n){this.timeout=n,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(n){this.payload=Object.assign(Object.assign({},this.payload),n)}receive(n,s){var o;return this._hasReceived(n)&&s((o=this.receivedResp)===null||o===void 0?void 0:o.response),this.recHooks.push({status:n,callback:s}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const n=s=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=s,this._matchReceive(s)};this.channel._on(this.refEvent,{},n),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(n,s){this.refEvent&&this.channel._trigger(this.refEvent,{status:n,response:s})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:n,response:s}){this.recHooks.filter(o=>o.status===n).forEach(o=>o.callback(s))}_hasReceived(n){return this.receivedResp&&this.receivedResp.status===n}}var ch;(function(r){r.SYNC="sync",r.JOIN="join",r.LEAVE="leave"})(ch||(ch={}));class Js{constructor(n,s){this.channel=n,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const o=(s==null?void 0:s.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(o.state,{},u=>{const{onJoin:d,onLeave:f,onSync:m}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Js.syncState(this.state,u,d,f),this.pendingDiffs.forEach(p=>{this.state=Js.syncDiff(this.state,p,d,f)}),this.pendingDiffs=[],m()}),this.channel._on(o.diff,{},u=>{const{onJoin:d,onLeave:f,onSync:m}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(u):(this.state=Js.syncDiff(this.state,u,d,f),m())}),this.onJoin((u,d,f)=>{this.channel._trigger("presence",{event:"join",key:u,currentPresences:d,newPresences:f})}),this.onLeave((u,d,f)=>{this.channel._trigger("presence",{event:"leave",key:u,currentPresences:d,leftPresences:f})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(n,s,o,u){const d=this.cloneDeep(n),f=this.transformState(s),m={},p={};return this.map(d,(y,v)=>{f[y]||(p[y]=v)}),this.map(f,(y,v)=>{const b=d[y];if(b){const _=v.map(E=>E.presence_ref),w=b.map(E=>E.presence_ref),T=v.filter(E=>w.indexOf(E.presence_ref)<0),j=b.filter(E=>_.indexOf(E.presence_ref)<0);T.length>0&&(m[y]=T),j.length>0&&(p[y]=j)}else m[y]=v}),this.syncDiff(d,{joins:m,leaves:p},o,u)}static syncDiff(n,s,o,u){const{joins:d,leaves:f}={joins:this.transformState(s.joins),leaves:this.transformState(s.leaves)};return o||(o=()=>{}),u||(u=()=>{}),this.map(d,(m,p)=>{var y;const v=(y=n[m])!==null&&y!==void 0?y:[];if(n[m]=this.cloneDeep(p),v.length>0){const b=n[m].map(w=>w.presence_ref),_=v.filter(w=>b.indexOf(w.presence_ref)<0);n[m].unshift(..._)}o(m,v,p)}),this.map(f,(m,p)=>{let y=n[m];if(!y)return;const v=p.map(b=>b.presence_ref);y=y.filter(b=>v.indexOf(b.presence_ref)<0),n[m]=y,u(m,y,p),y.length===0&&delete n[m]}),n}static map(n,s){return Object.getOwnPropertyNames(n).map(o=>s(o,n[o]))}static transformState(n){return n=this.cloneDeep(n),Object.getOwnPropertyNames(n).reduce((s,o)=>{const u=n[o];return"metas"in u?s[o]=u.metas.map(d=>(d.presence_ref=d.phx_ref,delete d.phx_ref,delete d.phx_ref_prev,d)):s[o]=u,s},{})}static cloneDeep(n){return JSON.parse(JSON.stringify(n))}onJoin(n){this.caller.onJoin=n}onLeave(n){this.caller.onLeave=n}onSync(n){this.caller.onSync=n}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var dh;(function(r){r.ALL="*",r.INSERT="INSERT",r.UPDATE="UPDATE",r.DELETE="DELETE"})(dh||(dh={}));var Qs;(function(r){r.BROADCAST="broadcast",r.PRESENCE="presence",r.POSTGRES_CHANGES="postgres_changes",r.SYSTEM="system"})(Qs||(Qs={}));var Sn;(function(r){r.SUBSCRIBED="SUBSCRIBED",r.TIMED_OUT="TIMED_OUT",r.CLOSED="CLOSED",r.CHANNEL_ERROR="CHANNEL_ERROR"})(Sn||(Sn={}));class ts{constructor(n,s={config:{}},o){var u,d;if(this.topic=n,this.params=s,this.socket=o,this.bindings={},this.state=it.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=n.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},s.config),this.timeout=this.socket.timeout,this.joinPush=new Ll(this,nn.join,this.params,this.timeout),this.rejoinTimer=new Dh(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=it.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(f=>f.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=it.closed,this.socket._remove(this)}),this._onError(f=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,f),this.state=it.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=it.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",f=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,f),this.state=it.errored,this.rejoinTimer.scheduleTimeout())}),this._on(nn.reply,{},(f,m)=>{this._trigger(this._replyEventName(m),f)}),this.presence=new Js(this),this.broadcastEndpointURL=$h(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((d=(u=this.params.config)===null||u===void 0?void 0:u.broadcast)===null||d===void 0)&&d.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(n,s=this.timeout){var o,u,d;if(this.socket.isConnected()||this.socket.connect(),this.state==it.closed){const{config:{broadcast:f,presence:m,private:p}}=this.params,y=(u=(o=this.bindings.postgres_changes)===null||o===void 0?void 0:o.map(w=>w.filter))!==null&&u!==void 0?u:[],v=!!this.bindings[Qs.PRESENCE]&&this.bindings[Qs.PRESENCE].length>0||((d=this.params.config.presence)===null||d===void 0?void 0:d.enabled)===!0,b={},_={broadcast:f,presence:Object.assign(Object.assign({},m),{enabled:v}),postgres_changes:y,private:p};this.socket.accessTokenValue&&(b.access_token=this.socket.accessTokenValue),this._onError(w=>n==null?void 0:n(Sn.CHANNEL_ERROR,w)),this._onClose(()=>n==null?void 0:n(Sn.CLOSED)),this.updateJoinPayload(Object.assign({config:_},b)),this.joinedOnce=!0,this._rejoin(s),this.joinPush.receive("ok",async({postgres_changes:w})=>{var T;if(this.socket._isManualToken()||this.socket.setAuth(),w===void 0){n==null||n(Sn.SUBSCRIBED);return}else{const j=this.bindings.postgres_changes,E=(T=j==null?void 0:j.length)!==null&&T!==void 0?T:0,D=[];for(let V=0;V<E;V++){const z=j[V],{filter:{event:q,schema:$,table:M,filter:Y}}=z,re=w&&w[V];if(re&&re.event===q&&ts.isFilterValueEqual(re.schema,$)&&ts.isFilterValueEqual(re.table,M)&&ts.isFilterValueEqual(re.filter,Y))D.push(Object.assign(Object.assign({},z),{id:re.id}));else{this.unsubscribe(),this.state=it.errored,n==null||n(Sn.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=D,n&&n(Sn.SUBSCRIBED);return}}).receive("error",w=>{this.state=it.errored,n==null||n(Sn.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(w).join(", ")||"error")))}).receive("timeout",()=>{n==null||n(Sn.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(n,s={}){return await this.send({type:"presence",event:"track",payload:n},s.timeout||this.timeout)}async untrack(n={}){return await this.send({type:"presence",event:"untrack"},n)}on(n,s,o){return this.state===it.joined&&n===Qs.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(n,s,o)}async httpSend(n,s,o={}){var u;if(s==null)return Promise.reject("Payload is required for httpSend()");const d={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(d.Authorization=`Bearer ${this.socket.accessTokenValue}`);const f={method:"POST",headers:d,body:JSON.stringify({messages:[{topic:this.subTopic,event:n,payload:s,private:this.private}]})},m=await this._fetchWithTimeout(this.broadcastEndpointURL,f,(u=o.timeout)!==null&&u!==void 0?u:this.timeout);if(m.status===202)return{success:!0};let p=m.statusText;try{const y=await m.json();p=y.error||y.message||p}catch{}return Promise.reject(new Error(p))}async send(n,s={}){var o,u;if(!this._canPush()&&n.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:d,payload:f}=n,m={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(m.Authorization=`Bearer ${this.socket.accessTokenValue}`);const p={method:"POST",headers:m,body:JSON.stringify({messages:[{topic:this.subTopic,event:d,payload:f,private:this.private}]})};try{const y=await this._fetchWithTimeout(this.broadcastEndpointURL,p,(o=s.timeout)!==null&&o!==void 0?o:this.timeout);return await((u=y.body)===null||u===void 0?void 0:u.cancel()),y.ok?"ok":"error"}catch(y){return y.name==="AbortError"?"timed out":"error"}}else return new Promise(d=>{var f,m,p;const y=this._push(n.type,n,s.timeout||this.timeout);n.type==="broadcast"&&!(!((p=(m=(f=this.params)===null||f===void 0?void 0:f.config)===null||m===void 0?void 0:m.broadcast)===null||p===void 0)&&p.ack)&&d("ok"),y.receive("ok",()=>d("ok")),y.receive("error",()=>d("error")),y.receive("timeout",()=>d("timed out"))})}updateJoinPayload(n){this.joinPush.updatePayload(n)}unsubscribe(n=this.timeout){this.state=it.leaving;const s=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(nn.close,"leave",this._joinRef())};this.joinPush.destroy();let o=null;return new Promise(u=>{o=new Ll(this,nn.leave,{},n),o.receive("ok",()=>{s(),u("ok")}).receive("timeout",()=>{s(),u("timed out")}).receive("error",()=>{u("error")}),o.send(),this._canPush()||o.trigger("ok",{})}).finally(()=>{o==null||o.destroy()})}teardown(){this.pushBuffer.forEach(n=>n.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=it.closed,this.bindings={}}async _fetchWithTimeout(n,s,o){const u=new AbortController,d=setTimeout(()=>u.abort(),o),f=await this.socket.fetch(n,Object.assign(Object.assign({},s),{signal:u.signal}));return clearTimeout(d),f}_push(n,s,o=this.timeout){if(!this.joinedOnce)throw`tried to push '${n}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let u=new Ll(this,n,s,o);return this._canPush()?u.send():this._addToPushBuffer(u),u}_addToPushBuffer(n){if(n.startTimeout(),this.pushBuffer.push(n),this.pushBuffer.length>Dp){const s=this.pushBuffer.shift();s&&(s.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${s.event}`,s.payload))}}_onMessage(n,s,o){return s}_isMember(n){return this.topic===n}_joinRef(){return this.joinPush.ref}_trigger(n,s,o){var u,d;const f=n.toLocaleLowerCase(),{close:m,error:p,leave:y,join:v}=nn;if(o&&[m,p,y,v].indexOf(f)>=0&&o!==this._joinRef())return;let _=this._onMessage(f,s,o);if(s&&!_)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(f)?(u=this.bindings.postgres_changes)===null||u===void 0||u.filter(w=>{var T,j,E;return((T=w.filter)===null||T===void 0?void 0:T.event)==="*"||((E=(j=w.filter)===null||j===void 0?void 0:j.event)===null||E===void 0?void 0:E.toLocaleLowerCase())===f}).map(w=>w.callback(_,o)):(d=this.bindings[f])===null||d===void 0||d.filter(w=>{var T,j,E,D,V,z;if(["broadcast","presence","postgres_changes"].includes(f))if("id"in w){const q=w.id,$=(T=w.filter)===null||T===void 0?void 0:T.event;return q&&((j=s.ids)===null||j===void 0?void 0:j.includes(q))&&($==="*"||($==null?void 0:$.toLocaleLowerCase())===((E=s.data)===null||E===void 0?void 0:E.type.toLocaleLowerCase()))}else{const q=(V=(D=w==null?void 0:w.filter)===null||D===void 0?void 0:D.event)===null||V===void 0?void 0:V.toLocaleLowerCase();return q==="*"||q===((z=s==null?void 0:s.event)===null||z===void 0?void 0:z.toLocaleLowerCase())}else return w.type.toLocaleLowerCase()===f}).map(w=>{if(typeof _=="object"&&"ids"in _){const T=_.data,{schema:j,table:E,commit_timestamp:D,type:V,errors:z}=T;_=Object.assign(Object.assign({},{schema:j,table:E,commit_timestamp:D,eventType:V,new:{},old:{},errors:z}),this._getPayloadRecords(T))}w.callback(_,o)})}_isClosed(){return this.state===it.closed}_isJoined(){return this.state===it.joined}_isJoining(){return this.state===it.joining}_isLeaving(){return this.state===it.leaving}_replyEventName(n){return`chan_reply_${n}`}_on(n,s,o){const u=n.toLocaleLowerCase(),d={type:u,filter:s,callback:o};return this.bindings[u]?this.bindings[u].push(d):this.bindings[u]=[d],this}_off(n,s){const o=n.toLocaleLowerCase();return this.bindings[o]&&(this.bindings[o]=this.bindings[o].filter(u=>{var d;return!(((d=u.type)===null||d===void 0?void 0:d.toLocaleLowerCase())===o&&ts.isEqual(u.filter,s))})),this}static isEqual(n,s){if(Object.keys(n).length!==Object.keys(s).length)return!1;for(const o in n)if(n[o]!==s[o])return!1;return!0}static isFilterValueEqual(n,s){return(n??void 0)===(s??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(n){this._on(nn.close,{},n)}_onError(n){this._on(nn.error,{},s=>n(s))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(n=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=it.joining,this.joinPush.resend(n))}_getPayloadRecords(n){const s={new:{},old:{}};return(n.type==="INSERT"||n.type==="UPDATE")&&(s.new=uh(n.columns,n.record)),(n.type==="UPDATE"||n.type==="DELETE")&&(s.old=uh(n.columns,n.old_record)),s}}const $l=()=>{},_i={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Wp=[1e3,2e3,5e3,1e4],qp=1e4,Vp=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Hp{constructor(n,s){var o;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Hl,this.transport=null,this.heartbeatIntervalMs=_i.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=$l,this.ref=0,this.reconnectTimer=null,this.vsn=lh,this.logger=$l,this.conn=null,this.sendBuffer=[],this.serializer=new Lp,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=u=>u?(...d)=>u(...d):(...d)=>fetch(...d),!(!((o=s==null?void 0:s.params)===null||o===void 0)&&o.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=s.params.apikey,this.endPoint=`${n}/${Gl.websocket}`,this.httpEndpoint=$h(n),this._initializeOptions(s),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(s==null?void 0:s.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Ap.createWebSocket(this.endpointURL())}catch(n){this._setConnectionState("disconnected");const s=n.message;throw s.includes("Node.js")?new Error(`${s}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${s}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(n,s){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const o=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(o),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(n?this.conn.close(n,s??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(n){const s=await n.unsubscribe();return s==="ok"&&this._remove(n),this.channels.length===0&&this.disconnect(),s}async removeAllChannels(){const n=await Promise.all(this.channels.map(s=>s.unsubscribe()));return this.channels=[],this.disconnect(),n}log(n,s,o){this.logger(n,s,o)}connectionState(){switch(this.conn&&this.conn.readyState){case Xn.connecting:return vr.Connecting;case Xn.open:return vr.Open;case Xn.closing:return vr.Closing;default:return vr.Closed}}isConnected(){return this.connectionState()===vr.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(n,s={config:{}}){const o=`realtime:${n}`,u=this.getChannels().find(d=>d.topic===o);if(u)return u;{const d=new ts(`realtime:${n}`,s,this);return this.channels.push(d),d}}push(n){const{topic:s,event:o,payload:u,ref:d}=n,f=()=>{this.encode(n,m=>{var p;(p=this.conn)===null||p===void 0||p.send(m)})};this.log("push",`${s} ${o} (${d})`,u),this.isConnected()?f():this.sendBuffer.push(f)}async setAuth(n=null){this._authPromise=this._performAuth(n);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var n;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(s){this.log("error","error in heartbeat callback",s)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(s){this.log("error","error in heartbeat callback",s)}this._wasManualDisconnect=!1,(n=this.conn)===null||n===void 0||n.close(Pp,"heartbeat timeout"),setTimeout(()=>{var s;this.isConnected()||(s=this.reconnectTimer)===null||s===void 0||s.scheduleTimeout()},_i.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(s){this.log("error","error in heartbeat callback",s)}this._setAuthSafely("heartbeat")}onHeartbeat(n){this.heartbeatCallback=n}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(n=>n()),this.sendBuffer=[])}_makeRef(){let n=this.ref+1;return n===this.ref?this.ref=0:this.ref=n,this.ref.toString()}_leaveOpenTopic(n){let s=this.channels.find(o=>o.topic===n&&(o._isJoined()||o._isJoining()));s&&(this.log("transport",`leaving duplicate topic "${n}"`),s.unsubscribe())}_remove(n){this.channels=this.channels.filter(s=>s.topic!==n.topic)}_onConnMessage(n){this.decode(n.data,s=>{if(s.topic==="phoenix"&&s.event==="phx_reply"&&s.ref&&s.ref===this.pendingHeartbeatRef){const y=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(s.payload.status==="ok"?"ok":"error",y)}catch(v){this.log("error","error in heartbeat callback",v)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:o,event:u,payload:d,ref:f}=s,m=f?`(${f})`:"",p=d.status||"";this.log("receive",`${p} ${o} ${u} ${m}`.trim(),d),this.channels.filter(y=>y._isMember(o)).forEach(y=>y._trigger(u,d,f)),this._triggerStateCallbacks("message",s)})}_clearTimer(n){var s;n==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):n==="reconnect"&&((s=this.reconnectTimer)===null||s===void 0||s.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=n=>this._onConnError(n),this.conn.onmessage=n=>this._onConnMessage(n),this.conn.onclose=n=>this._onConnClose(n),this.conn.readyState===Xn.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===Xn.open||this.conn.readyState===Xn.connecting)try{this.conn.close()}catch(n){this.log("error","Error closing connection",n)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(n=>n.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(s=>{this.log("error","error waiting for auth on connect",s),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const n=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(n),this.workerRef.onerror=s=>{this.log("worker","worker error",s.message),this._terminateWorker()},this.workerRef.onmessage=s=>{s.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(n){var s;this._setConnectionState("disconnected"),this.log("transport","close",n),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(s=this.reconnectTimer)===null||s===void 0||s.scheduleTimeout(),this._triggerStateCallbacks("close",n)}_onConnError(n){this._setConnectionState("disconnected"),this.log("transport",`${n}`),this._triggerChanError(),this._triggerStateCallbacks("error",n);try{this.heartbeatCallback("error")}catch(s){this.log("error","error in heartbeat callback",s)}}_triggerChanError(){this.channels.forEach(n=>n._trigger(nn.error))}_appendParams(n,s){if(Object.keys(s).length===0)return n;const o=n.match(/\?/)?"&":"?",u=new URLSearchParams(s);return`${n}${o}${u}`}_workerObjectUrl(n){let s;if(n)s=n;else{const o=new Blob([Vp],{type:"application/javascript"});s=URL.createObjectURL(o)}return s}_setConnectionState(n,s=!1){this._connectionState=n,n==="connecting"?this._wasManualDisconnect=!1:n==="disconnecting"&&(this._wasManualDisconnect=s)}async _performAuth(n=null){let s,o=!1;if(n)s=n,o=!0;else if(this.accessToken)try{s=await this.accessToken()}catch(u){this.log("error","Error fetching access token from callback",u),s=this.accessTokenValue}else s=this.accessTokenValue;o?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=s&&(this.accessTokenValue=s,this.channels.forEach(u=>{const d={access_token:s,version:Rp};s&&u.updateJoinPayload(d),u.joinedOnce&&u._isJoined()&&u._push(nn.access_token,{access_token:s})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(n="general"){this._isManualToken()||this.setAuth().catch(s=>{this.log("error",`Error setting auth in ${n}`,s)})}_triggerStateCallbacks(n,s){try{this.stateChangeCallbacks[n].forEach(o=>{try{o(s)}catch(u){this.log("error",`error in ${n} callback`,u)}})}catch(o){this.log("error",`error triggering ${n} callbacks`,o)}}_setupReconnectionTimer(){this.reconnectTimer=new Dh(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},_i.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(n){var s,o,u,d,f,m,p,y,v,b,_,w;switch(this.transport=(s=n==null?void 0:n.transport)!==null&&s!==void 0?s:null,this.timeout=(o=n==null?void 0:n.timeout)!==null&&o!==void 0?o:Hl,this.heartbeatIntervalMs=(u=n==null?void 0:n.heartbeatIntervalMs)!==null&&u!==void 0?u:_i.HEARTBEAT_INTERVAL,this.worker=(d=n==null?void 0:n.worker)!==null&&d!==void 0?d:!1,this.accessToken=(f=n==null?void 0:n.accessToken)!==null&&f!==void 0?f:null,this.heartbeatCallback=(m=n==null?void 0:n.heartbeatCallback)!==null&&m!==void 0?m:$l,this.vsn=(p=n==null?void 0:n.vsn)!==null&&p!==void 0?p:lh,n!=null&&n.params&&(this.params=n.params),n!=null&&n.logger&&(this.logger=n.logger),(n!=null&&n.logLevel||n!=null&&n.log_level)&&(this.logLevel=n.logLevel||n.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(y=n==null?void 0:n.reconnectAfterMs)!==null&&y!==void 0?y:(T=>Wp[T-1]||qp),this.vsn){case Op:this.encode=(v=n==null?void 0:n.encode)!==null&&v!==void 0?v:((T,j)=>j(JSON.stringify(T))),this.decode=(b=n==null?void 0:n.decode)!==null&&b!==void 0?b:((T,j)=>j(JSON.parse(T)));break;case Ph:this.encode=(_=n==null?void 0:n.encode)!==null&&_!==void 0?_:this.serializer.encode.bind(this.serializer),this.decode=(w=n==null?void 0:n.decode)!==null&&w!==void 0?w:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=n==null?void 0:n.workerUrl}}}var Zs=class extends Error{constructor(r,n){var s;super(r),this.name="IcebergError",this.status=n.status,this.icebergType=n.icebergType,this.icebergCode=n.icebergCode,this.details=n.details,this.isCommitStateUnknown=n.icebergType==="CommitStateUnknownException"||[500,502,504].includes(n.status)&&((s=n.icebergType)==null?void 0:s.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function Gp(r,n,s){const o=new URL(n,r);if(s)for(const[u,d]of Object.entries(s))d!==void 0&&o.searchParams.set(u,d);return o.toString()}async function Kp(r){return!r||r.type==="none"?{}:r.type==="bearer"?{Authorization:`Bearer ${r.token}`}:r.type==="header"?{[r.name]:r.value}:r.type==="custom"?await r.getHeaders():{}}function Jp(r){const n=r.fetchImpl??globalThis.fetch;return{async request({method:s,path:o,query:u,body:d,headers:f}){const m=Gp(r.baseUrl,o,u),p=await Kp(r.auth),y=await n(m,{method:s,headers:{...d?{"Content-Type":"application/json"}:{},...p,...f},body:d?JSON.stringify(d):void 0}),v=await y.text(),b=(y.headers.get("content-type")||"").includes("application/json"),_=b&&v?JSON.parse(v):v;if(!y.ok){const w=b?_:void 0,T=w==null?void 0:w.error;throw new Zs((T==null?void 0:T.message)??`Request failed with status ${y.status}`,{status:y.status,icebergType:T==null?void 0:T.type,icebergCode:T==null?void 0:T.code,details:w})}return{status:y.status,headers:y.headers,data:_}}}}function ki(r){return r.join("")}var Qp=class{constructor(r,n=""){this.client=r,this.prefix=n}async listNamespaces(r){const n=r?{parent:ki(r.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:n})).data.namespaces.map(o=>({namespace:o}))}async createNamespace(r,n){const s={namespace:r.namespace,properties:n==null?void 0:n.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:s})).data}async dropNamespace(r){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${ki(r.namespace)}`})}async loadNamespaceMetadata(r){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${ki(r.namespace)}`})).data.properties}}async namespaceExists(r){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${ki(r.namespace)}`}),!0}catch(n){if(n instanceof Zs&&n.status===404)return!1;throw n}}async createNamespaceIfNotExists(r,n){try{return await this.createNamespace(r,n)}catch(s){if(s instanceof Zs&&s.status===409)return;throw s}}};function Hr(r){return r.join("")}var Yp=class{constructor(r,n="",s){this.client=r,this.prefix=n,this.accessDelegation=s}async listTables(r){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Hr(r.namespace)}/tables`})).data.identifiers}async createTable(r,n){const s={};return this.accessDelegation&&(s["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Hr(r.namespace)}/tables`,body:n,headers:s})).data.metadata}async updateTable(r,n){const s=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Hr(r.namespace)}/tables/${r.name}`,body:n});return{"metadata-location":s.data["metadata-location"],metadata:s.data.metadata}}async dropTable(r,n){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Hr(r.namespace)}/tables/${r.name}`,query:{purgeRequested:String((n==null?void 0:n.purge)??!1)}})}async loadTable(r){const n={};return this.accessDelegation&&(n["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Hr(r.namespace)}/tables/${r.name}`,headers:n})).data.metadata}async tableExists(r){const n={};this.accessDelegation&&(n["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Hr(r.namespace)}/tables/${r.name}`,headers:n}),!0}catch(s){if(s instanceof Zs&&s.status===404)return!1;throw s}}async createTableIfNotExists(r,n){try{return await this.createTable(r,n)}catch(s){if(s instanceof Zs&&s.status===409)return await this.loadTable({namespace:r.namespace,name:n.name});throw s}}},Xp=class{constructor(r){var o;let n="v1";r.catalogName&&(n+=`/${r.catalogName}`);const s=r.baseUrl.endsWith("/")?r.baseUrl:`${r.baseUrl}/`;this.client=Jp({baseUrl:s,auth:r.auth,fetchImpl:r.fetch}),this.accessDelegation=(o=r.accessDelegation)==null?void 0:o.join(","),this.namespaceOps=new Qp(this.client,n),this.tableOps=new Yp(this.client,n,this.accessDelegation)}async listNamespaces(r){return this.namespaceOps.listNamespaces(r)}async createNamespace(r,n){return this.namespaceOps.createNamespace(r,n)}async dropNamespace(r){await this.namespaceOps.dropNamespace(r)}async loadNamespaceMetadata(r){return this.namespaceOps.loadNamespaceMetadata(r)}async listTables(r){return this.tableOps.listTables(r)}async createTable(r,n){return this.tableOps.createTable(r,n)}async updateTable(r,n){return this.tableOps.updateTable(r,n)}async dropTable(r,n){await this.tableOps.dropTable(r,n)}async loadTable(r){return this.tableOps.loadTable(r)}async namespaceExists(r){return this.namespaceOps.namespaceExists(r)}async tableExists(r){return this.tableOps.tableExists(r)}async createNamespaceIfNotExists(r,n){return this.namespaceOps.createNamespaceIfNotExists(r,n)}async createTableIfNotExists(r,n){return this.tableOps.createTableIfNotExists(r,n)}},Di=class extends Error{constructor(r,n="storage",s,o){super(r),this.__isStorageError=!0,this.namespace=n,this.name=n==="vectors"?"StorageVectorsError":"StorageError",this.status=s,this.statusCode=o}};function Li(r){return typeof r=="object"&&r!==null&&"__isStorageError"in r}var ji=class extends Di{constructor(r,n,s,o="storage"){super(r,o,n,s),this.name=o==="vectors"?"StorageVectorsApiError":"StorageApiError",this.status=n,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Mh=class extends Di{constructor(r,n,s="storage"){super(r,s),this.name=s==="vectors"?"StorageVectorsUnknownError":"StorageUnknownError",this.originalError=n}};const Zp=r=>r?(...n)=>r(...n):(...n)=>fetch(...n),eg=r=>{if(typeof r!="object"||r===null)return!1;const n=Object.getPrototypeOf(r);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in r)&&!(Symbol.iterator in r)},Jl=r=>{if(Array.isArray(r))return r.map(s=>Jl(s));if(typeof r=="function"||r!==Object(r))return r;const n={};return Object.entries(r).forEach(([s,o])=>{const u=s.replace(/([-_][a-z])/gi,d=>d.toUpperCase().replace(/[-_]/g,""));n[u]=Jl(o)}),n},tg=r=>!r||typeof r!="string"||r.length===0||r.length>100||r.trim()!==r||r.includes("/")||r.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(r);function ea(r){"@babel/helpers - typeof";return ea=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},ea(r)}function ng(r,n){if(ea(r)!="object"||!r)return r;var s=r[Symbol.toPrimitive];if(s!==void 0){var o=s.call(r,n);if(ea(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(r)}function rg(r){var n=ng(r,"string");return ea(n)=="symbol"?n:n+""}function sg(r,n,s){return(n=rg(n))in r?Object.defineProperty(r,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):r[n]=s,r}function hh(r,n){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(r);n&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(r,u).enumerable})),s.push.apply(s,o)}return s}function be(r){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?hh(Object(s),!0).forEach(function(o){sg(r,o,s[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):hh(Object(s)).forEach(function(o){Object.defineProperty(r,o,Object.getOwnPropertyDescriptor(s,o))})}return r}const fh=r=>{var n;return r.msg||r.message||r.error_description||(typeof r.error=="string"?r.error:(n=r.error)===null||n===void 0?void 0:n.message)||JSON.stringify(r)},ag=async(r,n,s,o)=>{if(r&&typeof r=="object"&&"status"in r&&"ok"in r&&typeof r.status=="number"&&!(s!=null&&s.noResolveJson)){const u=r,d=u.status||500;if(typeof u.json=="function")u.json().then(f=>{const m=(f==null?void 0:f.statusCode)||(f==null?void 0:f.code)||d+"";n(new ji(fh(f),d,m,o))}).catch(()=>{if(o==="vectors"){const f=d+"";n(new ji(u.statusText||`HTTP ${d} error`,d,f,o))}else{const f=d+"";n(new ji(u.statusText||`HTTP ${d} error`,d,f,o))}});else{const f=d+"";n(new ji(u.statusText||`HTTP ${d} error`,d,f,o))}}else n(new Mh(fh(r),r,o))},ig=(r,n,s,o)=>{const u={method:r,headers:(n==null?void 0:n.headers)||{}};return r==="GET"||r==="HEAD"||!o?be(be({},u),s):(eg(o)?(u.headers=be({"Content-Type":"application/json"},n==null?void 0:n.headers),u.body=JSON.stringify(o)):u.body=o,n!=null&&n.duplex&&(u.duplex=n.duplex),be(be({},u),s))};async function Hs(r,n,s,o,u,d,f){return new Promise((m,p)=>{r(s,ig(n,o,u,d)).then(y=>{if(!y.ok)throw y;if(o!=null&&o.noResolveJson)return y;if(f==="vectors"){const v=y.headers.get("content-type");if(y.headers.get("content-length")==="0"||y.status===204)return{};if(!v||!v.includes("application/json"))return{}}return y.json()}).then(y=>m(y)).catch(y=>ag(y,p,o,f))})}function Uh(r="storage"){return{get:async(n,s,o,u)=>Hs(n,"GET",s,o,u,void 0,r),post:async(n,s,o,u,d)=>Hs(n,"POST",s,u,d,o,r),put:async(n,s,o,u,d)=>Hs(n,"PUT",s,u,d,o,r),head:async(n,s,o,u)=>Hs(n,"HEAD",s,be(be({},o),{},{noResolveJson:!0}),u,void 0,r),remove:async(n,s,o,u,d)=>Hs(n,"DELETE",s,u,d,o,r)}}const og=Uh("storage"),{get:ta,post:tn,put:Ql,head:lg,remove:ru}=og,Mt=Uh("vectors");var is=class{constructor(r,n={},s,o="storage"){this.shouldThrowOnError=!1,this.url=r,this.headers=n,this.fetch=Zp(s),this.namespace=o}throwOnError(){return this.shouldThrowOnError=!0,this}async handleOperation(r){var n=this;try{return{data:await r(),error:null}}catch(s){if(n.shouldThrowOnError)throw s;if(Li(s))return{data:null,error:s};throw s}}},ug=class{constructor(r,n){this.downloadFn=r,this.shouldThrowOnError=n}then(r,n){return this.execute().then(r,n)}async execute(){var r=this;try{return{data:(await r.downloadFn()).body,error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(Li(n))return{data:null,error:n};throw n}}};let Fh;Fh=Symbol.toStringTag;var cg=class{constructor(r,n){this.downloadFn=r,this.shouldThrowOnError=n,this[Fh]="BlobDownloadBuilder",this.promise=null}asStream(){return new ug(this.downloadFn,this.shouldThrowOnError)}then(r,n){return this.getPromise().then(r,n)}catch(r){return this.getPromise().catch(r)}finally(r){return this.getPromise().finally(r)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var r=this;try{return{data:await(await r.downloadFn()).blob(),error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(Li(n))return{data:null,error:n};throw n}}};const dg={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},mh={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var hg=class extends is{constructor(r,n={},s,o){super(r,n,o,"storage"),this.bucketId=s}async uploadOrUpdate(r,n,s,o){var u=this;return u.handleOperation(async()=>{let d;const f=be(be({},mh),o);let m=be(be({},u.headers),r==="POST"&&{"x-upsert":String(f.upsert)});const p=f.metadata;typeof Blob<"u"&&s instanceof Blob?(d=new FormData,d.append("cacheControl",f.cacheControl),p&&d.append("metadata",u.encodeMetadata(p)),d.append("",s)):typeof FormData<"u"&&s instanceof FormData?(d=s,d.has("cacheControl")||d.append("cacheControl",f.cacheControl),p&&!d.has("metadata")&&d.append("metadata",u.encodeMetadata(p))):(d=s,m["cache-control"]=`max-age=${f.cacheControl}`,m["content-type"]=f.contentType,p&&(m["x-metadata"]=u.toBase64(u.encodeMetadata(p))),(typeof ReadableStream<"u"&&d instanceof ReadableStream||d&&typeof d=="object"&&"pipe"in d&&typeof d.pipe=="function")&&!f.duplex&&(f.duplex="half")),o!=null&&o.headers&&(m=be(be({},m),o.headers));const y=u._removeEmptyFolders(n),v=u._getFinalPath(y),b=await(r=="PUT"?Ql:tn)(u.fetch,`${u.url}/object/${v}`,d,be({headers:m},f!=null&&f.duplex?{duplex:f.duplex}:{}));return{path:y,id:b.Id,fullPath:b.Key}})}async upload(r,n,s){return this.uploadOrUpdate("POST",r,n,s)}async uploadToSignedUrl(r,n,s,o){var u=this;const d=u._removeEmptyFolders(r),f=u._getFinalPath(d),m=new URL(u.url+`/object/upload/sign/${f}`);return m.searchParams.set("token",n),u.handleOperation(async()=>{let p;const y=be({upsert:mh.upsert},o),v=be(be({},u.headers),{"x-upsert":String(y.upsert)});return typeof Blob<"u"&&s instanceof Blob?(p=new FormData,p.append("cacheControl",y.cacheControl),p.append("",s)):typeof FormData<"u"&&s instanceof FormData?(p=s,p.append("cacheControl",y.cacheControl)):(p=s,v["cache-control"]=`max-age=${y.cacheControl}`,v["content-type"]=y.contentType),{path:d,fullPath:(await Ql(u.fetch,m.toString(),p,{headers:v})).Key}})}async createSignedUploadUrl(r,n){var s=this;return s.handleOperation(async()=>{let o=s._getFinalPath(r);const u=be({},s.headers);n!=null&&n.upsert&&(u["x-upsert"]="true");const d=await tn(s.fetch,`${s.url}/object/upload/sign/${o}`,{},{headers:u}),f=new URL(s.url+d.url),m=f.searchParams.get("token");if(!m)throw new Di("No token returned by API");return{signedUrl:f.toString(),path:r,token:m}})}async update(r,n,s){return this.uploadOrUpdate("PUT",r,n,s)}async move(r,n,s){var o=this;return o.handleOperation(async()=>await tn(o.fetch,`${o.url}/object/move`,{bucketId:o.bucketId,sourceKey:r,destinationKey:n,destinationBucket:s==null?void 0:s.destinationBucket},{headers:o.headers}))}async copy(r,n,s){var o=this;return o.handleOperation(async()=>({path:(await tn(o.fetch,`${o.url}/object/copy`,{bucketId:o.bucketId,sourceKey:r,destinationKey:n,destinationBucket:s==null?void 0:s.destinationBucket},{headers:o.headers})).Key}))}async createSignedUrl(r,n,s){var o=this;return o.handleOperation(async()=>{let u=o._getFinalPath(r),d=await tn(o.fetch,`${o.url}/object/sign/${u}`,be({expiresIn:n},s!=null&&s.transform?{transform:s.transform}:{}),{headers:o.headers});const f=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return{signedUrl:encodeURI(`${o.url}${d.signedURL}${f}`)}})}async createSignedUrls(r,n,s){var o=this;return o.handleOperation(async()=>{const u=await tn(o.fetch,`${o.url}/object/sign/${o.bucketId}`,{expiresIn:n,paths:r},{headers:o.headers}),d=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return u.map(f=>be(be({},f),{},{signedUrl:f.signedURL?encodeURI(`${o.url}${f.signedURL}${d}`):null}))})}download(r,n,s){const o=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",u=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),d=u?`?${u}`:"",f=this._getFinalPath(r),m=()=>ta(this.fetch,`${this.url}/${o}/${f}${d}`,{headers:this.headers,noResolveJson:!0},s);return new cg(m,this.shouldThrowOnError)}async info(r){var n=this;const s=n._getFinalPath(r);return n.handleOperation(async()=>Jl(await ta(n.fetch,`${n.url}/object/info/${s}`,{headers:n.headers})))}async exists(r){var n=this;const s=n._getFinalPath(r);try{return await lg(n.fetch,`${n.url}/object/${s}`,{headers:n.headers}),{data:!0,error:null}}catch(o){if(n.shouldThrowOnError)throw o;if(Li(o)&&o instanceof Mh){const u=o.originalError;if([400,404].includes(u==null?void 0:u.status))return{data:!1,error:o}}throw o}}getPublicUrl(r,n){const s=this._getFinalPath(r),o=[],u=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";u!==""&&o.push(u);const d=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",f=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});f!==""&&o.push(f);let m=o.join("&");return m!==""&&(m=`?${m}`),{data:{publicUrl:encodeURI(`${this.url}/${d}/public/${s}${m}`)}}}async remove(r){var n=this;return n.handleOperation(async()=>await ru(n.fetch,`${n.url}/object/${n.bucketId}`,{prefixes:r},{headers:n.headers}))}async list(r,n,s){var o=this;return o.handleOperation(async()=>{const u=be(be(be({},dg),n),{},{prefix:r||""});return await tn(o.fetch,`${o.url}/object/list/${o.bucketId}`,u,{headers:o.headers},s)})}async listV2(r,n){var s=this;return s.handleOperation(async()=>{const o=be({},r);return await tn(s.fetch,`${s.url}/object/list-v2/${s.bucketId}`,o,{headers:s.headers},n)})}encodeMetadata(r){return JSON.stringify(r)}toBase64(r){return typeof Buffer<"u"?Buffer.from(r).toString("base64"):btoa(r)}_getFinalPath(r){return`${this.bucketId}/${r.replace(/^\/+/,"")}`}_removeEmptyFolders(r){return r.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(r){const n=[];return r.width&&n.push(`width=${r.width}`),r.height&&n.push(`height=${r.height}`),r.resize&&n.push(`resize=${r.resize}`),r.format&&n.push(`format=${r.format}`),r.quality&&n.push(`quality=${r.quality}`),n.join("&")}};const fg="2.95.3",ua={"X-Client-Info":`storage-js/${fg}`};var mg=class extends is{constructor(r,n={},s,o){const u=new URL(r);o!=null&&o.useNewHostname&&/supabase\.(co|in|red)$/.test(u.hostname)&&!u.hostname.includes("storage.supabase.")&&(u.hostname=u.hostname.replace("supabase.","storage.supabase."));const d=u.href.replace(/\/$/,""),f=be(be({},ua),n);super(d,f,s,"storage")}async listBuckets(r){var n=this;return n.handleOperation(async()=>{const s=n.listBucketOptionsToQueryString(r);return await ta(n.fetch,`${n.url}/bucket${s}`,{headers:n.headers})})}async getBucket(r){var n=this;return n.handleOperation(async()=>await ta(n.fetch,`${n.url}/bucket/${r}`,{headers:n.headers}))}async createBucket(r,n={public:!1}){var s=this;return s.handleOperation(async()=>await tn(s.fetch,`${s.url}/bucket`,{id:r,name:r,type:n.type,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:s.headers}))}async updateBucket(r,n){var s=this;return s.handleOperation(async()=>await Ql(s.fetch,`${s.url}/bucket/${r}`,{id:r,name:r,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:s.headers}))}async emptyBucket(r){var n=this;return n.handleOperation(async()=>await tn(n.fetch,`${n.url}/bucket/${r}/empty`,{},{headers:n.headers}))}async deleteBucket(r){var n=this;return n.handleOperation(async()=>await ru(n.fetch,`${n.url}/bucket/${r}`,{},{headers:n.headers}))}listBucketOptionsToQueryString(r){const n={};return r&&("limit"in r&&(n.limit=String(r.limit)),"offset"in r&&(n.offset=String(r.offset)),r.search&&(n.search=r.search),r.sortColumn&&(n.sortColumn=r.sortColumn),r.sortOrder&&(n.sortOrder=r.sortOrder)),Object.keys(n).length>0?"?"+new URLSearchParams(n).toString():""}},pg=class extends is{constructor(r,n={},s){const o=r.replace(/\/$/,""),u=be(be({},ua),n);super(o,u,s,"storage")}async createBucket(r){var n=this;return n.handleOperation(async()=>await tn(n.fetch,`${n.url}/bucket`,{name:r},{headers:n.headers}))}async listBuckets(r){var n=this;return n.handleOperation(async()=>{const s=new URLSearchParams;(r==null?void 0:r.limit)!==void 0&&s.set("limit",r.limit.toString()),(r==null?void 0:r.offset)!==void 0&&s.set("offset",r.offset.toString()),r!=null&&r.sortColumn&&s.set("sortColumn",r.sortColumn),r!=null&&r.sortOrder&&s.set("sortOrder",r.sortOrder),r!=null&&r.search&&s.set("search",r.search);const o=s.toString(),u=o?`${n.url}/bucket?${o}`:`${n.url}/bucket`;return await ta(n.fetch,u,{headers:n.headers})})}async deleteBucket(r){var n=this;return n.handleOperation(async()=>await ru(n.fetch,`${n.url}/bucket/${r}`,{},{headers:n.headers}))}from(r){var n=this;if(!tg(r))throw new Di("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const s=new Xp({baseUrl:this.url,catalogName:r,auth:{type:"custom",getHeaders:async()=>n.headers},fetch:this.fetch}),o=this.shouldThrowOnError;return new Proxy(s,{get(u,d){const f=u[d];return typeof f!="function"?f:async(...m)=>{try{return{data:await f.apply(u,m),error:null}}catch(p){if(o)throw p;return{data:null,error:p}}}}})}},gg=class extends is{constructor(r,n={},s){const o=r.replace(/\/$/,""),u=be(be({},ua),{},{"Content-Type":"application/json"},n);super(o,u,s,"vectors")}async createIndex(r){var n=this;return n.handleOperation(async()=>await Mt.post(n.fetch,`${n.url}/CreateIndex`,r,{headers:n.headers})||{})}async getIndex(r,n){var s=this;return s.handleOperation(async()=>await Mt.post(s.fetch,`${s.url}/GetIndex`,{vectorBucketName:r,indexName:n},{headers:s.headers}))}async listIndexes(r){var n=this;return n.handleOperation(async()=>await Mt.post(n.fetch,`${n.url}/ListIndexes`,r,{headers:n.headers}))}async deleteIndex(r,n){var s=this;return s.handleOperation(async()=>await Mt.post(s.fetch,`${s.url}/DeleteIndex`,{vectorBucketName:r,indexName:n},{headers:s.headers})||{})}},yg=class extends is{constructor(r,n={},s){const o=r.replace(/\/$/,""),u=be(be({},ua),{},{"Content-Type":"application/json"},n);super(o,u,s,"vectors")}async putVectors(r){var n=this;if(r.vectors.length<1||r.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return n.handleOperation(async()=>await Mt.post(n.fetch,`${n.url}/PutVectors`,r,{headers:n.headers})||{})}async getVectors(r){var n=this;return n.handleOperation(async()=>await Mt.post(n.fetch,`${n.url}/GetVectors`,r,{headers:n.headers}))}async listVectors(r){var n=this;if(r.segmentCount!==void 0){if(r.segmentCount<1||r.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(r.segmentIndex!==void 0&&(r.segmentIndex<0||r.segmentIndex>=r.segmentCount))throw new Error(`segmentIndex must be between 0 and ${r.segmentCount-1}`)}return n.handleOperation(async()=>await Mt.post(n.fetch,`${n.url}/ListVectors`,r,{headers:n.headers}))}async queryVectors(r){var n=this;return n.handleOperation(async()=>await Mt.post(n.fetch,`${n.url}/QueryVectors`,r,{headers:n.headers}))}async deleteVectors(r){var n=this;if(r.keys.length<1||r.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return n.handleOperation(async()=>await Mt.post(n.fetch,`${n.url}/DeleteVectors`,r,{headers:n.headers})||{})}},vg=class extends is{constructor(r,n={},s){const o=r.replace(/\/$/,""),u=be(be({},ua),{},{"Content-Type":"application/json"},n);super(o,u,s,"vectors")}async createBucket(r){var n=this;return n.handleOperation(async()=>await Mt.post(n.fetch,`${n.url}/CreateVectorBucket`,{vectorBucketName:r},{headers:n.headers})||{})}async getBucket(r){var n=this;return n.handleOperation(async()=>await Mt.post(n.fetch,`${n.url}/GetVectorBucket`,{vectorBucketName:r},{headers:n.headers}))}async listBuckets(r={}){var n=this;return n.handleOperation(async()=>await Mt.post(n.fetch,`${n.url}/ListVectorBuckets`,r,{headers:n.headers}))}async deleteBucket(r){var n=this;return n.handleOperation(async()=>await Mt.post(n.fetch,`${n.url}/DeleteVectorBucket`,{vectorBucketName:r},{headers:n.headers})||{})}},xg=class extends vg{constructor(r,n={}){super(r,n.headers||{},n.fetch)}from(r){return new wg(this.url,this.headers,r,this.fetch)}async createBucket(r){var n=()=>super.createBucket,s=this;return n().call(s,r)}async getBucket(r){var n=()=>super.getBucket,s=this;return n().call(s,r)}async listBuckets(r={}){var n=()=>super.listBuckets,s=this;return n().call(s,r)}async deleteBucket(r){var n=()=>super.deleteBucket,s=this;return n().call(s,r)}},wg=class extends gg{constructor(r,n,s,o){super(r,n,o),this.vectorBucketName=s}async createIndex(r){var n=()=>super.createIndex,s=this;return n().call(s,be(be({},r),{},{vectorBucketName:s.vectorBucketName}))}async listIndexes(r={}){var n=()=>super.listIndexes,s=this;return n().call(s,be(be({},r),{},{vectorBucketName:s.vectorBucketName}))}async getIndex(r){var n=()=>super.getIndex,s=this;return n().call(s,s.vectorBucketName,r)}async deleteIndex(r){var n=()=>super.deleteIndex,s=this;return n().call(s,s.vectorBucketName,r)}index(r){return new bg(this.url,this.headers,this.vectorBucketName,r,this.fetch)}},bg=class extends yg{constructor(r,n,s,o,u){super(r,n,u),this.vectorBucketName=s,this.indexName=o}async putVectors(r){var n=()=>super.putVectors,s=this;return n().call(s,be(be({},r),{},{vectorBucketName:s.vectorBucketName,indexName:s.indexName}))}async getVectors(r){var n=()=>super.getVectors,s=this;return n().call(s,be(be({},r),{},{vectorBucketName:s.vectorBucketName,indexName:s.indexName}))}async listVectors(r={}){var n=()=>super.listVectors,s=this;return n().call(s,be(be({},r),{},{vectorBucketName:s.vectorBucketName,indexName:s.indexName}))}async queryVectors(r){var n=()=>super.queryVectors,s=this;return n().call(s,be(be({},r),{},{vectorBucketName:s.vectorBucketName,indexName:s.indexName}))}async deleteVectors(r){var n=()=>super.deleteVectors,s=this;return n().call(s,be(be({},r),{},{vectorBucketName:s.vectorBucketName,indexName:s.indexName}))}},_g=class extends mg{constructor(r,n={},s,o){super(r,n,s,o)}from(r){return new hg(this.url,this.headers,r,this.fetch)}get vectors(){return new xg(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new pg(this.url+"/iceberg",this.headers,this.fetch)}};const zh="2.95.3",Zr=30*1e3,Yl=3,Ml=Yl*Zr,kg="http://localhost:9999",jg="supabase.auth.token",Sg={"X-Client-Info":`gotrue-js/${zh}`},Xl="X-Supabase-Api-Version",Bh={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Ng=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Eg=600*1e3;class na extends Error{constructor(n,s,o){super(n),this.__isAuthError=!0,this.name="AuthError",this.status=s,this.code=o}}function de(r){return typeof r=="object"&&r!==null&&"__isAuthError"in r}class Cg extends na{constructor(n,s,o){super(n,s,o),this.name="AuthApiError",this.status=s,this.code=o}}function Tg(r){return de(r)&&r.name==="AuthApiError"}class xr extends na{constructor(n,s){super(n),this.name="AuthUnknownError",this.originalError=s}}class Tn extends na{constructor(n,s,o,u){super(n,o,u),this.name=s,this.status=o}}class $t extends Tn{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Ul(r){return de(r)&&r.name==="AuthSessionMissingError"}class Gr extends Tn{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Si extends Tn{constructor(n){super(n,"AuthInvalidCredentialsError",400,void 0)}}class Ni extends Tn{constructor(n,s=null){super(n,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=s}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Ag(r){return de(r)&&r.name==="AuthImplicitGrantRedirectError"}class ph extends Tn{constructor(n,s=null){super(n,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=s}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Ig extends Tn{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class Zl extends Tn{constructor(n,s){super(n,"AuthRetryableFetchError",s,void 0)}}function Fl(r){return de(r)&&r.name==="AuthRetryableFetchError"}class gh extends Tn{constructor(n,s,o){super(n,"AuthWeakPasswordError",s,"weak_password"),this.reasons=o}}class eu extends Tn{constructor(n){super(n,"AuthInvalidJwtError",400,"invalid_jwt")}}const Ci="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),yh=` 	
\r=`.split(""),Rg=(()=>{const r=new Array(128);for(let n=0;n<r.length;n+=1)r[n]=-1;for(let n=0;n<yh.length;n+=1)r[yh[n].charCodeAt(0)]=-2;for(let n=0;n<Ci.length;n+=1)r[Ci[n].charCodeAt(0)]=n;return r})();function vh(r,n,s){if(r!==null)for(n.queue=n.queue<<8|r,n.queuedBits+=8;n.queuedBits>=6;){const o=n.queue>>n.queuedBits-6&63;s(Ci[o]),n.queuedBits-=6}else if(n.queuedBits>0)for(n.queue=n.queue<<6-n.queuedBits,n.queuedBits=6;n.queuedBits>=6;){const o=n.queue>>n.queuedBits-6&63;s(Ci[o]),n.queuedBits-=6}}function Wh(r,n,s){const o=Rg[r];if(o>-1)for(n.queue=n.queue<<6|o,n.queuedBits+=6;n.queuedBits>=8;)s(n.queue>>n.queuedBits-8&255),n.queuedBits-=8;else{if(o===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(r)}"`)}}function xh(r){const n=[],s=f=>{n.push(String.fromCodePoint(f))},o={utf8seq:0,codepoint:0},u={queue:0,queuedBits:0},d=f=>{Dg(f,o,s)};for(let f=0;f<r.length;f+=1)Wh(r.charCodeAt(f),u,d);return n.join("")}function Og(r,n){if(r<=127){n(r);return}else if(r<=2047){n(192|r>>6),n(128|r&63);return}else if(r<=65535){n(224|r>>12),n(128|r>>6&63),n(128|r&63);return}else if(r<=1114111){n(240|r>>18),n(128|r>>12&63),n(128|r>>6&63),n(128|r&63);return}throw new Error(`Unrecognized Unicode codepoint: ${r.toString(16)}`)}function Pg(r,n){for(let s=0;s<r.length;s+=1){let o=r.charCodeAt(s);if(o>55295&&o<=56319){const u=(o-55296)*1024&65535;o=(r.charCodeAt(s+1)-56320&65535|u)+65536,s+=1}Og(o,n)}}function Dg(r,n,s){if(n.utf8seq===0){if(r<=127){s(r);return}for(let o=1;o<6;o+=1)if((r>>7-o&1)===0){n.utf8seq=o;break}if(n.utf8seq===2)n.codepoint=r&31;else if(n.utf8seq===3)n.codepoint=r&15;else if(n.utf8seq===4)n.codepoint=r&7;else throw new Error("Invalid UTF-8 sequence");n.utf8seq-=1}else if(n.utf8seq>0){if(r<=127)throw new Error("Invalid UTF-8 sequence");n.codepoint=n.codepoint<<6|r&63,n.utf8seq-=1,n.utf8seq===0&&s(n.codepoint)}}function ns(r){const n=[],s={queue:0,queuedBits:0},o=u=>{n.push(u)};for(let u=0;u<r.length;u+=1)Wh(r.charCodeAt(u),s,o);return new Uint8Array(n)}function Lg(r){const n=[];return Pg(r,s=>n.push(s)),new Uint8Array(n)}function wr(r){const n=[],s={queue:0,queuedBits:0},o=u=>{n.push(u)};return r.forEach(u=>vh(u,s,o)),vh(null,s,o),n.join("")}function $g(r){return Math.round(Date.now()/1e3)+r}function Mg(){return Symbol("auth-callback")}const mt=()=>typeof window<"u"&&typeof document<"u",pr={tested:!1,writable:!1},qh=()=>{if(!mt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(pr.tested)return pr.writable;const r=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(r,r),globalThis.localStorage.removeItem(r),pr.tested=!0,pr.writable=!0}catch{pr.tested=!0,pr.writable=!1}return pr.writable};function Ug(r){const n={},s=new URL(r);if(s.hash&&s.hash[0]==="#")try{new URLSearchParams(s.hash.substring(1)).forEach((u,d)=>{n[d]=u})}catch{}return s.searchParams.forEach((o,u)=>{n[u]=o}),n}const Vh=r=>r?(...n)=>r(...n):(...n)=>fetch(...n),Fg=r=>typeof r=="object"&&r!==null&&"status"in r&&"ok"in r&&"json"in r&&typeof r.json=="function",es=async(r,n,s)=>{await r.setItem(n,JSON.stringify(s))},gr=async(r,n)=>{const s=await r.getItem(n);if(!s)return null;try{return JSON.parse(s)}catch{return s}},ft=async(r,n)=>{await r.removeItem(n)};class $i{constructor(){this.promise=new $i.promiseConstructor((n,s)=>{this.resolve=n,this.reject=s})}}$i.promiseConstructor=Promise;function Ei(r){const n=r.split(".");if(n.length!==3)throw new eu("Invalid JWT structure");for(let o=0;o<n.length;o++)if(!Ng.test(n[o]))throw new eu("JWT not in base64url format");return{header:JSON.parse(xh(n[0])),payload:JSON.parse(xh(n[1])),signature:ns(n[2]),raw:{header:n[0],payload:n[1]}}}async function zg(r){return await new Promise(n=>{setTimeout(()=>n(null),r)})}function Bg(r,n){return new Promise((o,u)=>{(async()=>{for(let d=0;d<1/0;d++)try{const f=await r(d);if(!n(d,null,f)){o(f);return}}catch(f){if(!n(d,f)){u(f);return}}})()})}function Wg(r){return("0"+r.toString(16)).substr(-2)}function qg(){const n=new Uint32Array(56);if(typeof crypto>"u"){const s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",o=s.length;let u="";for(let d=0;d<56;d++)u+=s.charAt(Math.floor(Math.random()*o));return u}return crypto.getRandomValues(n),Array.from(n,Wg).join("")}async function Vg(r){const s=new TextEncoder().encode(r),o=await crypto.subtle.digest("SHA-256",s),u=new Uint8Array(o);return Array.from(u).map(d=>String.fromCharCode(d)).join("")}async function Hg(r){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),r;const s=await Vg(r);return btoa(s).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Kr(r,n,s=!1){const o=qg();let u=o;s&&(u+="/PASSWORD_RECOVERY"),await es(r,`${n}-code-verifier`,u);const d=await Hg(o);return[d,o===d?"plain":"s256"]}const Gg=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Kg(r){const n=r.headers.get(Xl);if(!n||!n.match(Gg))return null;try{return new Date(`${n}T00:00:00.0Z`)}catch{return null}}function Jg(r){if(!r)throw new Error("Missing exp claim");const n=Math.floor(Date.now()/1e3);if(r<=n)throw new Error("JWT has expired")}function Qg(r){switch(r){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Yg=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Jr(r){if(!Yg.test(r))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function zl(){const r={};return new Proxy(r,{get:(n,s)=>{if(s==="__isUserNotAvailableProxy")return!0;if(typeof s=="symbol"){const o=s.toString();if(o==="Symbol(Symbol.toPrimitive)"||o==="Symbol(Symbol.toStringTag)"||o==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${s}" property of the session object is not supported. Please use getUser() instead.`)},set:(n,s)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${s}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(n,s)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${s}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Xg(r,n){return new Proxy(r,{get:(s,o,u)=>{if(o==="__isInsecureUserWarningProxy")return!0;if(typeof o=="symbol"){const d=o.toString();if(d==="Symbol(Symbol.toPrimitive)"||d==="Symbol(Symbol.toStringTag)"||d==="Symbol(util.inspect.custom)"||d==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(s,o,u)}return!n.value&&typeof o=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),n.value=!0),Reflect.get(s,o,u)}})}function wh(r){return JSON.parse(JSON.stringify(r))}const yr=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),Zg=[502,503,504];async function bh(r){var n;if(!Fg(r))throw new Zl(yr(r),0);if(Zg.includes(r.status))throw new Zl(yr(r),r.status);let s;try{s=await r.json()}catch(d){throw new xr(yr(d),d)}let o;const u=Kg(r);if(u&&u.getTime()>=Bh["2024-01-01"].timestamp&&typeof s=="object"&&s&&typeof s.code=="string"?o=s.code:typeof s=="object"&&s&&typeof s.error_code=="string"&&(o=s.error_code),o){if(o==="weak_password")throw new gh(yr(s),r.status,((n=s.weak_password)===null||n===void 0?void 0:n.reasons)||[]);if(o==="session_not_found")throw new $t}else if(typeof s=="object"&&s&&typeof s.weak_password=="object"&&s.weak_password&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.reasons.reduce((d,f)=>d&&typeof f=="string",!0))throw new gh(yr(s),r.status,s.weak_password.reasons);throw new Cg(yr(s),r.status||500,o)}const e0=(r,n,s,o)=>{const u={method:r,headers:(n==null?void 0:n.headers)||{}};return r==="GET"?u:(u.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},n==null?void 0:n.headers),u.body=JSON.stringify(o),Object.assign(Object.assign({},u),s))};async function ye(r,n,s,o){var u;const d=Object.assign({},o==null?void 0:o.headers);d[Xl]||(d[Xl]=Bh["2024-01-01"].name),o!=null&&o.jwt&&(d.Authorization=`Bearer ${o.jwt}`);const f=(u=o==null?void 0:o.query)!==null&&u!==void 0?u:{};o!=null&&o.redirectTo&&(f.redirect_to=o.redirectTo);const m=Object.keys(f).length?"?"+new URLSearchParams(f).toString():"",p=await t0(r,n,s+m,{headers:d,noResolveJson:o==null?void 0:o.noResolveJson},{},o==null?void 0:o.body);return o!=null&&o.xform?o==null?void 0:o.xform(p):{data:Object.assign({},p),error:null}}async function t0(r,n,s,o,u,d){const f=e0(n,o,u,d);let m;try{m=await r(s,Object.assign({},f))}catch(p){throw console.error(p),new Zl(yr(p),0)}if(m.ok||await bh(m),o!=null&&o.noResolveJson)return m;try{return await m.json()}catch(p){await bh(p)}}function en(r){var n;let s=null;s0(r)&&(s=Object.assign({},r),r.expires_at||(s.expires_at=$g(r.expires_in)));const o=(n=r.user)!==null&&n!==void 0?n:r;return{data:{session:s,user:o},error:null}}function _h(r){const n=en(r);return!n.error&&r.weak_password&&typeof r.weak_password=="object"&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.message&&typeof r.weak_password.message=="string"&&r.weak_password.reasons.reduce((s,o)=>s&&typeof o=="string",!0)&&(n.data.weak_password=r.weak_password),n}function Zn(r){var n;return{data:{user:(n=r.user)!==null&&n!==void 0?n:r},error:null}}function n0(r){return{data:r,error:null}}function r0(r){const{action_link:n,email_otp:s,hashed_token:o,redirect_to:u,verification_type:d}=r,f=Pi(r,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),m={action_link:n,email_otp:s,hashed_token:o,redirect_to:u,verification_type:d},p=Object.assign({},f);return{data:{properties:m,user:p},error:null}}function kh(r){return r}function s0(r){return r.access_token&&r.refresh_token&&r.expires_in}const Bl=["global","local","others"];class a0{constructor({url:n="",headers:s={},fetch:o}){this.url=n,this.headers=s,this.fetch=Vh(o),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(n,s=Bl[0]){if(Bl.indexOf(s)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Bl.join(", ")}`);try{return await ye(this.fetch,"POST",`${this.url}/logout?scope=${s}`,{headers:this.headers,jwt:n,noResolveJson:!0}),{data:null,error:null}}catch(o){if(de(o))return{data:null,error:o};throw o}}async inviteUserByEmail(n,s={}){try{return await ye(this.fetch,"POST",`${this.url}/invite`,{body:{email:n,data:s.data},headers:this.headers,redirectTo:s.redirectTo,xform:Zn})}catch(o){if(de(o))return{data:{user:null},error:o};throw o}}async generateLink(n){try{const{options:s}=n,o=Pi(n,["options"]),u=Object.assign(Object.assign({},o),s);return"newEmail"in o&&(u.new_email=o==null?void 0:o.newEmail,delete u.newEmail),await ye(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:u,headers:this.headers,xform:r0,redirectTo:s==null?void 0:s.redirectTo})}catch(s){if(de(s))return{data:{properties:null,user:null},error:s};throw s}}async createUser(n){try{return await ye(this.fetch,"POST",`${this.url}/admin/users`,{body:n,headers:this.headers,xform:Zn})}catch(s){if(de(s))return{data:{user:null},error:s};throw s}}async listUsers(n){var s,o,u,d,f,m,p;try{const y={nextPage:null,lastPage:0,total:0},v=await ye(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(o=(s=n==null?void 0:n.page)===null||s===void 0?void 0:s.toString())!==null&&o!==void 0?o:"",per_page:(d=(u=n==null?void 0:n.perPage)===null||u===void 0?void 0:u.toString())!==null&&d!==void 0?d:""},xform:kh});if(v.error)throw v.error;const b=await v.json(),_=(f=v.headers.get("x-total-count"))!==null&&f!==void 0?f:0,w=(p=(m=v.headers.get("link"))===null||m===void 0?void 0:m.split(","))!==null&&p!==void 0?p:[];return w.length>0&&(w.forEach(T=>{const j=parseInt(T.split(";")[0].split("=")[1].substring(0,1)),E=JSON.parse(T.split(";")[1].split("=")[1]);y[`${E}Page`]=j}),y.total=parseInt(_)),{data:Object.assign(Object.assign({},b),y),error:null}}catch(y){if(de(y))return{data:{users:[]},error:y};throw y}}async getUserById(n){Jr(n);try{return await ye(this.fetch,"GET",`${this.url}/admin/users/${n}`,{headers:this.headers,xform:Zn})}catch(s){if(de(s))return{data:{user:null},error:s};throw s}}async updateUserById(n,s){Jr(n);try{return await ye(this.fetch,"PUT",`${this.url}/admin/users/${n}`,{body:s,headers:this.headers,xform:Zn})}catch(o){if(de(o))return{data:{user:null},error:o};throw o}}async deleteUser(n,s=!1){Jr(n);try{return await ye(this.fetch,"DELETE",`${this.url}/admin/users/${n}`,{headers:this.headers,body:{should_soft_delete:s},xform:Zn})}catch(o){if(de(o))return{data:{user:null},error:o};throw o}}async _listFactors(n){Jr(n.userId);try{const{data:s,error:o}=await ye(this.fetch,"GET",`${this.url}/admin/users/${n.userId}/factors`,{headers:this.headers,xform:u=>({data:{factors:u},error:null})});return{data:s,error:o}}catch(s){if(de(s))return{data:null,error:s};throw s}}async _deleteFactor(n){Jr(n.userId),Jr(n.id);try{return{data:await ye(this.fetch,"DELETE",`${this.url}/admin/users/${n.userId}/factors/${n.id}`,{headers:this.headers}),error:null}}catch(s){if(de(s))return{data:null,error:s};throw s}}async _listOAuthClients(n){var s,o,u,d,f,m,p;try{const y={nextPage:null,lastPage:0,total:0},v=await ye(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(o=(s=n==null?void 0:n.page)===null||s===void 0?void 0:s.toString())!==null&&o!==void 0?o:"",per_page:(d=(u=n==null?void 0:n.perPage)===null||u===void 0?void 0:u.toString())!==null&&d!==void 0?d:""},xform:kh});if(v.error)throw v.error;const b=await v.json(),_=(f=v.headers.get("x-total-count"))!==null&&f!==void 0?f:0,w=(p=(m=v.headers.get("link"))===null||m===void 0?void 0:m.split(","))!==null&&p!==void 0?p:[];return w.length>0&&(w.forEach(T=>{const j=parseInt(T.split(";")[0].split("=")[1].substring(0,1)),E=JSON.parse(T.split(";")[1].split("=")[1]);y[`${E}Page`]=j}),y.total=parseInt(_)),{data:Object.assign(Object.assign({},b),y),error:null}}catch(y){if(de(y))return{data:{clients:[]},error:y};throw y}}async _createOAuthClient(n){try{return await ye(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:n,headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(de(s))return{data:null,error:s};throw s}}async _getOAuthClient(n){try{return await ye(this.fetch,"GET",`${this.url}/admin/oauth/clients/${n}`,{headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(de(s))return{data:null,error:s};throw s}}async _updateOAuthClient(n,s){try{return await ye(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${n}`,{body:s,headers:this.headers,xform:o=>({data:o,error:null})})}catch(o){if(de(o))return{data:null,error:o};throw o}}async _deleteOAuthClient(n){try{return await ye(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${n}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(s){if(de(s))return{data:null,error:s};throw s}}async _regenerateOAuthClientSecret(n){try{return await ye(this.fetch,"POST",`${this.url}/admin/oauth/clients/${n}/regenerate_secret`,{headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(de(s))return{data:null,error:s};throw s}}}function jh(r={}){return{getItem:n=>r[n]||null,setItem:(n,s)=>{r[n]=s},removeItem:n=>{delete r[n]}}}const Qr={debug:!!(globalThis&&qh()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Hh extends Error{constructor(n){super(n),this.isAcquireTimeout=!0}}class i0 extends Hh{}async function o0(r,n,s){Qr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",r,n);const o=new globalThis.AbortController;return n>0&&setTimeout(()=>{o.abort(),Qr.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",r)},n),await Promise.resolve().then(()=>globalThis.navigator.locks.request(r,n===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:o.signal},async u=>{if(u){Qr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",r,u.name);try{return await s()}finally{Qr.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",r,u.name)}}else{if(n===0)throw Qr.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",r),new i0(`Acquiring an exclusive Navigator LockManager lock "${r}" immediately failed`);if(Qr.debug)try{const d=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(d,null,"  "))}catch(d){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",d)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await s()}}))}function l0(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function Gh(r){if(!/^0x[a-fA-F0-9]{40}$/.test(r))throw new Error(`@supabase/auth-js: Address "${r}" is invalid.`);return r.toLowerCase()}function u0(r){return parseInt(r,16)}function c0(r){const n=new TextEncoder().encode(r);return"0x"+Array.from(n,o=>o.toString(16).padStart(2,"0")).join("")}function d0(r){var n;const{chainId:s,domain:o,expirationTime:u,issuedAt:d=new Date,nonce:f,notBefore:m,requestId:p,resources:y,scheme:v,uri:b,version:_}=r;{if(!Number.isInteger(s))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${s}`);if(!o)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(f&&f.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${f}`);if(!b)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(_!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${_}`);if(!((n=r.statement)===null||n===void 0)&&n.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${r.statement}`)}const w=Gh(r.address),T=v?`${v}://${o}`:o,j=r.statement?`${r.statement}
`:"",E=`${T} wants you to sign in with your Ethereum account:
${w}

${j}`;let D=`URI: ${b}
Version: ${_}
Chain ID: ${s}${f?`
Nonce: ${f}`:""}
Issued At: ${d.toISOString()}`;if(u&&(D+=`
Expiration Time: ${u.toISOString()}`),m&&(D+=`
Not Before: ${m.toISOString()}`),p&&(D+=`
Request ID: ${p}`),y){let V=`
Resources:`;for(const z of y){if(!z||typeof z!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${z}`);V+=`
- ${z}`}D+=V}return`${E}
${D}`}class nt extends Error{constructor({message:n,code:s,cause:o,name:u}){var d;super(n,{cause:o}),this.__isWebAuthnError=!0,this.name=(d=u??(o instanceof Error?o.name:void 0))!==null&&d!==void 0?d:"Unknown Error",this.code=s}}class Ti extends nt{constructor(n,s){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s,message:n}),this.name="WebAuthnUnknownError",this.originalError=s}}function h0({error:r,options:n}){var s,o,u;const{publicKey:d}=n;if(!d)throw Error("options was missing required publicKey property");if(r.name==="AbortError"){if(n.signal instanceof AbortSignal)return new nt({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:r})}else if(r.name==="ConstraintError"){if(((s=d.authenticatorSelection)===null||s===void 0?void 0:s.requireResidentKey)===!0)return new nt({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:r});if(n.mediation==="conditional"&&((o=d.authenticatorSelection)===null||o===void 0?void 0:o.userVerification)==="required")return new nt({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:r});if(((u=d.authenticatorSelection)===null||u===void 0?void 0:u.userVerification)==="required")return new nt({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:r})}else{if(r.name==="InvalidStateError")return new nt({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:r});if(r.name==="NotAllowedError")return new nt({message:r.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r});if(r.name==="NotSupportedError")return d.pubKeyCredParams.filter(m=>m.type==="public-key").length===0?new nt({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:r}):new nt({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:r});if(r.name==="SecurityError"){const f=window.location.hostname;if(Kh(f)){if(d.rp.id!==f)return new nt({message:`The RP ID "${d.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:r})}else return new nt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:r})}else if(r.name==="TypeError"){if(d.user.id.byteLength<1||d.user.id.byteLength>64)return new nt({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:r})}else if(r.name==="UnknownError")return new nt({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:r})}return new nt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r})}function f0({error:r,options:n}){const{publicKey:s}=n;if(!s)throw Error("options was missing required publicKey property");if(r.name==="AbortError"){if(n.signal instanceof AbortSignal)return new nt({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:r})}else{if(r.name==="NotAllowedError")return new nt({message:r.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r});if(r.name==="SecurityError"){const o=window.location.hostname;if(Kh(o)){if(s.rpId!==o)return new nt({message:`The RP ID "${s.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:r})}else return new nt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:r})}else if(r.name==="UnknownError")return new nt({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:r})}return new nt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r})}class m0{createNewAbortSignal(){if(this.controller){const s=new Error("Cancelling existing WebAuthn API call for new one");s.name="AbortError",this.controller.abort(s)}const n=new AbortController;return this.controller=n,n.signal}cancelCeremony(){if(this.controller){const n=new Error("Manually cancelling existing WebAuthn API call");n.name="AbortError",this.controller.abort(n),this.controller=void 0}}}const p0=new m0;function g0(r){if(!r)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(r);const{challenge:n,user:s,excludeCredentials:o}=r,u=Pi(r,["challenge","user","excludeCredentials"]),d=ns(n).buffer,f=Object.assign(Object.assign({},s),{id:ns(s.id).buffer}),m=Object.assign(Object.assign({},u),{challenge:d,user:f});if(o&&o.length>0){m.excludeCredentials=new Array(o.length);for(let p=0;p<o.length;p++){const y=o[p];m.excludeCredentials[p]=Object.assign(Object.assign({},y),{id:ns(y.id).buffer,type:y.type||"public-key",transports:y.transports})}}return m}function y0(r){if(!r)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(r);const{challenge:n,allowCredentials:s}=r,o=Pi(r,["challenge","allowCredentials"]),u=ns(n).buffer,d=Object.assign(Object.assign({},o),{challenge:u});if(s&&s.length>0){d.allowCredentials=new Array(s.length);for(let f=0;f<s.length;f++){const m=s[f];d.allowCredentials[f]=Object.assign(Object.assign({},m),{id:ns(m.id).buffer,type:m.type||"public-key",transports:m.transports})}}return d}function v0(r){var n;if("toJSON"in r&&typeof r.toJSON=="function")return r.toJSON();const s=r;return{id:r.id,rawId:r.id,response:{attestationObject:wr(new Uint8Array(r.response.attestationObject)),clientDataJSON:wr(new Uint8Array(r.response.clientDataJSON))},type:"public-key",clientExtensionResults:r.getClientExtensionResults(),authenticatorAttachment:(n=s.authenticatorAttachment)!==null&&n!==void 0?n:void 0}}function x0(r){var n;if("toJSON"in r&&typeof r.toJSON=="function")return r.toJSON();const s=r,o=r.getClientExtensionResults(),u=r.response;return{id:r.id,rawId:r.id,response:{authenticatorData:wr(new Uint8Array(u.authenticatorData)),clientDataJSON:wr(new Uint8Array(u.clientDataJSON)),signature:wr(new Uint8Array(u.signature)),userHandle:u.userHandle?wr(new Uint8Array(u.userHandle)):void 0},type:"public-key",clientExtensionResults:o,authenticatorAttachment:(n=s.authenticatorAttachment)!==null&&n!==void 0?n:void 0}}function Kh(r){return r==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(r)}function Sh(){var r,n;return!!(mt()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((r=navigator==null?void 0:navigator.credentials)===null||r===void 0?void 0:r.create)=="function"&&typeof((n=navigator==null?void 0:navigator.credentials)===null||n===void 0?void 0:n.get)=="function")}async function w0(r){try{const n=await navigator.credentials.create(r);return n?n instanceof PublicKeyCredential?{data:n,error:null}:{data:null,error:new Ti("Browser returned unexpected credential type",n)}:{data:null,error:new Ti("Empty credential response",n)}}catch(n){return{data:null,error:h0({error:n,options:r})}}}async function b0(r){try{const n=await navigator.credentials.get(r);return n?n instanceof PublicKeyCredential?{data:n,error:null}:{data:null,error:new Ti("Browser returned unexpected credential type",n)}:{data:null,error:new Ti("Empty credential response",n)}}catch(n){return{data:null,error:f0({error:n,options:r})}}}const _0={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},k0={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Ai(...r){const n=u=>u!==null&&typeof u=="object"&&!Array.isArray(u),s=u=>u instanceof ArrayBuffer||ArrayBuffer.isView(u),o={};for(const u of r)if(u)for(const d in u){const f=u[d];if(f!==void 0)if(Array.isArray(f))o[d]=f;else if(s(f))o[d]=f;else if(n(f)){const m=o[d];n(m)?o[d]=Ai(m,f):o[d]=Ai(f)}else o[d]=f}return o}function j0(r,n){return Ai(_0,r,n||{})}function S0(r,n){return Ai(k0,r,n||{})}class N0{constructor(n){this.client=n,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(n){return this.client.mfa.enroll(Object.assign(Object.assign({},n),{factorType:"webauthn"}))}async _challenge({factorId:n,webauthn:s,friendlyName:o,signal:u},d){var f;try{const{data:m,error:p}=await this.client.mfa.challenge({factorId:n,webauthn:s});if(!m)return{data:null,error:p};const y=u??p0.createNewAbortSignal();if(m.webauthn.type==="create"){const{user:v}=m.webauthn.credential_options.publicKey;if(!v.name){const b=o;if(b)v.name=`${v.id}:${b}`;else{const w=(await this.client.getUser()).data.user,T=((f=w==null?void 0:w.user_metadata)===null||f===void 0?void 0:f.name)||(w==null?void 0:w.email)||(w==null?void 0:w.id)||"User";v.name=`${v.id}:${T}`}}v.displayName||(v.displayName=v.name)}switch(m.webauthn.type){case"create":{const v=j0(m.webauthn.credential_options.publicKey,d==null?void 0:d.create),{data:b,error:_}=await w0({publicKey:v,signal:y});return b?{data:{factorId:n,challengeId:m.id,webauthn:{type:m.webauthn.type,credential_response:b}},error:null}:{data:null,error:_}}case"request":{const v=S0(m.webauthn.credential_options.publicKey,d==null?void 0:d.request),{data:b,error:_}=await b0(Object.assign(Object.assign({},m.webauthn.credential_options),{publicKey:v,signal:y}));return b?{data:{factorId:n,challengeId:m.id,webauthn:{type:m.webauthn.type,credential_response:b}},error:null}:{data:null,error:_}}}}catch(m){return de(m)?{data:null,error:m}:{data:null,error:new xr("Unexpected error in challenge",m)}}}async _verify({challengeId:n,factorId:s,webauthn:o}){return this.client.mfa.verify({factorId:s,challengeId:n,webauthn:o})}async _authenticate({factorId:n,webauthn:{rpId:s=typeof window<"u"?window.location.hostname:void 0,rpOrigins:o=typeof window<"u"?[window.location.origin]:void 0,signal:u}={}},d){if(!s)return{data:null,error:new na("rpId is required for WebAuthn authentication")};try{if(!Sh())return{data:null,error:new xr("Browser does not support WebAuthn",null)};const{data:f,error:m}=await this.challenge({factorId:n,webauthn:{rpId:s,rpOrigins:o},signal:u},{request:d});if(!f)return{data:null,error:m};const{webauthn:p}=f;return this._verify({factorId:n,challengeId:f.challengeId,webauthn:{type:p.type,rpId:s,rpOrigins:o,credential_response:p.credential_response}})}catch(f){return de(f)?{data:null,error:f}:{data:null,error:new xr("Unexpected error in authenticate",f)}}}async _register({friendlyName:n,webauthn:{rpId:s=typeof window<"u"?window.location.hostname:void 0,rpOrigins:o=typeof window<"u"?[window.location.origin]:void 0,signal:u}={}},d){if(!s)return{data:null,error:new na("rpId is required for WebAuthn registration")};try{if(!Sh())return{data:null,error:new xr("Browser does not support WebAuthn",null)};const{data:f,error:m}=await this._enroll({friendlyName:n});if(!f)return await this.client.mfa.listFactors().then(v=>{var b;return(b=v.data)===null||b===void 0?void 0:b.all.find(_=>_.factor_type==="webauthn"&&_.friendly_name===n&&_.status!=="unverified")}).then(v=>v?this.client.mfa.unenroll({factorId:v==null?void 0:v.id}):void 0),{data:null,error:m};const{data:p,error:y}=await this._challenge({factorId:f.id,friendlyName:f.friendly_name,webauthn:{rpId:s,rpOrigins:o},signal:u},{create:d});return p?this._verify({factorId:f.id,challengeId:p.challengeId,webauthn:{rpId:s,rpOrigins:o,type:p.webauthn.type,credential_response:p.webauthn.credential_response}}):{data:null,error:y}}catch(f){return de(f)?{data:null,error:f}:{data:null,error:new xr("Unexpected error in register",f)}}}}l0();const E0={url:kg,storageKey:jg,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Sg,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function Nh(r,n,s){return await s()}const Yr={};class ra{get jwks(){var n,s;return(s=(n=Yr[this.storageKey])===null||n===void 0?void 0:n.jwks)!==null&&s!==void 0?s:{keys:[]}}set jwks(n){Yr[this.storageKey]=Object.assign(Object.assign({},Yr[this.storageKey]),{jwks:n})}get jwks_cached_at(){var n,s;return(s=(n=Yr[this.storageKey])===null||n===void 0?void 0:n.cachedAt)!==null&&s!==void 0?s:Number.MIN_SAFE_INTEGER}set jwks_cached_at(n){Yr[this.storageKey]=Object.assign(Object.assign({},Yr[this.storageKey]),{cachedAt:n})}constructor(n){var s,o,u;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const d=Object.assign(Object.assign({},E0),n);if(this.storageKey=d.storageKey,this.instanceID=(s=ra.nextInstanceID[this.storageKey])!==null&&s!==void 0?s:0,ra.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!d.debug,typeof d.debug=="function"&&(this.logger=d.debug),this.instanceID>0&&mt()){const f=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(f),this.logDebugMessages&&console.trace(f)}if(this.persistSession=d.persistSession,this.autoRefreshToken=d.autoRefreshToken,this.admin=new a0({url:d.url,headers:d.headers,fetch:d.fetch}),this.url=d.url,this.headers=d.headers,this.fetch=Vh(d.fetch),this.lock=d.lock||Nh,this.detectSessionInUrl=d.detectSessionInUrl,this.flowType=d.flowType,this.hasCustomAuthorizationHeader=d.hasCustomAuthorizationHeader,this.throwOnError=d.throwOnError,this.lockAcquireTimeout=d.lockAcquireTimeout,d.lock?this.lock=d.lock:this.persistSession&&mt()&&(!((o=globalThis==null?void 0:globalThis.navigator)===null||o===void 0)&&o.locks)?this.lock=o0:this.lock=Nh,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new N0(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(d.storage?this.storage=d.storage:qh()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=jh(this.memoryStorage)),d.userStorage&&(this.userStorage=d.userStorage)):(this.memoryStorage={},this.storage=jh(this.memoryStorage)),mt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(f){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",f)}(u=this.broadcastChannel)===null||u===void 0||u.addEventListener("message",async f=>{this._debug("received broadcast notification from other tab or client",f);try{await this._notifyAllSubscribers(f.data.event,f.data.session,!1)}catch(m){this._debug("#broadcastChannel","error",m)}})}this.initialize().catch(f=>{this._debug("#initialize()","error",f)})}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(n){if(this.throwOnError&&n&&n.error)throw n.error;return n}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${zh}) ${new Date().toISOString()}`}_debug(...n){return this.logDebugMessages&&this.logger(this._logPrefix(),...n),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var n;try{let s={},o="none";if(mt()&&(s=Ug(window.location.href),this._isImplicitGrantCallback(s)?o="implicit":await this._isPKCECallback(s)&&(o="pkce")),mt()&&this.detectSessionInUrl&&o!=="none"){const{data:u,error:d}=await this._getSessionFromURL(s,o);if(d){if(this._debug("#_initialize()","error detecting session from URL",d),Ag(d)){const p=(n=d.details)===null||n===void 0?void 0:n.code;if(p==="identity_already_exists"||p==="identity_not_found"||p==="single_identity_not_deletable")return{error:d}}return{error:d}}const{session:f,redirectType:m}=u;return this._debug("#_initialize()","detected session in URL",f,"redirect type",m),await this._saveSession(f),setTimeout(async()=>{m==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",f):await this._notifyAllSubscribers("SIGNED_IN",f)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(s){return de(s)?this._returnResult({error:s}):this._returnResult({error:new xr("Unexpected error during initialization",s)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(n){var s,o,u;try{const d=await ye(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(o=(s=n==null?void 0:n.options)===null||s===void 0?void 0:s.data)!==null&&o!==void 0?o:{},gotrue_meta_security:{captcha_token:(u=n==null?void 0:n.options)===null||u===void 0?void 0:u.captchaToken}},xform:en}),{data:f,error:m}=d;if(m||!f)return this._returnResult({data:{user:null,session:null},error:m});const p=f.session,y=f.user;return f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",p)),this._returnResult({data:{user:y,session:p},error:null})}catch(d){if(de(d))return this._returnResult({data:{user:null,session:null},error:d});throw d}}async signUp(n){var s,o,u;try{let d;if("email"in n){const{email:v,password:b,options:_}=n;let w=null,T=null;this.flowType==="pkce"&&([w,T]=await Kr(this.storage,this.storageKey)),d=await ye(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:_==null?void 0:_.emailRedirectTo,body:{email:v,password:b,data:(s=_==null?void 0:_.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:_==null?void 0:_.captchaToken},code_challenge:w,code_challenge_method:T},xform:en})}else if("phone"in n){const{phone:v,password:b,options:_}=n;d=await ye(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:v,password:b,data:(o=_==null?void 0:_.data)!==null&&o!==void 0?o:{},channel:(u=_==null?void 0:_.channel)!==null&&u!==void 0?u:"sms",gotrue_meta_security:{captcha_token:_==null?void 0:_.captchaToken}},xform:en})}else throw new Si("You must provide either an email or phone number and a password");const{data:f,error:m}=d;if(m||!f)return await ft(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:m});const p=f.session,y=f.user;return f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",p)),this._returnResult({data:{user:y,session:p},error:null})}catch(d){if(await ft(this.storage,`${this.storageKey}-code-verifier`),de(d))return this._returnResult({data:{user:null,session:null},error:d});throw d}}async signInWithPassword(n){try{let s;if("email"in n){const{email:d,password:f,options:m}=n;s=await ye(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:d,password:f,gotrue_meta_security:{captcha_token:m==null?void 0:m.captchaToken}},xform:_h})}else if("phone"in n){const{phone:d,password:f,options:m}=n;s=await ye(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:d,password:f,gotrue_meta_security:{captcha_token:m==null?void 0:m.captchaToken}},xform:_h})}else throw new Si("You must provide either an email or phone number and a password");const{data:o,error:u}=s;if(u)return this._returnResult({data:{user:null,session:null},error:u});if(!o||!o.session||!o.user){const d=new Gr;return this._returnResult({data:{user:null,session:null},error:d})}return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),this._returnResult({data:Object.assign({user:o.user,session:o.session},o.weak_password?{weakPassword:o.weak_password}:null),error:u})}catch(s){if(de(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithOAuth(n){var s,o,u,d;return await this._handleProviderSignIn(n.provider,{redirectTo:(s=n.options)===null||s===void 0?void 0:s.redirectTo,scopes:(o=n.options)===null||o===void 0?void 0:o.scopes,queryParams:(u=n.options)===null||u===void 0?void 0:u.queryParams,skipBrowserRedirect:(d=n.options)===null||d===void 0?void 0:d.skipBrowserRedirect})}async exchangeCodeForSession(n){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(n))}async signInWithWeb3(n){const{chain:s}=n;switch(s){case"ethereum":return await this.signInWithEthereum(n);case"solana":return await this.signInWithSolana(n);default:throw new Error(`@supabase/auth-js: Unsupported chain "${s}"`)}}async signInWithEthereum(n){var s,o,u,d,f,m,p,y,v,b,_;let w,T;if("message"in n)w=n.message,T=n.signature;else{const{chain:j,wallet:E,statement:D,options:V}=n;let z;if(mt())if(typeof E=="object")z=E;else{const K=window;if("ethereum"in K&&typeof K.ethereum=="object"&&"request"in K.ethereum&&typeof K.ethereum.request=="function")z=K.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof E!="object"||!(V!=null&&V.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");z=E}const q=new URL((s=V==null?void 0:V.url)!==null&&s!==void 0?s:window.location.href),$=await z.request({method:"eth_requestAccounts"}).then(K=>K).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!$||$.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const M=Gh($[0]);let Y=(o=V==null?void 0:V.signInWithEthereum)===null||o===void 0?void 0:o.chainId;if(!Y){const K=await z.request({method:"eth_chainId"});Y=u0(K)}const re={domain:q.host,address:M,statement:D,uri:q.href,version:"1",chainId:Y,nonce:(u=V==null?void 0:V.signInWithEthereum)===null||u===void 0?void 0:u.nonce,issuedAt:(f=(d=V==null?void 0:V.signInWithEthereum)===null||d===void 0?void 0:d.issuedAt)!==null&&f!==void 0?f:new Date,expirationTime:(m=V==null?void 0:V.signInWithEthereum)===null||m===void 0?void 0:m.expirationTime,notBefore:(p=V==null?void 0:V.signInWithEthereum)===null||p===void 0?void 0:p.notBefore,requestId:(y=V==null?void 0:V.signInWithEthereum)===null||y===void 0?void 0:y.requestId,resources:(v=V==null?void 0:V.signInWithEthereum)===null||v===void 0?void 0:v.resources};w=d0(re),T=await z.request({method:"personal_sign",params:[c0(w),M]})}try{const{data:j,error:E}=await ye(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:w,signature:T},!((b=n.options)===null||b===void 0)&&b.captchaToken?{gotrue_meta_security:{captcha_token:(_=n.options)===null||_===void 0?void 0:_.captchaToken}}:null),xform:en});if(E)throw E;if(!j||!j.session||!j.user){const D=new Gr;return this._returnResult({data:{user:null,session:null},error:D})}return j.session&&(await this._saveSession(j.session),await this._notifyAllSubscribers("SIGNED_IN",j.session)),this._returnResult({data:Object.assign({},j),error:E})}catch(j){if(de(j))return this._returnResult({data:{user:null,session:null},error:j});throw j}}async signInWithSolana(n){var s,o,u,d,f,m,p,y,v,b,_,w;let T,j;if("message"in n)T=n.message,j=n.signature;else{const{chain:E,wallet:D,statement:V,options:z}=n;let q;if(mt())if(typeof D=="object")q=D;else{const M=window;if("solana"in M&&typeof M.solana=="object"&&("signIn"in M.solana&&typeof M.solana.signIn=="function"||"signMessage"in M.solana&&typeof M.solana.signMessage=="function"))q=M.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof D!="object"||!(z!=null&&z.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");q=D}const $=new URL((s=z==null?void 0:z.url)!==null&&s!==void 0?s:window.location.href);if("signIn"in q&&q.signIn){const M=await q.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},z==null?void 0:z.signInWithSolana),{version:"1",domain:$.host,uri:$.href}),V?{statement:V}:null));let Y;if(Array.isArray(M)&&M[0]&&typeof M[0]=="object")Y=M[0];else if(M&&typeof M=="object"&&"signedMessage"in M&&"signature"in M)Y=M;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in Y&&"signature"in Y&&(typeof Y.signedMessage=="string"||Y.signedMessage instanceof Uint8Array)&&Y.signature instanceof Uint8Array)T=typeof Y.signedMessage=="string"?Y.signedMessage:new TextDecoder().decode(Y.signedMessage),j=Y.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in q)||typeof q.signMessage!="function"||!("publicKey"in q)||typeof q!="object"||!q.publicKey||!("toBase58"in q.publicKey)||typeof q.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");T=[`${$.host} wants you to sign in with your Solana account:`,q.publicKey.toBase58(),...V?["",V,""]:[""],"Version: 1",`URI: ${$.href}`,`Issued At: ${(u=(o=z==null?void 0:z.signInWithSolana)===null||o===void 0?void 0:o.issuedAt)!==null&&u!==void 0?u:new Date().toISOString()}`,...!((d=z==null?void 0:z.signInWithSolana)===null||d===void 0)&&d.notBefore?[`Not Before: ${z.signInWithSolana.notBefore}`]:[],...!((f=z==null?void 0:z.signInWithSolana)===null||f===void 0)&&f.expirationTime?[`Expiration Time: ${z.signInWithSolana.expirationTime}`]:[],...!((m=z==null?void 0:z.signInWithSolana)===null||m===void 0)&&m.chainId?[`Chain ID: ${z.signInWithSolana.chainId}`]:[],...!((p=z==null?void 0:z.signInWithSolana)===null||p===void 0)&&p.nonce?[`Nonce: ${z.signInWithSolana.nonce}`]:[],...!((y=z==null?void 0:z.signInWithSolana)===null||y===void 0)&&y.requestId?[`Request ID: ${z.signInWithSolana.requestId}`]:[],...!((b=(v=z==null?void 0:z.signInWithSolana)===null||v===void 0?void 0:v.resources)===null||b===void 0)&&b.length?["Resources",...z.signInWithSolana.resources.map(Y=>`- ${Y}`)]:[]].join(`
`);const M=await q.signMessage(new TextEncoder().encode(T),"utf8");if(!M||!(M instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");j=M}}try{const{data:E,error:D}=await ye(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:T,signature:wr(j)},!((_=n.options)===null||_===void 0)&&_.captchaToken?{gotrue_meta_security:{captcha_token:(w=n.options)===null||w===void 0?void 0:w.captchaToken}}:null),xform:en});if(D)throw D;if(!E||!E.session||!E.user){const V=new Gr;return this._returnResult({data:{user:null,session:null},error:V})}return E.session&&(await this._saveSession(E.session),await this._notifyAllSubscribers("SIGNED_IN",E.session)),this._returnResult({data:Object.assign({},E),error:D})}catch(E){if(de(E))return this._returnResult({data:{user:null,session:null},error:E});throw E}}async _exchangeCodeForSession(n){const s=await gr(this.storage,`${this.storageKey}-code-verifier`),[o,u]=(s??"").split("/");try{if(!o&&this.flowType==="pkce")throw new Ig;const{data:d,error:f}=await ye(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:n,code_verifier:o},xform:en});if(await ft(this.storage,`${this.storageKey}-code-verifier`),f)throw f;if(!d||!d.session||!d.user){const m=new Gr;return this._returnResult({data:{user:null,session:null,redirectType:null},error:m})}return d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",d.session)),this._returnResult({data:Object.assign(Object.assign({},d),{redirectType:u??null}),error:f})}catch(d){if(await ft(this.storage,`${this.storageKey}-code-verifier`),de(d))return this._returnResult({data:{user:null,session:null,redirectType:null},error:d});throw d}}async signInWithIdToken(n){try{const{options:s,provider:o,token:u,access_token:d,nonce:f}=n,m=await ye(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:o,id_token:u,access_token:d,nonce:f,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},xform:en}),{data:p,error:y}=m;if(y)return this._returnResult({data:{user:null,session:null},error:y});if(!p||!p.session||!p.user){const v=new Gr;return this._returnResult({data:{user:null,session:null},error:v})}return p.session&&(await this._saveSession(p.session),await this._notifyAllSubscribers("SIGNED_IN",p.session)),this._returnResult({data:p,error:y})}catch(s){if(de(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithOtp(n){var s,o,u,d,f;try{if("email"in n){const{email:m,options:p}=n;let y=null,v=null;this.flowType==="pkce"&&([y,v]=await Kr(this.storage,this.storageKey));const{error:b}=await ye(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:m,data:(s=p==null?void 0:p.data)!==null&&s!==void 0?s:{},create_user:(o=p==null?void 0:p.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken},code_challenge:y,code_challenge_method:v},redirectTo:p==null?void 0:p.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:b})}if("phone"in n){const{phone:m,options:p}=n,{data:y,error:v}=await ye(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:m,data:(u=p==null?void 0:p.data)!==null&&u!==void 0?u:{},create_user:(d=p==null?void 0:p.shouldCreateUser)!==null&&d!==void 0?d:!0,gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken},channel:(f=p==null?void 0:p.channel)!==null&&f!==void 0?f:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:y==null?void 0:y.message_id},error:v})}throw new Si("You must provide either an email or phone number.")}catch(m){if(await ft(this.storage,`${this.storageKey}-code-verifier`),de(m))return this._returnResult({data:{user:null,session:null},error:m});throw m}}async verifyOtp(n){var s,o;try{let u,d;"options"in n&&(u=(s=n.options)===null||s===void 0?void 0:s.redirectTo,d=(o=n.options)===null||o===void 0?void 0:o.captchaToken);const{data:f,error:m}=await ye(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},n),{gotrue_meta_security:{captcha_token:d}}),redirectTo:u,xform:en});if(m)throw m;if(!f)throw new Error("An error occurred on token verification.");const p=f.session,y=f.user;return p!=null&&p.access_token&&(await this._saveSession(p),await this._notifyAllSubscribers(n.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",p)),this._returnResult({data:{user:y,session:p},error:null})}catch(u){if(de(u))return this._returnResult({data:{user:null,session:null},error:u});throw u}}async signInWithSSO(n){var s,o,u,d,f;try{let m=null,p=null;this.flowType==="pkce"&&([m,p]=await Kr(this.storage,this.storageKey));const y=await ye(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in n?{provider_id:n.providerId}:null),"domain"in n?{domain:n.domain}:null),{redirect_to:(o=(s=n.options)===null||s===void 0?void 0:s.redirectTo)!==null&&o!==void 0?o:void 0}),!((u=n==null?void 0:n.options)===null||u===void 0)&&u.captchaToken?{gotrue_meta_security:{captcha_token:n.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:m,code_challenge_method:p}),headers:this.headers,xform:n0});return!((d=y.data)===null||d===void 0)&&d.url&&mt()&&!(!((f=n.options)===null||f===void 0)&&f.skipBrowserRedirect)&&window.location.assign(y.data.url),this._returnResult(y)}catch(m){if(await ft(this.storage,`${this.storageKey}-code-verifier`),de(m))return this._returnResult({data:null,error:m});throw m}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async n=>{const{data:{session:s},error:o}=n;if(o)throw o;if(!s)throw new $t;const{error:u}=await ye(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:s.access_token});return this._returnResult({data:{user:null,session:null},error:u})})}catch(n){if(de(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async resend(n){try{const s=`${this.url}/resend`;if("email"in n){const{email:o,type:u,options:d}=n,{error:f}=await ye(this.fetch,"POST",s,{headers:this.headers,body:{email:o,type:u,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},redirectTo:d==null?void 0:d.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:f})}else if("phone"in n){const{phone:o,type:u,options:d}=n,{data:f,error:m}=await ye(this.fetch,"POST",s,{headers:this.headers,body:{phone:o,type:u,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:f==null?void 0:f.message_id},error:m})}throw new Si("You must provide either an email or phone number and a type")}catch(s){if(de(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async s=>s))}async _acquireLock(n,s){this._debug("#_acquireLock","begin",n);try{if(this.lockAcquired){const o=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),u=(async()=>(await o,await s()))();return this.pendingInLock.push((async()=>{try{await u}catch{}})()),u}return await this.lock(`lock:${this.storageKey}`,n,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const o=s();for(this.pendingInLock.push((async()=>{try{await o}catch{}})()),await o;this.pendingInLock.length;){const u=[...this.pendingInLock];await Promise.all(u),this.pendingInLock.splice(0,u.length)}return await o}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(n){this._debug("#_useSession","begin");try{const s=await this.__loadSession();return await n(s)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let n=null;const s=await gr(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",s),s!==null&&(this._isValidSession(s)?n=s:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!n)return{data:{session:null},error:null};const o=n.expires_at?n.expires_at*1e3-Date.now()<Ml:!1;if(this._debug("#__loadSession()",`session has${o?"":" not"} expired`,"expires_at",n.expires_at),!o){if(this.userStorage){const f=await gr(this.userStorage,this.storageKey+"-user");f!=null&&f.user?n.user=f.user:n.user=zl()}if(this.storage.isServer&&n.user&&!n.user.__isUserNotAvailableProxy){const f={value:this.suppressGetSessionWarning};n.user=Xg(n.user,f),f.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:n},error:null}}const{data:u,error:d}=await this._callRefreshToken(n.refresh_token);return d?this._returnResult({data:{session:null},error:d}):this._returnResult({data:{session:u},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(n){if(n)return await this._getUser(n);await this.initializePromise;const s=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return s.data.user&&(this.suppressGetSessionWarning=!0),s}async _getUser(n){try{return n?await ye(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:n,xform:Zn}):await this._useSession(async s=>{var o,u,d;const{data:f,error:m}=s;if(m)throw m;return!(!((o=f.session)===null||o===void 0)&&o.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new $t}:await ye(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(d=(u=f.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0,xform:Zn})})}catch(s){if(de(s))return Ul(s)&&(await this._removeSession(),await ft(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:s});throw s}}async updateUser(n,s={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(n,s))}async _updateUser(n,s={}){try{return await this._useSession(async o=>{const{data:u,error:d}=o;if(d)throw d;if(!u.session)throw new $t;const f=u.session;let m=null,p=null;this.flowType==="pkce"&&n.email!=null&&([m,p]=await Kr(this.storage,this.storageKey));const{data:y,error:v}=await ye(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:s==null?void 0:s.emailRedirectTo,body:Object.assign(Object.assign({},n),{code_challenge:m,code_challenge_method:p}),jwt:f.access_token,xform:Zn});if(v)throw v;return f.user=y.user,await this._saveSession(f),await this._notifyAllSubscribers("USER_UPDATED",f),this._returnResult({data:{user:f.user},error:null})})}catch(o){if(await ft(this.storage,`${this.storageKey}-code-verifier`),de(o))return this._returnResult({data:{user:null},error:o});throw o}}async setSession(n){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(n))}async _setSession(n){try{if(!n.access_token||!n.refresh_token)throw new $t;const s=Date.now()/1e3;let o=s,u=!0,d=null;const{payload:f}=Ei(n.access_token);if(f.exp&&(o=f.exp,u=o<=s),u){const{data:m,error:p}=await this._callRefreshToken(n.refresh_token);if(p)return this._returnResult({data:{user:null,session:null},error:p});if(!m)return{data:{user:null,session:null},error:null};d=m}else{const{data:m,error:p}=await this._getUser(n.access_token);if(p)return this._returnResult({data:{user:null,session:null},error:p});d={access_token:n.access_token,refresh_token:n.refresh_token,user:m.user,token_type:"bearer",expires_in:o-s,expires_at:o},await this._saveSession(d),await this._notifyAllSubscribers("SIGNED_IN",d)}return this._returnResult({data:{user:d.user,session:d},error:null})}catch(s){if(de(s))return this._returnResult({data:{session:null,user:null},error:s});throw s}}async refreshSession(n){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(n))}async _refreshSession(n){try{return await this._useSession(async s=>{var o;if(!n){const{data:f,error:m}=s;if(m)throw m;n=(o=f.session)!==null&&o!==void 0?o:void 0}if(!(n!=null&&n.refresh_token))throw new $t;const{data:u,error:d}=await this._callRefreshToken(n.refresh_token);return d?this._returnResult({data:{user:null,session:null},error:d}):u?this._returnResult({data:{user:u.user,session:u},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(s){if(de(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async _getSessionFromURL(n,s){try{if(!mt())throw new Ni("No browser detected.");if(n.error||n.error_description||n.error_code)throw new Ni(n.error_description||"Error in URL with unspecified error_description",{error:n.error||"unspecified_error",code:n.error_code||"unspecified_code"});switch(s){case"implicit":if(this.flowType==="pkce")throw new ph("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Ni("Not a valid implicit grant flow url.");break;default:}if(s==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!n.code)throw new ph("No code detected.");const{data:V,error:z}=await this._exchangeCodeForSession(n.code);if(z)throw z;const q=new URL(window.location.href);return q.searchParams.delete("code"),window.history.replaceState(window.history.state,"",q.toString()),{data:{session:V.session,redirectType:null},error:null}}const{provider_token:o,provider_refresh_token:u,access_token:d,refresh_token:f,expires_in:m,expires_at:p,token_type:y}=n;if(!d||!m||!f||!y)throw new Ni("No session defined in URL");const v=Math.round(Date.now()/1e3),b=parseInt(m);let _=v+b;p&&(_=parseInt(p));const w=_-v;w*1e3<=Zr&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${w}s, should have been closer to ${b}s`);const T=_-b;v-T>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",T,_,v):v-T<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",T,_,v);const{data:j,error:E}=await this._getUser(d);if(E)throw E;const D={provider_token:o,provider_refresh_token:u,access_token:d,expires_in:b,expires_at:_,refresh_token:f,token_type:y,user:j.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:D,redirectType:n.type},error:null})}catch(o){if(de(o))return this._returnResult({data:{session:null,redirectType:null},error:o});throw o}}_isImplicitGrantCallback(n){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),n):!!(n.access_token||n.error_description)}async _isPKCECallback(n){const s=await gr(this.storage,`${this.storageKey}-code-verifier`);return!!(n.code&&s)}async signOut(n={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(n))}async _signOut({scope:n}={scope:"global"}){return await this._useSession(async s=>{var o;const{data:u,error:d}=s;if(d&&!Ul(d))return this._returnResult({error:d});const f=(o=u.session)===null||o===void 0?void 0:o.access_token;if(f){const{error:m}=await this.admin.signOut(f,n);if(m&&!(Tg(m)&&(m.status===404||m.status===401||m.status===403)||Ul(m)))return this._returnResult({error:m})}return n!=="others"&&(await this._removeSession(),await ft(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(n){const s=Mg(),o={id:s,callback:n,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",s),this.stateChangeEmitters.delete(s)}};return this._debug("#onAuthStateChange()","registered callback with id",s),this.stateChangeEmitters.set(s,o),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(s)})))(),{data:{subscription:o}}}async _emitInitialSession(n){return await this._useSession(async s=>{var o,u;try{const{data:{session:d},error:f}=s;if(f)throw f;await((o=this.stateChangeEmitters.get(n))===null||o===void 0?void 0:o.callback("INITIAL_SESSION",d)),this._debug("INITIAL_SESSION","callback id",n,"session",d)}catch(d){await((u=this.stateChangeEmitters.get(n))===null||u===void 0?void 0:u.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",n,"error",d),console.error(d)}})}async resetPasswordForEmail(n,s={}){let o=null,u=null;this.flowType==="pkce"&&([o,u]=await Kr(this.storage,this.storageKey,!0));try{return await ye(this.fetch,"POST",`${this.url}/recover`,{body:{email:n,code_challenge:o,code_challenge_method:u,gotrue_meta_security:{captcha_token:s.captchaToken}},headers:this.headers,redirectTo:s.redirectTo})}catch(d){if(await ft(this.storage,`${this.storageKey}-code-verifier`),de(d))return this._returnResult({data:null,error:d});throw d}}async getUserIdentities(){var n;try{const{data:s,error:o}=await this.getUser();if(o)throw o;return this._returnResult({data:{identities:(n=s.user.identities)!==null&&n!==void 0?n:[]},error:null})}catch(s){if(de(s))return this._returnResult({data:null,error:s});throw s}}async linkIdentity(n){return"token"in n?this.linkIdentityIdToken(n):this.linkIdentityOAuth(n)}async linkIdentityOAuth(n){var s;try{const{data:o,error:u}=await this._useSession(async d=>{var f,m,p,y,v;const{data:b,error:_}=d;if(_)throw _;const w=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,n.provider,{redirectTo:(f=n.options)===null||f===void 0?void 0:f.redirectTo,scopes:(m=n.options)===null||m===void 0?void 0:m.scopes,queryParams:(p=n.options)===null||p===void 0?void 0:p.queryParams,skipBrowserRedirect:!0});return await ye(this.fetch,"GET",w,{headers:this.headers,jwt:(v=(y=b.session)===null||y===void 0?void 0:y.access_token)!==null&&v!==void 0?v:void 0})});if(u)throw u;return mt()&&!(!((s=n.options)===null||s===void 0)&&s.skipBrowserRedirect)&&window.location.assign(o==null?void 0:o.url),this._returnResult({data:{provider:n.provider,url:o==null?void 0:o.url},error:null})}catch(o){if(de(o))return this._returnResult({data:{provider:n.provider,url:null},error:o});throw o}}async linkIdentityIdToken(n){return await this._useSession(async s=>{var o;try{const{error:u,data:{session:d}}=s;if(u)throw u;const{options:f,provider:m,token:p,access_token:y,nonce:v}=n,b=await ye(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(o=d==null?void 0:d.access_token)!==null&&o!==void 0?o:void 0,body:{provider:m,id_token:p,access_token:y,nonce:v,link_identity:!0,gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:en}),{data:_,error:w}=b;return w?this._returnResult({data:{user:null,session:null},error:w}):!_||!_.session||!_.user?this._returnResult({data:{user:null,session:null},error:new Gr}):(_.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("USER_UPDATED",_.session)),this._returnResult({data:_,error:w}))}catch(u){if(await ft(this.storage,`${this.storageKey}-code-verifier`),de(u))return this._returnResult({data:{user:null,session:null},error:u});throw u}})}async unlinkIdentity(n){try{return await this._useSession(async s=>{var o,u;const{data:d,error:f}=s;if(f)throw f;return await ye(this.fetch,"DELETE",`${this.url}/user/identities/${n.identity_id}`,{headers:this.headers,jwt:(u=(o=d.session)===null||o===void 0?void 0:o.access_token)!==null&&u!==void 0?u:void 0})})}catch(s){if(de(s))return this._returnResult({data:null,error:s});throw s}}async _refreshAccessToken(n){const s=`#_refreshAccessToken(${n.substring(0,5)}...)`;this._debug(s,"begin");try{const o=Date.now();return await Bg(async u=>(u>0&&await zg(200*Math.pow(2,u-1)),this._debug(s,"refreshing attempt",u),await ye(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:n},headers:this.headers,xform:en})),(u,d)=>{const f=200*Math.pow(2,u);return d&&Fl(d)&&Date.now()+f-o<Zr})}catch(o){if(this._debug(s,"error",o),de(o))return this._returnResult({data:{session:null,user:null},error:o});throw o}finally{this._debug(s,"end")}}_isValidSession(n){return typeof n=="object"&&n!==null&&"access_token"in n&&"refresh_token"in n&&"expires_at"in n}async _handleProviderSignIn(n,s){const o=await this._getUrlForProvider(`${this.url}/authorize`,n,{redirectTo:s.redirectTo,scopes:s.scopes,queryParams:s.queryParams});return this._debug("#_handleProviderSignIn()","provider",n,"options",s,"url",o),mt()&&!s.skipBrowserRedirect&&window.location.assign(o),{data:{provider:n,url:o},error:null}}async _recoverAndRefresh(){var n,s;const o="#_recoverAndRefresh()";this._debug(o,"begin");try{const u=await gr(this.storage,this.storageKey);if(u&&this.userStorage){let f=await gr(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!f&&(f={user:u.user},await es(this.userStorage,this.storageKey+"-user",f)),u.user=(n=f==null?void 0:f.user)!==null&&n!==void 0?n:zl()}else if(u&&!u.user&&!u.user){const f=await gr(this.storage,this.storageKey+"-user");f&&(f!=null&&f.user)?(u.user=f.user,await ft(this.storage,this.storageKey+"-user"),await es(this.storage,this.storageKey,u)):u.user=zl()}if(this._debug(o,"session from storage",u),!this._isValidSession(u)){this._debug(o,"session is not valid"),u!==null&&await this._removeSession();return}const d=((s=u.expires_at)!==null&&s!==void 0?s:1/0)*1e3-Date.now()<Ml;if(this._debug(o,`session has${d?"":" not"} expired with margin of ${Ml}s`),d){if(this.autoRefreshToken&&u.refresh_token){const{error:f}=await this._callRefreshToken(u.refresh_token);f&&(console.error(f),Fl(f)||(this._debug(o,"refresh failed with a non-retryable error, removing the session",f),await this._removeSession()))}}else if(u.user&&u.user.__isUserNotAvailableProxy===!0)try{const{data:f,error:m}=await this._getUser(u.access_token);!m&&(f!=null&&f.user)?(u.user=f.user,await this._saveSession(u),await this._notifyAllSubscribers("SIGNED_IN",u)):this._debug(o,"could not get user data, skipping SIGNED_IN notification")}catch(f){console.error("Error getting user data:",f),this._debug(o,"error getting user data, skipping SIGNED_IN notification",f)}else await this._notifyAllSubscribers("SIGNED_IN",u)}catch(u){this._debug(o,"error",u),console.error(u);return}finally{this._debug(o,"end")}}async _callRefreshToken(n){var s,o;if(!n)throw new $t;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const u=`#_callRefreshToken(${n.substring(0,5)}...)`;this._debug(u,"begin");try{this.refreshingDeferred=new $i;const{data:d,error:f}=await this._refreshAccessToken(n);if(f)throw f;if(!d.session)throw new $t;await this._saveSession(d.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",d.session);const m={data:d.session,error:null};return this.refreshingDeferred.resolve(m),m}catch(d){if(this._debug(u,"error",d),de(d)){const f={data:null,error:d};return Fl(d)||await this._removeSession(),(s=this.refreshingDeferred)===null||s===void 0||s.resolve(f),f}throw(o=this.refreshingDeferred)===null||o===void 0||o.reject(d),d}finally{this.refreshingDeferred=null,this._debug(u,"end")}}async _notifyAllSubscribers(n,s,o=!0){const u=`#_notifyAllSubscribers(${n})`;this._debug(u,"begin",s,`broadcast = ${o}`);try{this.broadcastChannel&&o&&this.broadcastChannel.postMessage({event:n,session:s});const d=[],f=Array.from(this.stateChangeEmitters.values()).map(async m=>{try{await m.callback(n,s)}catch(p){d.push(p)}});if(await Promise.all(f),d.length>0){for(let m=0;m<d.length;m+=1)console.error(d[m]);throw d[0]}}finally{this._debug(u,"end")}}async _saveSession(n){this._debug("#_saveSession()",n),this.suppressGetSessionWarning=!0,await ft(this.storage,`${this.storageKey}-code-verifier`);const s=Object.assign({},n),o=s.user&&s.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!o&&s.user&&await es(this.userStorage,this.storageKey+"-user",{user:s.user});const u=Object.assign({},s);delete u.user;const d=wh(u);await es(this.storage,this.storageKey,d)}else{const u=wh(s);await es(this.storage,this.storageKey,u)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await ft(this.storage,this.storageKey),await ft(this.storage,this.storageKey+"-code-verifier"),await ft(this.storage,this.storageKey+"-user"),this.userStorage&&await ft(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const n=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{n&&mt()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",n)}catch(s){console.error("removing visibilitychange callback failed",s)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const n=setInterval(()=>this._autoRefreshTokenTick(),Zr);this.autoRefreshTicker=n,n&&typeof n=="object"&&typeof n.unref=="function"?n.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(n);const s=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=s,s&&typeof s=="object"&&typeof s.unref=="function"?s.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(s)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const n=this.autoRefreshTicker;this.autoRefreshTicker=null,n&&clearInterval(n);const s=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,s&&clearTimeout(s)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const n=Date.now();try{return await this._useSession(async s=>{const{data:{session:o}}=s;if(!o||!o.refresh_token||!o.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const u=Math.floor((o.expires_at*1e3-n)/Zr);this._debug("#_autoRefreshTokenTick()",`access token expires in ${u} ticks, a tick lasts ${Zr}ms, refresh threshold is ${Yl} ticks`),u<=Yl&&await this._callRefreshToken(o.refresh_token)})}catch(s){console.error("Auto refresh tick failed with error. This is likely a transient error.",s)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(n){if(n.isAcquireTimeout||n instanceof Hh)this._debug("auto refresh token tick lock not available");else throw n}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!mt()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>{try{await this._onVisibilityChanged(!1)}catch(n){this._debug("#visibilityChangedCallback","error",n)}},window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(n){console.error("_handleVisibilityChange",n)}}async _onVisibilityChanged(n){const s=`#_onVisibilityChanged(${n})`;this._debug(s,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),n||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(s,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(n,s,o){const u=[`provider=${encodeURIComponent(s)}`];if(o!=null&&o.redirectTo&&u.push(`redirect_to=${encodeURIComponent(o.redirectTo)}`),o!=null&&o.scopes&&u.push(`scopes=${encodeURIComponent(o.scopes)}`),this.flowType==="pkce"){const[d,f]=await Kr(this.storage,this.storageKey),m=new URLSearchParams({code_challenge:`${encodeURIComponent(d)}`,code_challenge_method:`${encodeURIComponent(f)}`});u.push(m.toString())}if(o!=null&&o.queryParams){const d=new URLSearchParams(o.queryParams);u.push(d.toString())}return o!=null&&o.skipBrowserRedirect&&u.push(`skip_http_redirect=${o.skipBrowserRedirect}`),`${n}?${u.join("&")}`}async _unenroll(n){try{return await this._useSession(async s=>{var o;const{data:u,error:d}=s;return d?this._returnResult({data:null,error:d}):await ye(this.fetch,"DELETE",`${this.url}/factors/${n.factorId}`,{headers:this.headers,jwt:(o=u==null?void 0:u.session)===null||o===void 0?void 0:o.access_token})})}catch(s){if(de(s))return this._returnResult({data:null,error:s});throw s}}async _enroll(n){try{return await this._useSession(async s=>{var o,u;const{data:d,error:f}=s;if(f)return this._returnResult({data:null,error:f});const m=Object.assign({friendly_name:n.friendlyName,factor_type:n.factorType},n.factorType==="phone"?{phone:n.phone}:n.factorType==="totp"?{issuer:n.issuer}:{}),{data:p,error:y}=await ye(this.fetch,"POST",`${this.url}/factors`,{body:m,headers:this.headers,jwt:(o=d==null?void 0:d.session)===null||o===void 0?void 0:o.access_token});return y?this._returnResult({data:null,error:y}):(n.factorType==="totp"&&p.type==="totp"&&(!((u=p==null?void 0:p.totp)===null||u===void 0)&&u.qr_code)&&(p.totp.qr_code=`data:image/svg+xml;utf-8,${p.totp.qr_code}`),this._returnResult({data:p,error:null}))})}catch(s){if(de(s))return this._returnResult({data:null,error:s});throw s}}async _verify(n){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async s=>{var o;const{data:u,error:d}=s;if(d)return this._returnResult({data:null,error:d});const f=Object.assign({challenge_id:n.challengeId},"webauthn"in n?{webauthn:Object.assign(Object.assign({},n.webauthn),{credential_response:n.webauthn.type==="create"?v0(n.webauthn.credential_response):x0(n.webauthn.credential_response)})}:{code:n.code}),{data:m,error:p}=await ye(this.fetch,"POST",`${this.url}/factors/${n.factorId}/verify`,{body:f,headers:this.headers,jwt:(o=u==null?void 0:u.session)===null||o===void 0?void 0:o.access_token});return p?this._returnResult({data:null,error:p}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+m.expires_in},m)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",m),this._returnResult({data:m,error:p}))})}catch(s){if(de(s))return this._returnResult({data:null,error:s});throw s}})}async _challenge(n){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async s=>{var o;const{data:u,error:d}=s;if(d)return this._returnResult({data:null,error:d});const f=await ye(this.fetch,"POST",`${this.url}/factors/${n.factorId}/challenge`,{body:n,headers:this.headers,jwt:(o=u==null?void 0:u.session)===null||o===void 0?void 0:o.access_token});if(f.error)return f;const{data:m}=f;if(m.type!=="webauthn")return{data:m,error:null};switch(m.webauthn.type){case"create":return{data:Object.assign(Object.assign({},m),{webauthn:Object.assign(Object.assign({},m.webauthn),{credential_options:Object.assign(Object.assign({},m.webauthn.credential_options),{publicKey:g0(m.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},m),{webauthn:Object.assign(Object.assign({},m.webauthn),{credential_options:Object.assign(Object.assign({},m.webauthn.credential_options),{publicKey:y0(m.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(s){if(de(s))return this._returnResult({data:null,error:s});throw s}})}async _challengeAndVerify(n){const{data:s,error:o}=await this._challenge({factorId:n.factorId});return o?this._returnResult({data:null,error:o}):await this._verify({factorId:n.factorId,challengeId:s.id,code:n.code})}async _listFactors(){var n;const{data:{user:s},error:o}=await this.getUser();if(o)return{data:null,error:o};const u={all:[],phone:[],totp:[],webauthn:[]};for(const d of(n=s==null?void 0:s.factors)!==null&&n!==void 0?n:[])u.all.push(d),d.status==="verified"&&u[d.factor_type].push(d);return{data:u,error:null}}async _getAuthenticatorAssuranceLevel(n){var s,o,u,d;if(n)try{const{payload:w}=Ei(n);let T=null;w.aal&&(T=w.aal);let j=T;const{data:{user:E},error:D}=await this.getUser(n);if(D)return this._returnResult({data:null,error:D});((o=(s=E==null?void 0:E.factors)===null||s===void 0?void 0:s.filter(q=>q.status==="verified"))!==null&&o!==void 0?o:[]).length>0&&(j="aal2");const z=w.amr||[];return{data:{currentLevel:T,nextLevel:j,currentAuthenticationMethods:z},error:null}}catch(w){if(de(w))return this._returnResult({data:null,error:w});throw w}const{data:{session:f},error:m}=await this.getSession();if(m)return this._returnResult({data:null,error:m});if(!f)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:p}=Ei(f.access_token);let y=null;p.aal&&(y=p.aal);let v=y;((d=(u=f.user.factors)===null||u===void 0?void 0:u.filter(w=>w.status==="verified"))!==null&&d!==void 0?d:[]).length>0&&(v="aal2");const _=p.amr||[];return{data:{currentLevel:y,nextLevel:v,currentAuthenticationMethods:_},error:null}}async _getAuthorizationDetails(n){try{return await this._useSession(async s=>{const{data:{session:o},error:u}=s;return u?this._returnResult({data:null,error:u}):o?await ye(this.fetch,"GET",`${this.url}/oauth/authorizations/${n}`,{headers:this.headers,jwt:o.access_token,xform:d=>({data:d,error:null})}):this._returnResult({data:null,error:new $t})})}catch(s){if(de(s))return this._returnResult({data:null,error:s});throw s}}async _approveAuthorization(n,s){try{return await this._useSession(async o=>{const{data:{session:u},error:d}=o;if(d)return this._returnResult({data:null,error:d});if(!u)return this._returnResult({data:null,error:new $t});const f=await ye(this.fetch,"POST",`${this.url}/oauth/authorizations/${n}/consent`,{headers:this.headers,jwt:u.access_token,body:{action:"approve"},xform:m=>({data:m,error:null})});return f.data&&f.data.redirect_url&&mt()&&!(s!=null&&s.skipBrowserRedirect)&&window.location.assign(f.data.redirect_url),f})}catch(o){if(de(o))return this._returnResult({data:null,error:o});throw o}}async _denyAuthorization(n,s){try{return await this._useSession(async o=>{const{data:{session:u},error:d}=o;if(d)return this._returnResult({data:null,error:d});if(!u)return this._returnResult({data:null,error:new $t});const f=await ye(this.fetch,"POST",`${this.url}/oauth/authorizations/${n}/consent`,{headers:this.headers,jwt:u.access_token,body:{action:"deny"},xform:m=>({data:m,error:null})});return f.data&&f.data.redirect_url&&mt()&&!(s!=null&&s.skipBrowserRedirect)&&window.location.assign(f.data.redirect_url),f})}catch(o){if(de(o))return this._returnResult({data:null,error:o});throw o}}async _listOAuthGrants(){try{return await this._useSession(async n=>{const{data:{session:s},error:o}=n;return o?this._returnResult({data:null,error:o}):s?await ye(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:s.access_token,xform:u=>({data:u,error:null})}):this._returnResult({data:null,error:new $t})})}catch(n){if(de(n))return this._returnResult({data:null,error:n});throw n}}async _revokeOAuthGrant(n){try{return await this._useSession(async s=>{const{data:{session:o},error:u}=s;return u?this._returnResult({data:null,error:u}):o?(await ye(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:o.access_token,query:{client_id:n.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new $t})})}catch(s){if(de(s))return this._returnResult({data:null,error:s});throw s}}async fetchJwk(n,s={keys:[]}){let o=s.keys.find(m=>m.kid===n);if(o)return o;const u=Date.now();if(o=this.jwks.keys.find(m=>m.kid===n),o&&this.jwks_cached_at+Eg>u)return o;const{data:d,error:f}=await ye(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(f)throw f;return!d.keys||d.keys.length===0||(this.jwks=d,this.jwks_cached_at=u,o=d.keys.find(m=>m.kid===n),!o)?null:o}async getClaims(n,s={}){try{let o=n;if(!o){const{data:w,error:T}=await this.getSession();if(T||!w.session)return this._returnResult({data:null,error:T});o=w.session.access_token}const{header:u,payload:d,signature:f,raw:{header:m,payload:p}}=Ei(o);s!=null&&s.allowExpired||Jg(d.exp);const y=!u.alg||u.alg.startsWith("HS")||!u.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(u.kid,s!=null&&s.keys?{keys:s.keys}:s==null?void 0:s.jwks);if(!y){const{error:w}=await this.getUser(o);if(w)throw w;return{data:{claims:d,header:u,signature:f},error:null}}const v=Qg(u.alg),b=await crypto.subtle.importKey("jwk",y,v,!0,["verify"]);if(!await crypto.subtle.verify(v,b,f,Lg(`${m}.${p}`)))throw new eu("Invalid JWT signature");return{data:{claims:d,header:u,signature:f},error:null}}catch(o){if(de(o))return this._returnResult({data:null,error:o});throw o}}}ra.nextInstanceID={};const C0=ra,T0="2.95.3";let Gs="";typeof Deno<"u"?Gs="deno":typeof document<"u"?Gs="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Gs="react-native":Gs="node";const A0={"X-Client-Info":`supabase-js-${Gs}/${T0}`},I0={headers:A0},R0={schema:"public"},O0={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},P0={};function sa(r){"@babel/helpers - typeof";return sa=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},sa(r)}function D0(r,n){if(sa(r)!="object"||!r)return r;var s=r[Symbol.toPrimitive];if(s!==void 0){var o=s.call(r,n);if(sa(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(r)}function L0(r){var n=D0(r,"string");return sa(n)=="symbol"?n:n+""}function $0(r,n,s){return(n=L0(n))in r?Object.defineProperty(r,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):r[n]=s,r}function Eh(r,n){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(r);n&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(r,u).enumerable})),s.push.apply(s,o)}return s}function Ke(r){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?Eh(Object(s),!0).forEach(function(o){$0(r,o,s[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):Eh(Object(s)).forEach(function(o){Object.defineProperty(r,o,Object.getOwnPropertyDescriptor(s,o))})}return r}const M0=r=>r?(...n)=>r(...n):(...n)=>fetch(...n),U0=()=>Headers,F0=(r,n,s)=>{const o=M0(s),u=U0();return async(d,f)=>{var m;const p=(m=await n())!==null&&m!==void 0?m:r;let y=new u(f==null?void 0:f.headers);return y.has("apikey")||y.set("apikey",r),y.has("Authorization")||y.set("Authorization",`Bearer ${p}`),o(d,Ke(Ke({},f),{},{headers:y}))}};function z0(r){return r.endsWith("/")?r:r+"/"}function B0(r,n){var s,o;const{db:u,auth:d,realtime:f,global:m}=r,{db:p,auth:y,realtime:v,global:b}=n,_={db:Ke(Ke({},p),u),auth:Ke(Ke({},y),d),realtime:Ke(Ke({},v),f),storage:{},global:Ke(Ke(Ke({},b),m),{},{headers:Ke(Ke({},(s=b==null?void 0:b.headers)!==null&&s!==void 0?s:{}),(o=m==null?void 0:m.headers)!==null&&o!==void 0?o:{})}),accessToken:async()=>""};return r.accessToken?_.accessToken=r.accessToken:delete _.accessToken,_}function W0(r){const n=r==null?void 0:r.trim();if(!n)throw new Error("supabaseUrl is required.");if(!n.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(z0(n))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var q0=class extends C0{constructor(r){super(r)}},V0=class{constructor(r,n,s){var o,u;this.supabaseUrl=r,this.supabaseKey=n;const d=W0(r);if(!n)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",d),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",d),this.storageUrl=new URL("storage/v1",d),this.functionsUrl=new URL("functions/v1",d);const f=`sb-${d.hostname.split(".")[0]}-auth-token`,m={db:R0,realtime:P0,auth:Ke(Ke({},O0),{},{storageKey:f}),global:I0},p=B0(s??{},m);if(this.storageKey=(o=p.auth.storageKey)!==null&&o!==void 0?o:"",this.headers=(u=p.global.headers)!==null&&u!==void 0?u:{},p.accessToken)this.accessToken=p.accessToken,this.auth=new Proxy({},{get:(v,b)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(b)} is not possible`)}});else{var y;this.auth=this._initSupabaseAuthClient((y=p.auth)!==null&&y!==void 0?y:{},this.headers,p.global.fetch)}this.fetch=F0(n,this._getAccessToken.bind(this),p.global.fetch),this.realtime=this._initRealtimeClient(Ke({headers:this.headers,accessToken:this._getAccessToken.bind(this)},p.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(v=>this.realtime.setAuth(v)).catch(v=>console.warn("Failed to set initial Realtime auth token:",v)),this.rest=new Tp(new URL("rest/v1",d).href,{headers:this.headers,schema:p.db.schema,fetch:this.fetch,timeout:p.db.timeout,urlLengthLimit:p.db.urlLengthLimit}),this.storage=new _g(this.storageUrl.href,this.headers,this.fetch,s==null?void 0:s.storage),p.accessToken||this._listenForAuthEvents()}get functions(){return new bp(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(r){return this.rest.from(r)}schema(r){return this.rest.schema(r)}rpc(r,n={},s={head:!1,get:!1,count:void 0}){return this.rest.rpc(r,n,s)}channel(r,n={config:{}}){return this.realtime.channel(r,n)}getChannels(){return this.realtime.getChannels()}removeChannel(r){return this.realtime.removeChannel(r)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var r=this,n,s;if(r.accessToken)return await r.accessToken();const{data:o}=await r.auth.getSession();return(n=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&n!==void 0?n:r.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:r,persistSession:n,detectSessionInUrl:s,storage:o,userStorage:u,storageKey:d,flowType:f,lock:m,debug:p,throwOnError:y},v,b){const _={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new q0({url:this.authUrl.href,headers:Ke(Ke({},_),v),storageKey:d,autoRefreshToken:r,persistSession:n,detectSessionInUrl:s,storage:o,userStorage:u,flowType:f,lock:m,debug:p,throwOnError:y,fetch:b,hasCustomAuthorizationHeader:Object.keys(this.headers).some(w=>w.toLowerCase()==="authorization")})}_initRealtimeClient(r){return new Hp(this.realtimeUrl.href,Ke(Ke({},r),{},{params:Ke(Ke({},{apikey:this.supabaseKey}),r==null?void 0:r.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(r,n,s){(r==="TOKEN_REFRESHED"||r==="SIGNED_IN")&&this.changedAccessToken!==s?(this.changedAccessToken=s,this.realtime.setAuth(s)):r==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const H0=(r,n,s)=>new V0(r,n,s);function G0(){if(typeof window<"u")return!1;const r=globalThis.process;if(!r)return!1;const n=r.version;if(n==null)return!1;const s=n.match(/^v(\d+)\./);return s?parseInt(s[1],10)<=18:!1}G0()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const K0="https://txugsklfvnprayybahsp.supabase.co",J0="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InR4dWdza2xmdm5wcmF5eWJhaHNwIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc3MDk0ODMyOSwiZXhwIjoyMDg2NTI0MzI5fQ.53MasjOuOEzDpdIOU3xyuZvrK-SeL0BjGQ_hWJkyTiM",Ye=H0(K0,J0);function Q0(r){return r.replace(/_([a-z])/g,(n,s)=>s.toUpperCase())}function Y0(r){return r.replace(/[A-Z]/g,n=>`_${n.toLowerCase()}`)}function kt(r){if(r==null)return r;if(Array.isArray(r))return r.map(s=>kt(s));if(typeof r!="object")return r;const n={};for(const[s,o]of Object.entries(r)){const u=Q0(s);o!==null&&typeof o=="object"&&!Array.isArray(o)?n[u]=kt(o):Array.isArray(o)?n[u]=o.map(d=>typeof d=="object"&&d!==null?kt(d):d):n[u]=o}return n}function rs(r){if(r==null)return r;if(Array.isArray(r))return r.map(s=>rs(s));if(typeof r!="object")return r;const n={};for(const[s,o]of Object.entries(r)){const u=Y0(s);o!==null&&typeof o=="object"&&!Array.isArray(o)?n[u]=rs(o):Array.isArray(o)?n[u]=o.map(d=>typeof d=="object"&&d!==null?rs(d):d):n[u]=o}return n}const Jh=A.createContext(null);function su(){const r=A.useContext(Jh);if(!r)throw new Error("useAuth must be used within an AuthProvider");return r}function X0({children:r}){const[n,s]=A.useState(null),[o,u]=A.useState(null),[d,f]=A.useState(null),[m,p]=A.useState(null),[y,v]=A.useState(!0),b=A.useCallback(async D=>{try{let{data:V,error:z}=await Ye.from("app_user").select("*").eq("id",D.id).maybeSingle();if(!V&&!z&&D.email&&({data:V,error:z}=await Ye.from("app_user").select("*").eq("email",D.email).maybeSingle()),z){console.error("Failed to fetch app_user:",z.message);return}if(V){const q=kt(V);f(q),p(q.role)}else console.warn("No app_user row found for:",D.email),p("Staff")}catch(V){console.error("Error fetching app_user:",V)}},[]),_=A.useCallback(()=>{s(null),u(null),f(null),p(null)},[]),w=A.useCallback(async D=>{u(D);const V=(D==null?void 0:D.user)??null;s(V),V?await b(V):_()},[b,_]);A.useEffect(()=>{let D=!0;async function V(){try{const{data:{session:q}}=await Ye.auth.getSession();D&&await w(q)}catch(q){console.error("Failed to get session:",q)}finally{D&&v(!1)}}V();const{data:{subscription:z}}=Ye.auth.onAuthStateChange(async(q,$)=>{D&&await w($)});return()=>{D=!1,z.unsubscribe()}},[w]);const T=A.useCallback(async(D,V)=>{v(!0);try{const{error:z}=await Ye.auth.signInWithPassword({email:D,password:V});return z?z.message:null}catch(z){return z instanceof Error?z.message:"An unexpected error occurred"}finally{v(!1)}},[]),j=A.useCallback(async()=>{v(!0);try{await Ye.auth.signOut(),_()}catch(D){console.error("Sign out error:",D)}finally{v(!1)}},[_]),E={user:n,session:o,appUser:d,role:m,loading:y,signIn:T,signOut:j};return i.jsx(Jh.Provider,{value:E,children:r})}function Z0(){const{signIn:r,loading:n}=su(),[s,o]=A.useState(""),[u,d]=A.useState(""),[f,m]=A.useState(null),[p,y]=A.useState(!1);async function v(_){if(_.preventDefault(),m(null),!s.trim()||!u.trim()){m("Please enter both email and password.");return}y(!0);const w=await r(s.trim(),u);w&&m(ey(w)),y(!1)}const b=p||n;return i.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center px-4",children:i.jsxs("div",{className:"w-full max-w-sm",children:[i.jsxs("div",{className:"text-center mb-8",children:[i.jsx("div",{className:"inline-flex items-center justify-center w-14 h-14 bg-blue-600 rounded-xl mb-4",children:i.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-7 h-7",children:[i.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),i.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]})}),i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Seamless"}),i.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"People Management"})]}),i.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm p-6",children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-1",children:"Sign in"}),i.jsx("p",{className:"text-sm text-gray-500 mb-6",children:"Enter your credentials to access the platform."}),i.jsxs("form",{onSubmit:v,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),i.jsx("input",{id:"email",type:"email",value:s,onChange:_=>o(_.target.value),placeholder:"you@company.ae",autoComplete:"email",disabled:b,className:`w-full px-3 py-2 border border-gray-200 rounded-lg text-sm
                  focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent
                  disabled:bg-gray-50 disabled:text-gray-400`})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),i.jsx("input",{id:"password",type:"password",value:u,onChange:_=>d(_.target.value),placeholder:"",autoComplete:"current-password",disabled:b,className:`w-full px-3 py-2 border border-gray-200 rounded-lg text-sm
                  focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent
                  disabled:bg-gray-50 disabled:text-gray-400`})]}),f&&i.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg px-3 py-2",children:i.jsx("p",{className:"text-sm text-red-700",children:f})}),i.jsx("button",{type:"submit",disabled:b,className:`w-full bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium
                py-2.5 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed`,children:p?"Signing in":"Sign in"})]})]}),i.jsx("p",{className:"text-center text-xs text-gray-400 mt-6",children:"Accounts are managed by your administrator."})]})})}function ey(r){const n=r.toLowerCase();return n.includes("invalid login credentials")?"Invalid email or password. Please try again.":n.includes("email not confirmed")?"Your email has not been confirmed. Contact your administrator.":n.includes("too many requests")||n.includes("rate limit")?"Too many attempts. Please wait a moment and try again.":r}function ty({children:r}){const{session:n,loading:s}=su();return s?i.jsx(ny,{}):n?i.jsx(i.Fragment,{children:r}):i.jsx(Z0,{})}function ny(){return i.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"inline-flex items-center justify-center w-10 h-10 mb-4",children:i.jsx("div",{className:"w-8 h-8 border-2 border-blue-200 border-t-blue-600 rounded-full animate-spin"})}),i.jsx("p",{className:"text-sm text-gray-500",children:"Loading"})]})})}const ry=["id","uid","createdAt","updatedAt","isSingleton"];function Wl(r){const n={...r};for(const s of ry)delete n[s];return n}function Qn(r){return r.code==="23505"?"A record with that value already exists (duplicate)":r.code==="23503"?"Cannot delete  this record is referenced by other data":r.message??"Unknown database error"}const Se={async getAll(r){const{data:n,error:s}=await Ye.from(r).select("*");return s?{data:null,error:Qn(s)}:{data:n.map(u=>kt(u)),error:null}},async getById(r,n){const{data:s,error:o}=await Ye.from(r).select("*").eq("id",n).single();return o?{data:null,error:Qn(o)}:{data:kt(s),error:null}},async create(r,n){const s=rs(Wl(n)),{data:o,error:u}=await Ye.from(r).insert(s).select().single();return u?{data:null,error:Qn(u)}:{data:kt(o),error:null}},async update(r,n,s){const o=rs(Wl(s)),{data:u,error:d}=await Ye.from(r).update(o).eq("id",n).select().single();return d?{data:null,error:Qn(d)}:{data:kt(u),error:null}},async remove(r,n){const{error:s}=await Ye.from(r).delete().eq("id",n);return s?{data:null,error:Qn(s)}:{data:null,error:null}},async getSingleton(r){const{data:n,error:s}=await Ye.from(r).select("*").limit(1).maybeSingle();return s?{data:null,error:Qn(s)}:n?{data:kt(n),error:null}:{data:null,error:null}},async upsertSingleton(r,n){const{data:s}=await Ye.from(r).select("id").limit(1).maybeSingle(),o=rs(Wl(n));if(s){const{data:u,error:d}=await Ye.from(r).update(o).eq("id",s.id).select().single();return d?{data:null,error:Qn(d)}:{data:kt(u),error:null}}else{const u={...o,is_singleton:!0},{data:d,error:f}=await Ye.from(r).insert(u).select().single();return f?{data:null,error:Qn(f)}:{data:kt(d),error:null}}}};var Rt=(r=>(r.Managed="Managed",r.Acting="Acting",r.Unmanaged="Unmanaged",r))(Rt||{}),as=(r=>(r.FirstnameL="firstname.L",r.FLastname="F.lastname",r))(as||{}),Nn=(r=>(r.Internal="Internal",r.External="External",r))(Nn||{}),Yn=(r=>(r.Staff="Staff",r.Admin="Admin",r.SuperAdmin="Super Admin",r))(Yn||{}),En=(r=>(r.Draft="Draft",r.Active="Active",r))(En||{}),tt=(r=>(r.Staff="Staff",r.Function="Function",r.Department="Department",r))(tt||{});const sy={id:"",name:"",location:"",website:"",logoUrl:""},ay={id:"",emailDomain:"company.com",emailFormat:as.FirstnameL,maxManagerGradeLevel:1};function iy(){const[r,n]=A.useState(null),[s,o]=A.useState(!0),[u,d]=A.useState(null),f=A.useCallback(async()=>{o(!0),d(null);try{const[m,p,y,v,b,_,w,T,j,E,D,V,z,q,$]=await Promise.all([Se.getAll("department"),Se.getAll("function"),Se.getAll("responsibility"),Se.getAll("grade"),Se.getAll("staff"),Se.getAll("cross_functional_team"),Se.getAll("team_member"),Se.getAll("workflow"),Se.getAll("workflow_step"),Se.getAll("compliance_tag"),Se.getAll("company_number"),Se.getAll("company_number_allocation"),Se.getAll("app_user"),Se.getSingleton("company_profile"),Se.getSingleton("app_settings")]),Y=[{name:"departments",res:m},{name:"functions",res:p},{name:"responsibilities",res:y},{name:"grades",res:v},{name:"staff",res:b},{name:"teams",res:_},{name:"team members",res:w},{name:"workflows",res:T},{name:"workflow steps",res:j},{name:"compliance tags",res:E},{name:"company numbers",res:D},{name:"allocations",res:V},{name:"users",res:z}].filter(re=>re.res.error).map(re=>`${re.name}: ${re.res.error}`);if(q.error&&Y.push(`company profile: ${q.error}`),$.error&&Y.push(`app settings: ${$.error}`),Y.length>0){d(`Failed to load: ${Y.join("; ")}`),o(!1);return}n({departments:m.data??[],functions:p.data??[],responsibilities:y.data??[],grades:v.data??[],staff:b.data??[],crossFunctionalTeams:_.data??[],teamMembers:w.data??[],workflows:T.data??[],workflowSteps:j.data??[],complianceTags:E.data??[],companyNumbers:D.data??[],companyNumberAllocations:V.data??[],users:z.data??[],companyProfile:q.data??sy,appSettings:$.data??ay})}catch(m){const p=m instanceof Error?m.message:"Unknown error loading data";d(p)}finally{o(!1)}},[]);return A.useEffect(()=>{f()},[f]),{data:r,loading:s,error:u,refetch:f}}function oy(r,n){switch(n.type){case"ADD_DEPARTMENT":return{...r,departments:[...r.departments,n.payload]};case"UPDATE_DEPARTMENT":return{...r,departments:r.departments.map(s=>s.id===n.payload.id?{...s,...n.payload}:s)};case"DELETE_DEPARTMENT":return{...r,departments:r.departments.filter(s=>s.id!==n.payload)};case"ASSIGN_MANAGER":return{...r,departments:r.departments.map(s=>s.id===n.payload.departmentId?{...s,managerId:n.payload.staffId}:s)};default:return r}}function ly(r,n){switch(n.type){case"ADD_STAFF":return{...r,staff:[...r.staff,n.payload]};case"UPDATE_STAFF":return{...r,staff:r.staff.map(s=>s.id===n.payload.id?{...s,...n.payload}:s)};case"DELETE_STAFF":return{...r,staff:r.staff.filter(s=>s.id!==n.payload)};default:return r}}function uy(r,n){switch(n.type){case"ADD_FUNCTION":return{...r,functions:[...r.functions,n.payload]};case"UPDATE_FUNCTION":return{...r,functions:r.functions.map(s=>s.id===n.payload.id?{...s,...n.payload}:s)};case"DELETE_FUNCTION":return{...r,functions:r.functions.filter(s=>s.id!==n.payload)};default:return r}}function cy(r,n){switch(n.type){case"ADD_RESPONSIBILITY":return{...r,responsibilities:[...r.responsibilities,n.payload]};case"UPDATE_RESPONSIBILITY":return{...r,responsibilities:r.responsibilities.map(s=>s.id===n.payload.id?{...s,...n.payload}:s)};case"DELETE_RESPONSIBILITY":return{...r,responsibilities:r.responsibilities.filter(s=>s.id!==n.payload)};case"TRANSFER_RESPONSIBILITY":return{...r,responsibilities:r.responsibilities.map(s=>s.id===n.payload.id?{...s,functionId:n.payload.newFunctionId}:s)};default:return r}}function dy(r,n){switch(n.type){case"ADD_WORKFLOW":return{...r,workflows:[...r.workflows,n.payload.workflow],workflowSteps:[...r.workflowSteps,...n.payload.steps]};case"UPDATE_WORKFLOW":return{...r,workflows:r.workflows.map(s=>s.id===n.payload.workflow.id?{...s,...n.payload.workflow}:s),workflowSteps:[...r.workflowSteps.filter(s=>s.workflowId!==n.payload.workflow.id),...n.payload.steps]};case"DELETE_WORKFLOW":return{...r,workflows:r.workflows.filter(s=>s.id!==n.payload),workflowSteps:r.workflowSteps.filter(s=>s.workflowId!==n.payload)};default:return r}}function hy(r,n){switch(n.type){case"ADD_TEAM":return{...r,crossFunctionalTeams:[...r.crossFunctionalTeams,n.payload.team],teamMembers:[...r.teamMembers,...n.payload.members]};case"UPDATE_TEAM":return{...r,crossFunctionalTeams:r.crossFunctionalTeams.map(s=>s.id===n.payload.team.id?{...s,...n.payload.team}:s),teamMembers:[...r.teamMembers.filter(s=>s.teamId!==n.payload.team.id),...n.payload.members]};case"DELETE_TEAM":return{...r,crossFunctionalTeams:r.crossFunctionalTeams.filter(s=>s.id!==n.payload),teamMembers:r.teamMembers.filter(s=>s.teamId!==n.payload)};default:return r}}function fy(r,n){switch(n.type){case"ADD_COMPLIANCE_TAG":return{...r,complianceTags:[...r.complianceTags,n.payload]};case"UPDATE_COMPLIANCE_TAG":return{...r,complianceTags:r.complianceTags.map(s=>s.id===n.payload.id?{...s,...n.payload}:s)};case"DELETE_COMPLIANCE_TAG":return{...r,complianceTags:r.complianceTags.filter(s=>s.id!==n.payload)};case"ADD_COMPANY_NUMBER":return{...r,companyNumbers:[...r.companyNumbers,...n.payload]};case"DELETE_COMPANY_NUMBER":return{...r,companyNumbers:r.companyNumbers.filter(s=>s.id!==n.payload),companyNumberAllocations:r.companyNumberAllocations.filter(s=>s.companyNumberId!==n.payload)};case"ALLOCATE_NUMBER":return{...r,companyNumberAllocations:[...r.companyNumberAllocations,n.payload]};case"RELEASE_NUMBER":return{...r,companyNumberAllocations:r.companyNumberAllocations.filter(s=>s.id!==n.payload)};case"UPDATE_APP_SETTINGS":return{...r,appSettings:{...r.appSettings,...n.payload}};case"UPDATE_COMPANY_PROFILE":return{...r,companyProfile:{...r.companyProfile,...n.payload}};case"ADD_GRADE":return{...r,grades:[...r.grades,n.payload]};case"UPDATE_GRADE":return{...r,grades:r.grades.map(s=>s.id===n.payload.id?{...s,...n.payload}:s)};case"DELETE_GRADE":return{...r,grades:r.grades.filter(s=>s.id!==n.payload)};case"UPDATE_USER_ROLE":return{...r,users:r.users.map(s=>s.id===n.payload.userId?{...s,role:n.payload.role}:s)};default:return r}}const my=[oy,ly,uy,cy,dy,hy,fy];function py(r,n){return my.reduce((s,o)=>o(s,n),r)}const Qh=A.createContext(null),Yh=A.createContext(null),Xh=A.createContext(null);function rt(){const r=A.useContext(Qh);if(r===null)throw new Error("useAppState must be used within an AppStateContext provider");return r}function jt(){const r=A.useContext(Yh);if(r===null)throw new Error("useAppDispatch must be used within an AppDispatchContext provider");return r}function gy(){const r=A.useContext(Xh);if(r===null)throw new Error("useNavigation must be used within a NavigationContext provider");return r}/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yy=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Zh=(...r)=>r.filter((n,s,o)=>!!n&&o.indexOf(n)===s).join(" ");/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var vy={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xy=A.forwardRef(({color:r="currentColor",size:n=24,strokeWidth:s=2,absoluteStrokeWidth:o,className:u="",children:d,iconNode:f,...m},p)=>A.createElement("svg",{ref:p,...vy,width:n,height:n,stroke:r,strokeWidth:o?Number(s)*24/Number(n):s,className:Zh("lucide",u),...m},[...f.map(([y,v])=>A.createElement(y,v)),...Array.isArray(d)?d:[d]]));/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=(r,n)=>{const s=A.forwardRef(({className:o,...u},d)=>A.createElement(xy,{ref:d,iconNode:n,className:Zh(`lucide-${yy(r)}`,o),...u}));return s.displayName=`${r}`,s};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ch=Ne("ArrowLeftRight",[["path",{d:"M8 3 4 7l4 4",key:"9rb6wj"}],["path",{d:"M4 7h16",key:"6tx8e3"}],["path",{d:"m16 21 4-4-4-4",key:"siv7j2"}],["path",{d:"M20 17H4",key:"h6l3hr"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wy=Ne("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cn=Ne("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const by=Ne("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rn=Ne("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const au=Ne("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Th=Ne("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ef=Ne("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aa=Ne("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _y=Ne("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mi=Ne("CircleUser",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ky=Ne("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ia=Ne("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tf=Ne("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nf=Ne("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oa=Ne("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jy=Ne("Gauge",[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ii=Ne("GitBranch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const la=Ne("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rf=Ne("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ui=Ne("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xe=Ne("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sy=Ne("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ss=Ne("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ny=Ne("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ey=Ne("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sf=Ne("Network",[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const An=Ne("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const er=Ne("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hn=Ne("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cy=Ne("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ty=Ne("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ay=Ne("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ca=Ne("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iy=Ne("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ry=Ne("Tags",[["path",{d:"m15 5 6.3 6.3a2.4 2.4 0 0 1 0 3.4L17 19",key:"1cbfv1"}],["path",{d:"M9.586 5.586A2 2 0 0 0 8.172 5H3a1 1 0 0 0-1 1v5.172a2 2 0 0 0 .586 1.414L8.29 18.29a2.426 2.426 0 0 0 3.42 0l3.58-3.58a2.426 2.426 0 0 0 0-3.42z",key:"135mg7"}],["circle",{cx:"6.5",cy:"9.5",r:".5",fill:"currentColor",key:"5pm5xn"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fn=Ne("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oy=Ne("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fi=Ne("UsersRound",[["path",{d:"M18 21a8 8 0 0 0-16 0",key:"3ypg7q"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"M22 20c0-3.37-2-6.5-4-8a5 5 0 0 0-.45-8.3",key:"10s06x"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const br=Ne("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tr=Ne("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Py=3e3;function Dy(){const[r,n]=A.useState([]),s=A.useCallback(u=>{n(d=>d.filter(f=>f.id!==u))},[]),o=A.useCallback((u,d)=>{const f=`toast-${Date.now()}-${Math.random().toString(36).slice(2,6)}`;n(m=>[...m,{id:f,message:u,variant:d}])},[]);return{toasts:r,showToast:o,dismissToast:s}}function Ly({toast:r,onDismiss:n}){A.useEffect(()=>{const o=setTimeout(()=>n(r.id),Py);return()=>clearTimeout(o)},[r.id,n]);const s=r.variant==="success";return i.jsxs("div",{className:`flex items-center gap-2 px-4 py-3 rounded-lg shadow-lg text-sm font-medium text-white transition-all ${s?"bg-green-600":"bg-red-600"}`,children:[s?i.jsx(_y,{className:"w-4 h-4 flex-shrink-0"}):i.jsx(ky,{className:"w-4 h-4 flex-shrink-0"}),i.jsx("span",{className:"flex-1",children:r.message}),i.jsx("button",{onClick:()=>n(r.id),className:"ml-2 hover:opacity-80","aria-label":"Dismiss",children:i.jsx(tr,{className:"w-3.5 h-3.5"})})]})}function $y({toasts:r,onDismiss:n}){return r.length===0?null:i.jsx("div",{className:"fixed bottom-4 right-4 z-50 flex flex-col gap-2 max-w-sm",children:r.map(s=>i.jsx(Ly,{toast:s,onDismiss:n},s.id))})}const af=A.createContext(null);function Vt(){const r=A.useContext(af);if(!r)throw new Error("useShowToast must be used within a ToastContext.Provider");return r.showToast}const My=[{label:"VIEWS",items:[{id:"org-chart",label:"Org Chart",icon:sf},{id:"compliance",label:"Compliance",icon:ca},{id:"workflows",label:"Workflows",icon:Ii}]},{label:"PEOPLE & STRUCTURE",items:[{id:"departments",label:"Departments",icon:Cn},{id:"functions",label:"Functions",icon:Ui},{id:"responsibilities",label:"Responsibilities",icon:ia},{id:"grades",label:"Grades",icon:rf},{id:"staff",label:"Staff",icon:Mi},{id:"cross-functional-teams",label:"Cross-Functional Teams",icon:Fi}]},{label:"TOOLS",items:[{id:"workflow-manager",label:"Workflow Manager",icon:Ay},{id:"email-card-creator",label:"Email & Card Creator",icon:ss},{id:"contact-manager",label:"Contact Manager",icon:er}]},{label:"ADMIN",items:[{id:"user-management",label:"User Management",icon:br},{id:"email-format",label:"Email Format",icon:ss},{id:"company-numbers",label:"Company Numbers",icon:er},{id:"compliance-tags",label:"Compliance Tags",icon:Ry},{id:"manager-threshold",label:"Manager Threshold",icon:jy},{id:"company-profile",label:"Company Profile",icon:by}]}];function Uy({isOpen:r}){const{currentPage:n,navigate:s}=gy(),o=rt();return i.jsxs("aside",{className:`fixed left-0 top-0 h-full bg-white border-r border-gray-200 z-40 transition-all duration-200 flex flex-col ${r?"w-64":"w-0 overflow-hidden"}`,children:[i.jsxs("div",{className:"flex items-center gap-3 px-4 py-4 border-b border-gray-100",children:[i.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center flex-shrink-0",children:i.jsx(Cn,{className:"w-4 h-4 text-white"})}),i.jsx("span",{className:"font-semibold text-gray-900 text-sm truncate",children:o.companyProfile.name||"Acme Inc."})]}),i.jsx("nav",{className:"flex-1 overflow-y-auto py-3 px-3",children:My.map(u=>i.jsxs("div",{className:"mb-4",children:[i.jsx("p",{className:"text-[10px] font-semibold text-gray-400 uppercase tracking-wider px-3 mb-1.5",children:u.label}),u.items.map(d=>{const f=d.icon,m=n===d.id;return i.jsxs("button",{onClick:()=>s(d.id),className:`w-full flex items-center gap-3 px-3 py-2 rounded-lg text-sm transition-colors ${m?"bg-blue-50 text-blue-700 font-medium":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"}`,children:[i.jsx(f,{className:"w-4 h-4 flex-shrink-0"}),i.jsx("span",{className:"truncate",children:d.label})]},d.id)})]},u.label))})]})}function Fy({sidebarOpen:r,onToggleSidebar:n}){var v,b;const{user:s,role:o,signOut:u}=su(),[d,f]=A.useState(!1),m=((b=(v=s==null?void 0:s.email)==null?void 0:v[0])==null?void 0:b.toUpperCase())??"U",p=o??"User";async function y(){f(!0);try{await u()}catch{f(!1)}}return i.jsxs("header",{className:"h-12 bg-white border-b border-gray-200 flex items-center justify-between px-4 fixed top-0 right-0 z-30",style:{left:r?256:0},children:[i.jsx("button",{onClick:n,className:"text-gray-400 hover:text-gray-600 transition-colors",children:i.jsx(Ey,{className:"w-5 h-5"})}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center",children:i.jsx("span",{className:"text-white text-xs font-medium",children:m})}),i.jsxs("span",{className:"text-xs text-gray-500 flex items-center gap-1",children:[i.jsx(Mi,{className:"w-3.5 h-3.5"}),p]}),i.jsxs("button",{onClick:y,disabled:d,className:"text-xs text-gray-400 hover:text-red-600 transition-colors flex items-center gap-1 disabled:opacity-50",title:"Sign out",children:[i.jsx(Sy,{className:"w-3.5 h-3.5"}),i.jsx("span",{className:"hidden sm:inline",children:d?"Signing out...":"Sign out"})]})]})]})}function ot({title:r,subtitle:n,action:s}){return i.jsxs("div",{className:"flex items-start justify-between mb-6",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:r}),n&&i.jsx("p",{className:"text-sm text-gray-500 mt-1",children:n})]}),s&&i.jsx("div",{children:s})]})}function sn({cards:r}){return i.jsx("div",{className:"grid gap-4",style:{gridTemplateColumns:`repeat(${Math.min(r.length,5)}, minmax(0, 1fr))`},children:r.map((n,s)=>i.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4 flex items-start gap-3",children:[n.icon&&i.jsx("div",{className:"mt-0.5",children:n.icon}),i.jsxs("div",{className:"min-w-0",children:[i.jsx("p",{className:"text-xs text-gray-500 font-medium",children:n.label}),i.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-0.5",children:n.value}),n.sub&&i.jsx("p",{className:"text-xs text-gray-400 mt-0.5",children:n.sub})]})]},s))})}function an({columns:r,data:n,emptyMessage:s="No data found."}){return n.length===0?i.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:i.jsx("p",{className:"text-gray-400 text-sm",children:s})}):i.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-x-auto",children:i.jsxs("table",{className:"w-full text-sm",children:[i.jsx("thead",{children:i.jsx("tr",{className:"border-b border-gray-100",children:r.map(o=>i.jsx("th",{className:`px-4 py-3 text-left font-medium text-gray-500 whitespace-nowrap ${o.className??""}`,style:o.width?{width:o.width}:void 0,children:o.header},o.key))})}),i.jsx("tbody",{children:n.map((o,u)=>i.jsx("tr",{className:"border-b border-gray-50 hover:bg-gray-50/50 transition-colors",children:r.map(d=>i.jsx("td",{className:`px-4 py-3 text-gray-700 ${d.cellClassName??""}`,children:d.render?d.render(o):String(o[d.key]??"")},d.key))},o.id??u))})]})})}function Ze({isOpen:r,onClose:n,title:s,children:o,footer:u,width:d="max-w-lg"}){return r?i.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:n}),i.jsxs("div",{className:`relative bg-white rounded-xl shadow-xl ${d} w-full mx-4 max-h-[90vh] flex flex-col`,children:[i.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-100",children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:s}),i.jsx("button",{onClick:n,className:"text-gray-400 hover:text-gray-600 transition-colors",children:i.jsx(tr,{className:"w-5 h-5"})})]}),i.jsx("div",{className:"px-6 py-4 overflow-y-auto flex-1",children:o}),u&&i.jsx("div",{className:"flex items-center justify-end gap-3 px-6 py-4 border-t border-gray-100",children:u})]})]}):null}const Ah={success:"bg-green-50 text-green-700 border border-green-200",warning:"bg-amber-50 text-amber-700 border border-amber-200",error:"bg-red-50 text-red-700 border border-red-200",info:"bg-blue-50 text-blue-700 border border-blue-200",neutral:"bg-gray-50 text-gray-600 border border-gray-200",md:"bg-blue-100 text-blue-700 border border-blue-200",manager:"bg-orange-100 text-orange-700 border border-orange-200",senior:"bg-slate-100 text-slate-600 border border-slate-200",staff:"bg-gray-100 text-gray-500 border border-gray-200"};function Le({children:r,variant:n="neutral",className:s=""}){const o=Ah[n]||Ah.neutral;return i.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium whitespace-nowrap ${o} ${s}`,children:r})}function zy(){const r=rt(),n=jt(),s=Vt(),[o,u]=A.useState(!1),[d,f]=A.useState(null),[m,p]=A.useState(null),[y,v]=A.useState(""),[b,_]=A.useState(!1),w=r.complianceTags,T=new Set(r.responsibilities.filter(M=>M.complianceTagId).map(M=>M.complianceTagId)),j=[{icon:i.jsx(Iy,{className:"w-5 h-5"}),label:"Total Tags",value:w.length},{label:"Active",value:w.filter(M=>T.has(M.id)).length,sub:"In use by responsibilities"},{label:"Unused",value:w.filter(M=>!T.has(M.id)).length}];function E(){v(""),u(!0)}function D(M){v(M.name),f(M)}async function V(){if(!y.trim())return;_(!0);const{data:M,error:Y}=await Se.create("compliance_tag",{name:y.trim()});if(_(!1),Y||!M){s(`Failed to add tag: ${Y??"Unknown error"}`,"error");return}n({type:"ADD_COMPLIANCE_TAG",payload:M}),s("Compliance tag added","success"),u(!1),v("")}async function z(){if(!d||!y.trim())return;_(!0);const{data:M,error:Y}=await Se.update("compliance_tag",d.id,{name:y.trim()});if(_(!1),Y||!M){s(`Failed to update tag: ${Y??"Unknown error"}`,"error");return}n({type:"UPDATE_COMPLIANCE_TAG",payload:M}),s("Compliance tag updated","success"),f(null),v("")}async function q(){if(!m)return;_(!0);const{error:M}=await Se.remove("compliance_tag",m.id);if(_(!1),M){s(`Failed to delete tag: ${M}`,"error");return}n({type:"DELETE_COMPLIANCE_TAG",payload:m.id}),s("Compliance tag deleted","success"),p(null)}const $=[{key:"name",header:"Tag Name",render:M=>M.name},{key:"status",header:"Status",render:M=>T.has(M.id)?i.jsx(Le,{variant:"success",children:"Active"}):i.jsx(Le,{variant:"neutral",children:"Unused"})},{key:"actions",header:"Actions",render:M=>i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>D(M),className:"p-1 text-gray-400 hover:text-blue-600 rounded",title:"Edit",children:i.jsx(An,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>p(M),className:"p-1 text-gray-400 hover:text-red-600 rounded",title:"Delete",disabled:T.has(M.id),children:i.jsx(fn,{className:"w-4 h-4"})})]})}];return i.jsxs("div",{className:"space-y-6",children:[i.jsx(ot,{title:"Compliance Tags",subtitle:"Manage compliance type labels used by responsibilities",action:i.jsxs("button",{onClick:E,className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700",children:[i.jsx(hn,{className:"w-4 h-4"}),"Add Tag"]})}),i.jsx(sn,{cards:j}),i.jsx(an,{columns:$,data:w,emptyMessage:"No compliance tags defined"}),i.jsx(Ze,{isOpen:o,title:"Add Compliance Tag",onClose:()=>u(!1),children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Tag Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",value:y,onChange:M=>v(M.target.value),placeholder:"e.g. Annual, Transactional",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",autoFocus:!0})]}),i.jsxs("div",{className:"flex justify-end gap-3",children:[i.jsx("button",{onClick:()=>u(!1),className:"px-4 py-2 text-sm text-gray-600 hover:text-gray-800",children:"Cancel"}),i.jsxs("button",{onClick:V,disabled:!y.trim()||b,className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[b&&i.jsx(Xe,{className:"w-4 h-4 animate-spin"}),b?"Saving...":"Add Tag"]})]})]})}),i.jsx(Ze,{isOpen:!!d,title:"Edit Compliance Tag",onClose:()=>f(null),children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Tag Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",value:y,onChange:M=>v(M.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",autoFocus:!0})]}),i.jsxs("div",{className:"flex justify-end gap-3",children:[i.jsx("button",{onClick:()=>f(null),className:"px-4 py-2 text-sm text-gray-600 hover:text-gray-800",children:"Cancel"}),i.jsxs("button",{onClick:z,disabled:!y.trim()||b,className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[b&&i.jsx(Xe,{className:"w-4 h-4 animate-spin"}),b?"Saving...":"Save Changes"]})]})]})}),i.jsx(Ze,{isOpen:!!m,title:"Delete Compliance Tag",onClose:()=>p(null),children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("p",{className:"text-sm text-gray-600",children:["Are you sure you want to delete ",i.jsxs("span",{className:"font-medium text-gray-900",children:['"',m==null?void 0:m.name,'"']}),"? This action cannot be undone."]}),i.jsxs("div",{className:"flex justify-end gap-3",children:[i.jsx("button",{onClick:()=>p(null),className:"px-4 py-2 text-sm text-gray-600 hover:text-gray-800",children:"Cancel"}),i.jsxs("button",{onClick:q,disabled:b,className:"inline-flex items-center gap-2 px-4 py-2 bg-red-600 text-white text-sm font-medium rounded-lg hover:bg-red-700 disabled:opacity-50",children:[b&&i.jsx(Xe,{className:"w-4 h-4 animate-spin"}),b?"Deleting...":"Delete"]})]})]})})]})}function By(){const r=rt(),n=jt(),s=Vt(),[o,u]=A.useState(!1),[d,f]=A.useState(null),[m,p]=A.useState(null),[y,v]=A.useState(""),[b,_]=A.useState(""),[w,T]=A.useState(!1),j=[...r.grades].sort((K,ve)=>K.level-ve.level),E=K=>r.staff.filter(ve=>ve.gradeId===K).length,D=K=>new Set(r.staff.filter(xe=>xe.gradeId===K).map(xe=>xe.departmentId)).size,V=[{icon:i.jsx(wy,{className:"w-5 h-5"}),label:"Total Grades",value:j.length},{label:"Active",value:j.filter(K=>E(K.id)>0).length,sub:"With assigned staff"},{label:"Unused",value:j.filter(K=>E(K.id)===0).length}];function z(){v(""),_(""),u(!0)}function q(K){v(K.name),_(String(K.level)),f(K)}async function $(){if(!y.trim()||b==="")return;T(!0);const{data:K,error:ve}=await Se.create("grade",{name:y.trim(),level:Number(b)});if(T(!1),ve||!K){s(`Failed to add grade: ${ve??"Unknown error"}`,"error");return}n({type:"ADD_GRADE",payload:K}),s("Grade added","success"),u(!1)}async function M(){if(!d||!y.trim()||b==="")return;T(!0);const{data:K,error:ve}=await Se.update("grade",d.id,{name:y.trim(),level:Number(b)});if(T(!1),ve||!K){s(`Failed to update grade: ${ve??"Unknown error"}`,"error");return}n({type:"UPDATE_GRADE",payload:K}),s("Grade updated","success"),f(null)}async function Y(){if(!m)return;T(!0);const{error:K}=await Se.remove("grade",m.id);if(T(!1),K){s(`Failed to delete grade: ${K}`,"error");return}n({type:"DELETE_GRADE",payload:m.id}),s("Grade deleted","success"),p(null)}const re=[{key:"level",header:"Level",render:K=>i.jsx("span",{children:K.level})},{key:"name",header:"Grade Name",render:K=>K.name},{key:"headcount",header:"Headcount",render:K=>i.jsx("span",{children:E(K.id)})},{key:"departments",header:"Departments",render:K=>i.jsx("span",{children:D(K.id)})},{key:"status",header:"Status",render:K=>E(K.id)>0?i.jsx(Le,{variant:"success",children:"Active"}):i.jsx(Le,{variant:"neutral",children:"Unused"})},{key:"actions",header:"Actions",render:K=>i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>q(K),className:"p-1 text-gray-400 hover:text-blue-600 rounded",title:"Edit",children:i.jsx(An,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>p(K),className:"p-1 text-gray-400 hover:text-red-600 rounded",title:"Delete",disabled:E(K.id)>0,children:i.jsx(fn,{className:"w-4 h-4"})})]})}];return i.jsxs("div",{className:"space-y-6",children:[i.jsx(ot,{title:"Grades",subtitle:"Manage organisational grade levels",action:i.jsxs("button",{onClick:z,className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700",children:[i.jsx(hn,{className:"w-4 h-4"}),"Add Grade"]})}),i.jsx(sn,{cards:V}),i.jsx(an,{columns:re,data:j,emptyMessage:"No grades defined"}),i.jsx(Ze,{isOpen:o,title:"Add Grade",onClose:()=>u(!1),children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Grade Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",value:y,onChange:K=>v(K.target.value),placeholder:"e.g. Manager, Senior, Staff",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",autoFocus:!0})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Level ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",value:b,onChange:K=>_(K.target.value),placeholder:"0 = highest (MD), 1, 2...",min:0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),i.jsxs("div",{className:"flex justify-end gap-3",children:[i.jsx("button",{onClick:()=>u(!1),className:"px-4 py-2 text-sm text-gray-600 hover:text-gray-800",children:"Cancel"}),i.jsxs("button",{onClick:$,disabled:!y.trim()||b===""||w,className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[w&&i.jsx(Xe,{className:"w-4 h-4 animate-spin"}),w?"Saving...":"Add Grade"]})]})]})}),i.jsx(Ze,{isOpen:!!d,title:"Edit Grade",onClose:()=>f(null),children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Grade Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",value:y,onChange:K=>v(K.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",autoFocus:!0})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Level ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"number",value:b,onChange:K=>_(K.target.value),min:0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),i.jsxs("div",{className:"flex justify-end gap-3",children:[i.jsx("button",{onClick:()=>f(null),className:"px-4 py-2 text-sm text-gray-600 hover:text-gray-800",children:"Cancel"}),i.jsxs("button",{onClick:M,disabled:!y.trim()||b===""||w,className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[w&&i.jsx(Xe,{className:"w-4 h-4 animate-spin"}),w?"Saving...":"Save Changes"]})]})]})}),i.jsx(Ze,{isOpen:!!m,title:"Delete Grade",onClose:()=>p(null),children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("p",{className:"text-sm text-gray-600",children:["Are you sure you want to delete grade ",i.jsxs("span",{className:"font-medium text-gray-900",children:['"',m==null?void 0:m.name,'" (Level ',m==null?void 0:m.level,")"]}),"? This action cannot be undone."]}),i.jsxs("div",{className:"flex justify-end gap-3",children:[i.jsx("button",{onClick:()=>p(null),className:"px-4 py-2 text-sm text-gray-600 hover:text-gray-800",children:"Cancel"}),i.jsxs("button",{onClick:Y,disabled:w,className:"inline-flex items-center gap-2 px-4 py-2 bg-red-600 text-white text-sm font-medium rounded-lg hover:bg-red-700 disabled:opacity-50",children:[w&&i.jsx(Xe,{className:"w-4 h-4 animate-spin"}),w?"Deleting...":"Delete"]})]})]})})]})}const Wy=[{value:as.FirstnameL,label:"firstname.L",example:"jane.d@company.com"},{value:as.FLastname,label:"F.lastname",example:"j.doe@company.com"}];function qy(){const r=rt(),n=jt(),s=Vt(),o=r.appSettings,[u,d]=A.useState(o.emailDomain),[f,m]=A.useState(o.emailFormat),[p,y]=A.useState(!1);A.useEffect(()=>{d(o.emailDomain),m(o.emailFormat)},[o.emailDomain,o.emailFormat]);const v=u!==o.emailDomain||f!==o.emailFormat,b=f===as.FirstnameL?`jane.d@${u||"domain.com"}`:`j.doe@${u||"domain.com"}`;async function _(){y(!0);const{data:w,error:T}=await Se.upsertSingleton("app_settings",{emailDomain:u.trim(),emailFormat:f,maxManagerGradeLevel:o.maxManagerGradeLevel});if(y(!1),T||!w){s(`Failed to save: ${T??"Unknown error"}`,"error");return}n({type:"UPDATE_APP_SETTINGS",payload:w}),s("Email format settings saved","success")}return i.jsxs("div",{className:"space-y-6",children:[i.jsx(ot,{title:"Email Format",subtitle:"Configure how staff email addresses are generated"}),i.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6 max-w-xl",children:i.jsxs("div",{className:"space-y-5",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Domain"}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-sm text-gray-500",children:"@"}),i.jsx("input",{type:"text",value:u,onChange:w=>d(w.target.value),placeholder:"company.com",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Format"}),i.jsx("div",{className:"space-y-2",children:Wy.map(w=>i.jsxs("label",{className:`flex items-center gap-3 p-3 border rounded-lg cursor-pointer transition-colors ${f===w.value?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:[i.jsx("input",{type:"radio",name:"emailFormat",value:w.value,checked:f===w.value,onChange:()=>m(w.value),className:"text-blue-600"}),i.jsxs("div",{children:[i.jsx("span",{className:"text-sm font-medium text-gray-900",children:w.label}),i.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:["e.g. ",w.example]})]})]},w.value))})]}),i.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[i.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Preview"}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(ss,{className:"w-4 h-4 text-gray-400"}),i.jsx("span",{className:"text-sm font-medium text-gray-700",children:b})]})]}),i.jsx("div",{className:"flex justify-end",children:i.jsxs("button",{onClick:_,disabled:!v||!u.trim()||p,className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[p&&i.jsx(Xe,{className:"w-4 h-4 animate-spin"}),p?"Saving...":"Save Changes"]})})]})})]})}function Vy(){const r=rt(),n=jt(),s=Vt(),o=r.appSettings,u=[...r.grades].sort((w,T)=>w.level-T.level),[d,f]=A.useState(String(o.maxManagerGradeLevel)),[m,p]=A.useState(!1);A.useEffect(()=>{f(String(o.maxManagerGradeLevel))},[o.maxManagerGradeLevel]);const y=Number(d)!==o.maxManagerGradeLevel,v=u.find(w=>w.level===Number(d)),b=r.departments.filter(w=>{if(!w.managerId)return!1;const T=r.staff.find(E=>E.id===w.managerId);if(!(T!=null&&T.gradeId))return!1;const j=r.grades.find(E=>E.id===T.gradeId);return j&&j.level>Number(d)});async function _(){p(!0);const{data:w,error:T}=await Se.upsertSingleton("app_settings",{emailDomain:o.emailDomain,emailFormat:o.emailFormat,maxManagerGradeLevel:Number(d)});if(p(!1),T||!w){s(`Failed to save: ${T??"Unknown error"}`,"error");return}n({type:"UPDATE_APP_SETTINGS",payload:w}),s("Manager threshold updated","success")}return i.jsxs("div",{className:"space-y-6",children:[i.jsx(ot,{title:"Manager Threshold",subtitle:"Set the minimum grade level required for a department manager to be considered 'Managed'"}),i.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6 max-w-xl",children:i.jsxs("div",{className:"space-y-5",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Maximum Manager Grade Level"}),i.jsx("p",{className:"text-xs text-gray-500 mb-3",children:'Managers at or below this level count as "Managed". Above this level shows as "Acting".'}),u.length>0?i.jsx("select",{value:d,onChange:w=>f(w.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:u.map(w=>i.jsxs("option",{value:w.level,children:["Level ",w.level,"  ",w.name]},w.id))}):i.jsxs("div",{children:[i.jsx("input",{type:"number",value:d,onChange:w=>f(w.target.value),min:0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"}),i.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"No grades defined yet  enter a numeric level"})]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-2",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(ca,{className:"w-4 h-4 text-blue-500"}),i.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["Threshold: ",v?`Level ${v.level} (${v.name})`:`Level ${d}`]})]}),b.length>0&&i.jsxs("p",{className:"text-xs text-amber-600",children:[b.length," department",b.length>1?"s":"",' would show as "Acting" with this threshold']}),b.length===0&&r.departments.length>0&&i.jsx("p",{className:"text-xs text-green-600",children:'All managed departments qualify as "Managed" at this threshold'})]}),i.jsx("div",{className:"flex justify-end",children:i.jsxs("button",{onClick:_,disabled:!y||m,className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[m&&i.jsx(Xe,{className:"w-4 h-4 animate-spin"}),m?"Saving...":"Save Changes"]})})]})})]})}function mn({value:r,onChange:n,placeholder:s="Search..."}){return i.jsxs("div",{className:"relative",children:[i.jsx(Ty,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),i.jsx("input",{type:"text",value:r,onChange:o=>n(o.target.value),placeholder:s,className:"w-full pl-9 pr-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}function Hy(){const r=rt(),n=jt(),s=Vt(),[o,u]=A.useState(""),[d,f]=A.useState(!1),[m,p]=A.useState("single"),[y,v]=A.useState(""),[b,_]=A.useState(""),[w,T]=A.useState(""),[j,E]=A.useState(""),[D,V]=A.useState(null),[z,q]=A.useState(!1),$=r.companyNumbers,M=r.companyNumberAllocations,Y=ie=>M.some(he=>he.companyNumberId===ie),re=$.filter(ie=>ie.phoneNumber.toLowerCase().includes(o.toLowerCase())),K=$.filter(ie=>Y(ie.id)).length,ve=[{icon:i.jsx(er,{className:"w-5 h-5"}),label:"Total Numbers",value:$.length},{label:"Allocated",value:K},{label:"Available",value:$.length-K}];function xe(){v(""),_(""),T(""),E(""),p("single"),f(!0)}async function _e(){if(!y.trim())return;q(!0);const{data:ie,error:he}=await Se.create("company_number",{phoneNumber:y.trim()});if(q(!1),he||!ie){s(`Failed to add number: ${he??"Unknown error"}`,"error");return}n({type:"ADD_COMPANY_NUMBER",payload:[ie]}),s("Number added","success"),f(!1)}async function Ce(){if(!b.trim()||!w||!j)return;const ie=Number(w),he=Number(j);if(ie>he||he-ie>999){s("Invalid range (max 1000 numbers at a time)","error");return}q(!0);const x=[],B=[];for(let G=ie;G<=he;G++){const C=`${b.trim()}${String(G).padStart(4,"0")}`,{data:N,error:ae}=await Se.create("company_number",{phoneNumber:C});ae||!N?B.push(C):x.push(N)}q(!1),x.length>0&&n({type:"ADD_COMPANY_NUMBER",payload:x}),B.length>0?s(`Added ${x.length} numbers. ${B.length} failed (possibly duplicates).`,B.length===he-ie+1?"error":"success"):s(`Added ${x.length} numbers`,"success"),f(!1)}async function Ie(){if(!D)return;q(!0);const{error:ie}=await Se.remove("company_number",D.id);if(q(!1),ie){s(`Failed to delete: ${ie}`,"error");return}n({type:"DELETE_COMPANY_NUMBER",payload:D.id}),s("Number deleted","success"),V(null)}const Re=[{key:"phoneNumber",header:"Phone Number",render:ie=>i.jsx("span",{className:"font-mono text-sm",children:ie.phoneNumber})},{key:"status",header:"Status",render:ie=>Y(ie.id)?i.jsx(Le,{variant:"info",children:"Allocated"}):i.jsx(Le,{variant:"success",children:"Available"})},{key:"actions",header:"Actions",render:ie=>i.jsx("button",{onClick:()=>V(ie),className:"p-1 text-gray-400 hover:text-red-600 rounded",title:"Delete",disabled:Y(ie.id),children:i.jsx(fn,{className:"w-4 h-4"})})}];return i.jsxs("div",{className:"space-y-6",children:[i.jsx(ot,{title:"Company Numbers",subtitle:"Manage the pool of phone numbers available for allocation",action:i.jsxs("button",{onClick:xe,className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700",children:[i.jsx(hn,{className:"w-4 h-4"}),"Add Numbers"]})}),i.jsx(sn,{cards:ve}),i.jsx("div",{className:"max-w-xs",children:i.jsx(mn,{value:o,onChange:u,placeholder:"Search numbers..."})}),i.jsx(an,{columns:Re,data:re,emptyMessage:"No company numbers defined"}),i.jsx(Ze,{isOpen:d,title:"Add Company Numbers",onClose:()=>f(!1),children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex border-b border-gray-200",children:[i.jsx("button",{onClick:()=>p("single"),className:`px-4 py-2 text-sm font-medium border-b-2 transition-colors ${m==="single"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"Single Number"}),i.jsx("button",{onClick:()=>p("range"),className:`px-4 py-2 text-sm font-medium border-b-2 transition-colors ${m==="range"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"Range of Numbers"})]}),m==="single"?i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number"}),i.jsx("input",{type:"text",value:y,onChange:ie=>v(ie.target.value),placeholder:"e.g. 045555501",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",autoFocus:!0})]}):i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Number Prefix"}),i.jsx("input",{type:"text",value:b,onChange:ie=>_(ie.target.value),placeholder:"e.g. 04555",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",autoFocus:!0})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start"}),i.jsx("input",{type:"number",value:w,onChange:ie=>T(ie.target.value),placeholder:"e.g. 5501",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End"}),i.jsx("input",{type:"number",value:j,onChange:ie=>E(ie.target.value),placeholder:"e.g. 5510",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),b&&w&&j&&i.jsxs("p",{className:"text-xs text-gray-500",children:["Will create ",Math.max(0,Number(j)-Number(w)+1)," numbers from ",b,String(Number(w)).padStart(4,"0")," to ",b,String(Number(j)).padStart(4,"0")]})]}),i.jsxs("div",{className:"flex justify-end gap-3",children:[i.jsx("button",{onClick:()=>f(!1),className:"px-4 py-2 text-sm text-gray-600 hover:text-gray-800",children:"Cancel"}),i.jsxs("button",{onClick:m==="single"?_e:Ce,disabled:z||m==="single"&&!y.trim()||m==="range"&&(!b.trim()||!w||!j),className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[z&&i.jsx(Xe,{className:"w-4 h-4 animate-spin"}),z?"Adding...":"Add"]})]})]})}),i.jsx(Ze,{isOpen:!!D,title:"Delete Number",onClose:()=>V(null),children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("p",{className:"text-sm text-gray-600",children:["Are you sure you want to delete ",i.jsx("span",{className:"font-mono font-medium text-gray-900",children:D==null?void 0:D.phoneNumber}),"? This action cannot be undone."]}),i.jsxs("div",{className:"flex justify-end gap-3",children:[i.jsx("button",{onClick:()=>V(null),className:"px-4 py-2 text-sm text-gray-600 hover:text-gray-800",children:"Cancel"}),i.jsxs("button",{onClick:Ie,disabled:z,className:"inline-flex items-center gap-2 px-4 py-2 bg-red-600 text-white text-sm font-medium rounded-lg hover:bg-red-700 disabled:opacity-50",children:[z&&i.jsx(Xe,{className:"w-4 h-4 animate-spin"}),z?"Deleting...":"Delete"]})]})]})})]})}function Gy(){const r=rt(),n=jt(),s=Vt(),o=r.companyProfile,[u,d]=A.useState(o.name),[f,m]=A.useState(o.location),[p,y]=A.useState(o.website),[v,b]=A.useState(o.logoUrl),[_,w]=A.useState(!1);A.useEffect(()=>{d(o.name),m(o.location),y(o.website),b(o.logoUrl)},[o.name,o.location,o.website,o.logoUrl]);const T=u!==o.name||f!==o.location||p!==o.website||v!==o.logoUrl;async function j(){w(!0);const{data:E,error:D}=await Se.upsertSingleton("company_profile",{name:u.trim(),location:f.trim(),website:p.trim(),logoUrl:v.trim()});if(w(!1),D||!E){s(`Failed to save: ${D??"Unknown error"}`,"error");return}n({type:"UPDATE_COMPANY_PROFILE",payload:E}),s("Company profile saved","success")}return i.jsxs("div",{className:"space-y-6",children:[i.jsx(ot,{title:"Company Profile",subtitle:"Manage your organisation's basic information"}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[i.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Company Name"}),i.jsx("input",{type:"text",value:u,onChange:E=>d(E.target.value),placeholder:"Acme Corporation",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Location"}),i.jsx("input",{type:"text",value:f,onChange:E=>m(E.target.value),placeholder:"Abu Dhabi, UAE",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Website"}),i.jsx("input",{type:"text",value:p,onChange:E=>y(E.target.value),placeholder:"https://www.company.com",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Logo URL"}),i.jsx("input",{type:"text",value:v,onChange:E=>b(E.target.value),placeholder:"https://www.company.com/logo.png",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),i.jsx("div",{className:"flex justify-end",children:i.jsxs("button",{onClick:j,disabled:!T||_,className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[_&&i.jsx(Xe,{className:"w-4 h-4 animate-spin"}),_?"Saving...":"Save Changes"]})})]})}),i.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[i.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-4",children:"Preview"}),i.jsxs("div",{className:"flex items-start gap-4",children:[v?i.jsx("img",{src:v,alt:"Logo",className:"w-16 h-16 rounded-lg object-cover border border-gray-200",onError:E=>{E.target.style.display="none"}}):i.jsx("div",{className:"w-16 h-16 rounded-lg bg-blue-50 border border-blue-200 flex items-center justify-center",children:i.jsx(Cn,{className:"w-8 h-8 text-blue-400"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:u||"Company Name"}),f&&i.jsxs("p",{className:"text-sm text-gray-500 flex items-center gap-1 mt-1",children:[i.jsx(Ny,{className:"w-3.5 h-3.5"}),f]}),p&&i.jsxs("p",{className:"text-sm text-blue-600 flex items-center gap-1 mt-1",children:[i.jsx(la,{className:"w-3.5 h-3.5"}),p]})]})]})]})]})]})}function Ks(r,n,s,o){if(!r.managerId)return Rt.Unmanaged;const u=n.find(f=>f.id===r.managerId);if(!u)return Rt.Unmanaged;const d=s.find(f=>f.id===u.gradeId);return d?d.level<=o?Rt.Managed:Rt.Acting:Rt.Unmanaged}function pt(r){return`${r.firstName} ${r.lastName}`}function of(r){const n=parseInt(r.uid,10);return`+971 50 111 ${String(n).padStart(4,"0")}`}const Ky={primary:"bg-blue-600 hover:bg-blue-700 text-white",danger:"bg-red-600 hover:bg-red-700 text-white",secondary:"bg-white hover:bg-gray-50 text-gray-700 border border-gray-200"},Jy={sm:"px-3 py-1.5 text-xs",md:"px-4 py-2 text-sm"};function Be({children:r,onClick:n,icon:s,disabled:o=!1,variant:u="primary",size:d="md"}){return i.jsxs("button",{onClick:n,disabled:o,className:`inline-flex items-center gap-2 rounded-lg font-medium transition-colors disabled:opacity-50 ${Ky[u]} ${Jy[d]}`,children:[s&&i.jsx(s,{className:"w-4 h-4"}),r]})}const Qy={neutral:"text-gray-400 hover:text-gray-600 hover:bg-gray-100",danger:"text-red-400 hover:text-red-600 hover:bg-red-50",primary:"text-blue-500 hover:text-blue-700 hover:bg-blue-50"};function gt({icon:r,onClick:n,variant:s="neutral",title:o=""}){return i.jsx("button",{onClick:n,title:o,className:`p-1.5 rounded-lg transition-colors ${Qy[s]}`,children:i.jsx(r,{className:"w-4 h-4"})})}function Ys({value:r,onChange:n,options:s,placeholder:o="Select..."}){const[u,d]=A.useState(!1),f=A.useRef(null),m=s.find(p=>p.value===r);return A.useEffect(()=>{const p=y=>{f.current&&!f.current.contains(y.target)&&d(!1)};return document.addEventListener("mousedown",p),()=>document.removeEventListener("mousedown",p)},[]),i.jsxs("div",{ref:f,className:"relative",children:[i.jsxs("button",{type:"button",onClick:()=>d(!u),className:"w-full flex items-center justify-between px-3 py-2 border border-gray-200 rounded-lg text-sm bg-white focus:outline-none focus:ring-2 focus:ring-blue-500 text-left",children:[i.jsx("span",{className:m?"text-gray-900":"text-gray-400",children:m?m.label:o}),i.jsx(au,{className:`w-4 h-4 text-gray-400 transition-transform ${u?"rotate-180":""}`})]}),u&&i.jsx("div",{className:"absolute z-50 mt-1 w-full bg-white border border-gray-200 rounded-lg shadow-lg overflow-hidden max-h-60 overflow-y-auto",children:s.map(p=>{const y=p.value===r;return i.jsxs("button",{type:"button",onClick:()=>{n(p.value),d(!1)},className:`w-full flex items-center justify-between px-3 py-2 text-sm text-left transition-colors ${y?"bg-amber-400 text-white font-medium":"text-gray-700 hover:bg-amber-50"}`,children:[i.jsx("span",{children:p.label}),y&&i.jsx(rn,{className:"w-4 h-4 flex-shrink-0"})]},p.value)})})]})}function Yy(){const r=rt(),n=jt(),s=Vt(),[o,u]=A.useState(!1),[d,f]=A.useState(""),[m,p]=A.useState(null),[y,v]=A.useState(""),[b,_]=A.useState(null),[w,T]=A.useState(!1),j=x=>r.staff.filter(B=>B.departmentId===x).length,E=x=>r.functions.filter(B=>B.departmentId===x).length,D=x=>{const B=r.functions.filter(G=>G.departmentId===x).map(G=>G.id);return r.responsibilities.filter(G=>B.includes(G.functionId)).length},V=x=>r.crossFunctionalTeams.filter(B=>B.reportingDepartmentId===x).length,z=x=>x?r.staff.find(B=>B.id===x):void 0,q=x=>x?r.grades.find(B=>B.id===x):void 0,$=r.departments.filter(x=>Ks(x,r.staff,r.grades,r.appSettings.maxManagerGradeLevel)===Rt.Managed).length,M=r.departments.filter(x=>Ks(x,r.staff,r.grades,r.appSettings.maxManagerGradeLevel)===Rt.Acting).length,Y=r.departments.filter(x=>Ks(x,r.staff,r.grades,r.appSettings.maxManagerGradeLevel)===Rt.Unmanaged).length,re=async()=>{const x=d.trim();if(!x)return;T(!0);const{data:B,error:G}=await Se.create("department",{name:x,managerId:null});if(T(!1),G||!B){s(`Failed to add department: ${G??"Unknown error"}`,"error");return}n({type:"ADD_DEPARTMENT",payload:B}),s("Department added","success"),f(""),u(!1)},K=async x=>{if(j(x.id)>0){s("Cannot delete  staff are assigned to this department.","error");return}if(E(x.id)>0){s("Cannot delete  functions exist in this department.","error");return}T(!0);const{error:B}=await Se.remove("department",x.id);if(T(!1),B){s(`Failed to delete department: ${B}`,"error");return}n({type:"DELETE_DEPARTMENT",payload:x.id}),s("Department deleted","success")},ve=x=>{p(x.id),v(x.name)},xe=()=>{p(null),v("")},_e=async()=>{if(!y.trim()||!m)return;T(!0);const{data:x,error:B}=await Se.update("department",m,{name:y.trim()});if(T(!1),B||!x){s(`Failed to update department: ${B??"Unknown error"}`,"error");return}n({type:"UPDATE_DEPARTMENT",payload:x}),s("Department updated","success"),xe()},Ce=async x=>{if(!b)return;T(!0);const B=x||null,{data:G,error:C}=await Se.update("department",b,{managerId:B});if(T(!1),C||!G){s(`Failed to assign manager: ${C??"Unknown error"}`,"error");return}n({type:"ASSIGN_MANAGER",payload:{departmentId:b,staffId:B}}),s("Manager updated","success"),_(null)},Ie=[{label:"Total Departments",value:r.departments.length,icon:i.jsx(Cn,{className:"w-5 h-5 text-blue-500"})},{label:"Managed",value:$,icon:i.jsx(rn,{className:"w-5 h-5 text-green-500"})},{label:"Acting",value:M,icon:i.jsx(aa,{className:"w-5 h-5 text-amber-500"})},{label:"Unmanaged",value:Y,icon:i.jsx(aa,{className:"w-5 h-5 text-red-500"})}],Re=x=>x===Rt.Managed?"success":x===Rt.Acting?"warning":"error",ie=[{key:"uid",header:"UID",render:x=>i.jsx("span",{className:"text-gray-400 text-xs font-mono",children:x.uid})},{key:"name",header:"Department",render:x=>m===x.id?i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("input",{type:"text",value:y,onChange:B=>v(B.target.value),onKeyDown:B=>{B.key==="Enter"&&_e(),B.key==="Escape"&&xe()},className:"px-3 py-1.5 border border-blue-400 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 w-40",autoFocus:!0,disabled:w}),i.jsx("button",{onClick:_e,className:"text-gray-500 hover:text-green-600",disabled:w,children:w?i.jsx(Xe,{className:"w-4 h-4 animate-spin"}):i.jsx(rn,{className:"w-4 h-4"})}),i.jsx("button",{onClick:xe,className:"text-gray-500 hover:text-red-600",disabled:w,children:i.jsx(tr,{className:"w-4 h-4"})})]}):i.jsx("span",{className:"font-semibold text-gray-900",children:x.name})},{key:"manager",header:"Manager",render:x=>{const B=z(x.managerId);if(!B)return i.jsx("span",{className:"text-gray-400 italic text-sm",children:"No manager"});const G=q(B.gradeId);return i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("div",{className:"w-7 h-7 rounded-full bg-gray-100 flex items-center justify-center text-[10px] font-medium text-gray-500",children:[B.firstName[0],B.lastName[0]]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-sm text-gray-900",children:pt(B)}),G&&i.jsxs("span",{className:"text-xs text-gray-400 ml-1",children:["(",G.name,")"]})]})]})}},{key:"headcount",header:"Headcount",render:x=>i.jsx("span",{className:"text-sm",children:j(x.id)})},{key:"functions",header:"Functions",render:x=>i.jsx("span",{className:"text-sm",children:E(x.id)})},{key:"responsibilities",header:"Responsibilities",render:x=>i.jsx("span",{className:"text-sm",children:D(x.id)})},{key:"teams",header:"Teams",render:x=>i.jsx("span",{className:"text-sm",children:V(x.id)})},{key:"status",header:"Status",render:x=>{const B=Ks(x,r.staff,r.grades,r.appSettings.maxManagerGradeLevel);return i.jsx(Le,{variant:Re(B),children:B})}},{key:"actions",header:"Actions",render:x=>i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(gt,{icon:Mi,onClick:()=>_(x.id),variant:"primary",title:"Assign Manager"}),i.jsx(gt,{icon:An,onClick:()=>ve(x),title:"Edit"}),i.jsx(gt,{icon:fn,onClick:()=>K(x),variant:"danger",title:"Delete"})]})}],he=r.departments.find(x=>x.id===b);return i.jsxs("div",{children:[i.jsx(ot,{title:"Departments",subtitle:"Manage organisational departments and their managers",action:i.jsxs("div",{className:"relative",children:[i.jsx(Be,{onClick:()=>u(!o),icon:hn,children:"Add Department"}),o&&i.jsxs("div",{className:"absolute right-0 top-full mt-2 bg-white border border-gray-200 rounded-lg shadow-lg p-4 z-10 w-64",children:[i.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"New department name"}),i.jsx("input",{type:"text",value:d,onChange:x=>f(x.target.value),placeholder:"Enter department name...",onKeyDown:x=>x.key==="Enter"&&re(),className:"w-full px-3 py-2 border border-blue-400 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 mb-2",autoFocus:!0,disabled:w}),i.jsxs("button",{onClick:re,disabled:!d.trim()||w,className:"w-full bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium py-2 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed inline-flex items-center justify-center gap-2",children:[w&&i.jsx(Xe,{className:"w-4 h-4 animate-spin"}),w?"Adding...":"Add"]})]})]})}),i.jsx("div",{className:"mb-6",children:i.jsx(sn,{cards:Ie})}),i.jsx(an,{columns:ie,data:r.departments,emptyMessage:"No departments defined."}),i.jsx(Ze,{isOpen:!!b,onClose:()=>!w&&_(null),title:`Assign Manager - ${(he==null?void 0:he.name)||""}`,footer:null,children:i.jsx("div",{children:w?i.jsxs("div",{className:"flex items-center justify-center gap-2 py-4 text-sm text-gray-500",children:[i.jsx(Xe,{className:"w-4 h-4 animate-spin"}),"Saving..."]}):i.jsx(Ys,{value:(he==null?void 0:he.managerId)||"",onChange:x=>Ce(x),placeholder:"No manager",options:[{value:"",label:"No manager"},...r.staff.filter(x=>{const B=q(x.gradeId);return B&&B.level<=r.appSettings.maxManagerGradeLevel}).map(x=>{const B=q(x.gradeId);return{value:x.id,label:`${pt(x)} (${(B==null?void 0:B.name)||"No Grade"})`}})]})})})]})}let Ih=0;function Ri(){return Ih++,`id-${Ih}-${Math.random().toString(36).substr(2,9)}`}function Xy(r){return String(r).padStart(3,"0")}function Zy(){const r=rt(),n=jt(),[s,o]=A.useState(""),[u,d]=A.useState("all"),[f,m]=A.useState(null),[p,y]=A.useState(null),[v,b]=A.useState(null),[_,w]=A.useState(""),[T,j]=A.useState(""),[E,D]=A.useState(Nn.Internal),[V,z]=A.useState(""),[q,$]=A.useState(""),M=N=>r.departments.find(ae=>ae.id===N),Y=N=>r.staff.filter(ae=>ae.primaryFunctionId===N||ae.secondaryFunctionId===N||(ae.additionalFunctionIds||[]).includes(N)).length,re=N=>r.responsibilities.filter(ae=>ae.functionId===N).length,K=N=>!!(N.email||N.phone),ve=r.functions.length,xe=r.functions.filter(N=>N.type===Nn.Internal).length,_e=r.functions.filter(N=>N.type===Nn.External).length,Ce=r.functions.filter(N=>K(N)).length,Ie=[{label:"Total Functions",value:ve,icon:i.jsx(Ui,{className:"w-5 h-5 text-blue-500"})},{label:"Internal",value:xe,icon:i.jsx(Cn,{className:"w-5 h-5 text-gray-500"})},{label:"External",value:_e,icon:i.jsx(la,{className:"w-5 h-5 text-blue-500"})},{label:"With Contact",value:Ce,icon:i.jsx(er,{className:"w-5 h-5 text-green-500"})}],Re=A.useMemo(()=>r.functions.filter(N=>!(s&&!N.name.toLowerCase().includes(s.toLowerCase())&&!N.uid.includes(s)||u!=="all"&&N.departmentId!==u)),[r.functions,s,u]),ie=()=>{var N;w(""),j(((N=r.departments[0])==null?void 0:N.id)||""),D(Nn.Internal),z(""),$(""),m("add"),y(null)},he=N=>{w(N.name),j(N.departmentId),D(N.type),z(N.email||""),$(N.phone||""),m("edit"),y(N)},x=()=>{m(null),y(null)},B=()=>{if(!_.trim()||!T||!E)return;const N={name:_.trim(),departmentId:T,type:E,email:V.trim()||null,phone:q.trim()||null};if(f==="add"){const ae=Xy(r.functions.length>0?Math.max(...r.functions.map(me=>parseInt(me.uid)))+1:1);n({type:"ADD_FUNCTION",payload:{id:Ri(),uid:ae,...N}})}else p&&n({type:"UPDATE_FUNCTION",payload:{id:p.id,...N}});x()},G=()=>{if(!v)return;const N=Y(v.id),ae=re(v.id);if(N>0){alert("Cannot delete  staff are assigned to this function."),b(null);return}if(ae>0){alert("Cannot delete  responsibilities are assigned to this function."),b(null);return}n({type:"DELETE_FUNCTION",payload:v.id}),b(null)},C=[{key:"uid",header:"UID",render:N=>i.jsx("span",{className:"text-gray-400 text-xs font-mono",children:N.uid})},{key:"name",header:"Function Name",render:N=>i.jsx("span",{className:"font-semibold text-gray-900",children:N.name})},{key:"department",header:"Department",render:N=>{var ae;return i.jsx("span",{className:"text-sm",children:((ae=M(N.departmentId))==null?void 0:ae.name)||"-"})}},{key:"type",header:"Type",render:N=>i.jsx(Le,{variant:N.type===Nn.Internal?"neutral":"info",children:N.type})},{key:"staff",header:"Staff",render:N=>i.jsx("span",{className:"text-sm",children:Y(N.id)})},{key:"responsibilities",header:"Responsibilities",render:N=>i.jsx("span",{className:"text-sm",children:re(N.id)})},{key:"contact",header:"Contact",render:N=>K(N)?i.jsx(Le,{variant:"success",children:"Has Contact"}):i.jsx("span",{className:"text-gray-300 text-sm",children:""})},{key:"actions",header:"Actions",render:N=>i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(gt,{icon:An,onClick:()=>he(N),title:"Edit"}),i.jsx(gt,{icon:fn,onClick:()=>b(N),variant:"danger",title:"Delete"})]})}];return i.jsxs("div",{children:[i.jsx(ot,{title:"Functions",subtitle:"Manage functional areas within departments",action:i.jsx(Be,{onClick:ie,icon:hn,children:"Add Function"})}),i.jsx("div",{className:"mb-6",children:i.jsx(sn,{cards:Ie})}),i.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[i.jsx("div",{className:"w-52",children:i.jsx(mn,{value:s,onChange:o,placeholder:"Search functions..."})}),i.jsxs("select",{value:u,onChange:N=>d(N.target.value),className:"px-3 py-2 border border-gray-200 rounded-lg text-sm bg-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"all",children:"All Departments"}),r.departments.map(N=>i.jsx("option",{value:N.id,children:N.name},N.id))]})]}),i.jsx(an,{columns:C,data:Re,emptyMessage:"No functions found."}),i.jsx(Ze,{isOpen:f==="add"||f==="edit",onClose:x,title:f==="add"?"Add Function":"Edit Function",footer:i.jsxs(i.Fragment,{children:[i.jsx(Be,{variant:"secondary",onClick:x,children:"Cancel"}),i.jsx(Be,{onClick:B,children:f==="add"?"Add Function":"Save Changes"})]}),children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"text-sm font-medium text-gray-700 block mb-1.5",children:["Function Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",value:_,onChange:N=>w(N.target.value),placeholder:"Enter function name...",className:"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",autoFocus:!0})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"text-sm font-medium text-gray-700 block mb-1.5",children:["Department ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{value:T,onChange:N=>j(N.target.value),className:"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm bg-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"",children:"Select department"}),r.departments.map(N=>i.jsx("option",{value:N.id,children:N.name},N.id))]})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"text-sm font-medium text-gray-700 block mb-1.5",children:["Type ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{value:E,onChange:N=>D(N.target.value),className:"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm bg-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:Nn.Internal,children:"Internal"}),i.jsx("option",{value:Nn.External,children:"External"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-700 block mb-1.5",children:"Email"}),i.jsx("input",{type:"email",value:V,onChange:N=>z(N.target.value),placeholder:"e.g. function@acme.ae",className:"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-700 block mb-1.5",children:"Phone"}),i.jsx("input",{type:"tel",value:q,onChange:N=>$(N.target.value),placeholder:"e.g. +971 4 555 0000",className:"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]})}),i.jsx(Ze,{isOpen:!!v,onClose:()=>b(null),title:"Delete Function",footer:i.jsxs(i.Fragment,{children:[i.jsx(Be,{variant:"secondary",onClick:()=>b(null),children:"Cancel"}),i.jsx(Be,{variant:"danger",onClick:G,icon:fn,children:"Delete"})]}),children:v&&i.jsx("div",{children:i.jsxs("p",{className:"text-sm text-gray-700",children:["Are you sure you want to delete"," ",i.jsx("span",{className:"font-semibold",children:v.name}),"? This action cannot be undone."]})})})]})}function ev(){var St,Ht;const r=rt(),n=jt(),s=Vt(),[o,u]=A.useState(""),[d,f]=A.useState("all"),[m,p]=A.useState("all"),[y,v]=A.useState("all"),[b,_]=A.useState(null),[w,T]=A.useState(null),[j,E]=A.useState(!1),[D,V]=A.useState(""),[z,q]=A.useState(""),[$,M]=A.useState(""),[Y,re]=A.useState(""),[K,ve]=A.useState(!0),[xe,_e]=A.useState(""),[Ce,Ie]=A.useState(""),[Re,ie]=A.useState(""),he=W=>r.functions.find(fe=>fe.id===W),x=W=>r.departments.find(fe=>fe.id===W),B=W=>{const fe=he(W);return fe?x(fe.departmentId):void 0},G=W=>W?r.complianceTags.find(fe=>fe.id===W):void 0,C=W=>{const fe=r.workflowSteps.filter(We=>We.responsibilityId===W).map(We=>We.workflowId);return r.workflows.filter(We=>fe.includes(We.id))},N=r.responsibilities.length,ae=r.responsibilities.filter(W=>W.isComplianceTagged).length,me=r.responsibilities.filter(W=>W.sopLink&&W.sopLink.trim()!=="").length,we=N-me,H=N>0?Math.round(me/N*100):0,L=[{label:"Total Responsibilities",value:N,icon:i.jsx(ia,{className:"w-5 h-5 text-blue-500"})},{label:"Compliance Tagged",value:ae,icon:i.jsx(ca,{className:"w-5 h-5 text-green-500"})},{label:"With SOP",value:me,icon:i.jsx(oa,{className:"w-5 h-5 text-blue-500"})},{label:"Missing SOP",value:we,icon:i.jsx(aa,{className:"w-5 h-5 text-amber-500"})},{label:"SOP Coverage",value:`${H}%`,icon:i.jsx(rn,{className:"w-5 h-5 text-green-500"})}],te=A.useMemo(()=>r.responsibilities.filter(W=>{const fe=he(W.functionId),We=fe?x(fe.departmentId):void 0;return!(o&&!W.name.toLowerCase().includes(o.toLowerCase())&&!(W.description||"").toLowerCase().includes(o.toLowerCase())||d!=="all"&&(We==null?void 0:We.id)!==d||m!=="all"&&W.functionId!==m||y==="has"&&(!W.sopLink||W.sopLink.trim()==="")||y==="missing"&&W.sopLink&&W.sopLink.trim()!=="")}),[r.responsibilities,r.functions,r.departments,o,d,m,y]),O=()=>{var W,fe;V(""),q(""),M(((W=r.functions[0])==null?void 0:W.id)||""),re(""),ve(!1),_e(((fe=r.complianceTags[0])==null?void 0:fe.id)||""),_("new"),T(null)},Z=W=>{V(W.name),q(W.description||""),M(W.functionId),re(W.sopLink||""),ve(W.isComplianceTagged),_e(W.complianceTagId||""),_("edit"),T(W)},Te=W=>{const fe=he(W.functionId);Ie((fe==null?void 0:fe.departmentId)||""),ie(""),_("transfer"),T(W)},Pe=()=>{j||(_(null),T(null))},$e=async()=>{if(!D.trim()||!$)return;const W={name:D.trim(),description:z.trim(),functionId:$,sopLink:Y.trim(),isComplianceTagged:K,complianceTagId:K&&xe||null};if(E(!0),b==="new"){const{data:fe,error:We}=await Se.create("responsibility",W);if(E(!1),We||!fe){s(`Failed to add responsibility: ${We??"Unknown error"}`,"error");return}n({type:"ADD_RESPONSIBILITY",payload:fe}),s("Responsibility added","success")}else if(w){const{data:fe,error:We}=await Se.update("responsibility",w.id,W);if(E(!1),We||!fe){s(`Failed to update responsibility: ${We??"Unknown error"}`,"error");return}n({type:"UPDATE_RESPONSIBILITY",payload:fe}),s("Responsibility updated","success")}else E(!1);Pe()},U=async()=>{if(!Re||!w)return;E(!0);const{data:W,error:fe}=await Se.update("responsibility",w.id,{functionId:Re});if(E(!1),fe||!W){s(`Failed to transfer responsibility: ${fe??"Unknown error"}`,"error");return}n({type:"TRANSFER_RESPONSIBILITY",payload:{id:w.id,newFunctionId:Re}}),s("Responsibility transferred","success"),Pe()},ne=async W=>{if(r.workflowSteps.some(da=>da.responsibilityId===W.id)){s("Cannot delete  this responsibility is used in a workflow.","error");return}E(!0);const{error:We}=await Se.remove("responsibility",W.id);if(E(!1),We){s(`Failed to delete responsibility: ${We}`,"error");return}n({type:"DELETE_RESPONSIBILITY",payload:W.id}),s("Responsibility deleted","success")},ke=A.useMemo(()=>Ce?r.functions.filter(W=>W.departmentId===Ce):[],[Ce,r.functions]),pn=[{key:"uid",header:"UID",render:W=>i.jsx("span",{className:"text-gray-400 text-xs font-mono",children:W.uid})},{key:"name",header:"Responsibility",render:W=>i.jsxs("div",{children:[i.jsx("p",{className:"font-semibold text-gray-900 text-sm",children:W.name}),W.description&&i.jsx("p",{className:"text-xs text-gray-400 mt-0.5",children:W.description})]})},{key:"function",header:"Function",render:W=>{var fe;return i.jsx("span",{className:"text-sm",children:((fe=he(W.functionId))==null?void 0:fe.name)||"-"})}},{key:"department",header:"Department",render:W=>{var fe;return i.jsx("span",{className:"text-sm",children:((fe=B(W.functionId))==null?void 0:fe.name)||"-"})}},{key:"compliance",header:"Compliance",render:W=>W.isComplianceTagged?i.jsx(rn,{className:"w-4 h-4 text-green-500"}):i.jsx(tr,{className:"w-4 h-4 text-red-400"})},{key:"type",header:"Type",render:W=>{if(!W.isComplianceTagged)return i.jsx("span",{className:"text-gray-300",children:"-"});const fe=G(W.complianceTagId);return fe?i.jsx(Le,{variant:fe.name==="Annual"?"info":"warning",children:fe.name}):i.jsx("span",{className:"text-gray-300",children:"-"})}},{key:"sop",header:"SOP",render:W=>W.sopLink&&W.sopLink.trim()!==""?i.jsx("a",{href:W.sopLink,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:text-blue-700",children:i.jsx(tf,{className:"w-4 h-4"})}):i.jsx(tr,{className:"w-4 h-4 text-red-400"})},{key:"workflows",header:"Workflows",render:W=>{const fe=C(W.id);return fe.length===0?i.jsx("span",{className:"text-gray-300",children:"-"}):i.jsx("div",{className:"flex flex-wrap gap-1",children:fe.map(We=>i.jsx(Le,{variant:"info",children:We.name},We.id))})}},{key:"actions",header:"Actions",render:W=>i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(gt,{icon:Ch,onClick:()=>Te(W),title:"Transfer"}),i.jsx(gt,{icon:An,onClick:()=>Z(W),title:"Edit"}),i.jsx(gt,{icon:fn,onClick:()=>ne(W),variant:"danger",title:"Delete"})]})}],gn=r.functions.map(W=>{const fe=x(W.departmentId);return{id:W.id,label:`${W.name} (${(fe==null?void 0:fe.name)||""})`}});return i.jsxs("div",{children:[i.jsx(ot,{title:"Responsibilities",subtitle:"All responsibilities across functions",action:i.jsx(Be,{onClick:O,icon:hn,children:"Add Responsibility"})}),i.jsx("div",{className:"mb-6",children:i.jsx(sn,{cards:L})}),i.jsxs("div",{className:"flex items-center gap-3 mb-4 flex-wrap",children:[i.jsx("div",{className:"w-52",children:i.jsx(mn,{value:o,onChange:u,placeholder:"Search responsibilities..."})}),i.jsxs("div",{className:"flex items-center gap-1.5",children:[i.jsx("span",{className:"text-xs text-gray-500",children:"Department:"}),i.jsxs("select",{value:d,onChange:W=>f(W.target.value),className:"px-2 py-1.5 border border-gray-200 rounded-lg text-sm bg-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"all",children:"All"}),r.departments.map(W=>i.jsx("option",{value:W.id,children:W.name},W.id))]})]}),i.jsxs("div",{className:"flex items-center gap-1.5",children:[i.jsx("span",{className:"text-xs text-gray-500",children:"Function:"}),i.jsxs("select",{value:m,onChange:W=>p(W.target.value),className:"px-2 py-1.5 border border-gray-200 rounded-lg text-sm bg-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"all",children:"All"}),r.functions.map(W=>i.jsx("option",{value:W.id,children:W.name},W.id))]})]}),i.jsxs("div",{className:"flex items-center gap-1.5",children:[i.jsx("span",{className:"text-xs text-gray-500",children:"SOP:"}),i.jsxs("select",{value:y,onChange:W=>v(W.target.value),className:"px-2 py-1.5 border border-gray-200 rounded-lg text-sm bg-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"all",children:"All"}),i.jsx("option",{value:"has",children:"Has SOP"}),i.jsx("option",{value:"missing",children:"Missing"})]})]})]}),i.jsx(an,{columns:pn,data:te,emptyMessage:"No responsibilities found."}),i.jsx(Ze,{isOpen:b==="new"||b==="edit",onClose:Pe,title:b==="new"?"New Responsibility":"Edit Responsibility",footer:i.jsxs(i.Fragment,{children:[i.jsx(Be,{variant:"secondary",onClick:Pe,disabled:j,children:"Cancel"}),i.jsxs(Be,{onClick:$e,disabled:!D.trim()||!$||j,children:[j&&i.jsx(Xe,{className:"w-4 h-4 animate-spin"}),j?"Saving...":b==="new"?"Add Responsibility":"Save Changes"]})]}),children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-700 block mb-1.5",children:"Name"}),i.jsx("input",{type:"text",value:D,onChange:W=>V(W.target.value),placeholder:"Responsibility name",className:"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:j})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-700 block mb-1.5",children:"Description"}),i.jsx("textarea",{value:z,onChange:W=>q(W.target.value),placeholder:"Brief description",rows:3,className:"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 resize-y",disabled:j})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-700 block mb-1.5",children:"Function"}),i.jsx("select",{value:$,onChange:W=>M(W.target.value),className:"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm bg-white focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:j,children:gn.map(W=>i.jsx("option",{value:W.id,children:W.label},W.id))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-700 block mb-1.5",children:"SOP Link"}),i.jsx("input",{type:"text",value:Y,onChange:W=>re(W.target.value),placeholder:"https://sop.seamless.ae/...",className:"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:j})]}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("button",{onClick:()=>ve(!K),className:`w-10 h-5 rounded-full transition-colors relative ${K?"bg-blue-600":"bg-gray-300"}`,disabled:j,children:i.jsx("span",{className:`absolute top-0.5 w-4 h-4 bg-white rounded-full shadow transition-transform ${K?"left-5":"left-0.5"}`})}),i.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Compliance required"})]}),K&&i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-700 block mb-1.5",children:"Compliance Type"}),i.jsxs("select",{value:xe,onChange:W=>_e(W.target.value),className:"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm bg-white focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:j,children:[i.jsx("option",{value:"",children:"Select type"}),r.complianceTags.map(W=>i.jsx("option",{value:W.id,children:W.name},W.id))]})]})]})}),i.jsx(Ze,{isOpen:b==="transfer",onClose:Pe,title:"Transfer Responsibility",footer:i.jsxs(i.Fragment,{children:[i.jsx(Be,{variant:"secondary",onClick:Pe,disabled:j,children:"Cancel"}),i.jsxs(Be,{onClick:U,icon:Ch,disabled:!Re||j,children:[j&&i.jsx(Xe,{className:"w-4 h-4 animate-spin"}),j?"Transferring...":"Transfer"]})]}),children:w&&i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 border border-gray-100",children:[i.jsx("p",{className:"font-medium text-gray-900 text-sm",children:w.name}),i.jsxs("p",{className:"text-xs text-gray-500 mt-0.5",children:["Currently in: ",((St=he(w.functionId))==null?void 0:St.name)||"-"," (",((Ht=B(w.functionId))==null?void 0:Ht.name)||"-",")"]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-700 block mb-1.5",children:"Target Department"}),i.jsx("select",{value:Ce,onChange:W=>{Ie(W.target.value),ie("")},className:"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm bg-white focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:j,children:r.departments.map(W=>i.jsx("option",{value:W.id,children:W.name},W.id))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-700 block mb-1.5",children:"Target Function"}),i.jsxs("select",{value:Re,onChange:W=>ie(W.target.value),className:"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm bg-white focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:j,children:[i.jsx("option",{value:"",children:"Select function"}),ke.map(W=>i.jsx("option",{value:W.id,children:W.name},W.id))]})]})]})})]})}function lf(r,n,s){const o=r.toLowerCase(),u=n.toLowerCase();return s.emailFormat===as.FirstnameL?`${o}.${u[0]}@${s.emailDomain}`:`${o[0]}.${u}@${s.emailDomain}`}function Oi(r,n){return lf(r.firstName,r.lastName,n)}function tv(){const r=rt(),n=jt(),s=Vt(),[o,u]=A.useState(""),[d,f]=A.useState("all"),[m,p]=A.useState(null),[y,v]=A.useState(null),[b,_]=A.useState(!1),[w,T]=A.useState(""),[j,E]=A.useState(""),[D,V]=A.useState(""),[z,q]=A.useState(""),[$,M]=A.useState(""),[Y,re]=A.useState(""),[K,ve]=A.useState([]),xe=U=>r.departments.find(ne=>ne.id===U),_e=U=>U?r.grades.find(ne=>ne.id===U):void 0,Ce=U=>U?r.functions.find(ne=>ne.id===U):void 0,Ie=U=>{const ne=_e(U);if(!ne)return"neutral";const ke=ne.name.toLowerCase();return ke==="md"?"md":ke==="manager"?"manager":ke==="senior"?"senior":"staff"},Re=r.staff.length,ie=r.departments.length,he=new Set(r.staff.filter(U=>U.gradeId).map(U=>U.gradeId)).size,x=r.staff.filter(U=>{const ne=_e(U.gradeId);return ne&&ne.level<=r.appSettings.maxManagerGradeLevel}).length,B=[{label:"Total Staff",value:Re,icon:i.jsx(br,{className:"w-5 h-5 text-blue-500"})},{label:"Departments",value:ie,icon:i.jsx(Cn,{className:"w-5 h-5 text-blue-500"})},{label:"Grade Levels",value:he,icon:i.jsx(rf,{className:"w-5 h-5 text-green-500"})},{label:"Managers",value:x,icon:i.jsx(Mi,{className:"w-5 h-5 text-amber-500"})}],G=A.useMemo(()=>r.staff.filter(U=>{const ne=pt(U).toLowerCase();return!(o&&!ne.includes(o.toLowerCase())||d!=="all"&&U.departmentId!==d)}),[r.staff,o,d]),C=A.useMemo(()=>z?r.functions.filter(U=>U.departmentId===z):[],[z,r.functions]),N=A.useMemo(()=>!w.trim()||!j.trim()?"":lf(w.trim(),j.trim(),r.appSettings),[w,j,r.appSettings]),ae=()=>{var U;T(""),E(""),V(""),q(((U=r.departments[0])==null?void 0:U.id)||""),M(""),re(""),ve([]),p("add"),v(null)},me=U=>{T(U.firstName),E(U.lastName),V(U.gradeId||""),q(U.departmentId),M(U.primaryFunctionId),re(U.secondaryFunctionId||""),ve(U.additionalFunctionIds||[]),p("edit"),v(U)},we=U=>{p("view"),v(U)},H=()=>{p(null),v(null)},L=async()=>{if(!w.trim()||!j.trim()||!z||!$)return;const U={firstName:w.trim(),lastName:j.trim(),departmentId:z,gradeId:D||null,primaryFunctionId:$,secondaryFunctionId:Y||null,additionalFunctionIds:K};if(_(!0),m==="add"){const{data:ne,error:ke}=await Se.create("staff",U);if(_(!1),ke||!ne){s(`Failed to add staff: ${ke??"Unknown error"}`,"error");return}n({type:"ADD_STAFF",payload:ne}),s("Staff member added","success")}else if(y){const{data:ne,error:ke}=await Se.update("staff",y.id,U);if(_(!1),ke||!ne){s(`Failed to update staff: ${ke??"Unknown error"}`,"error");return}n({type:"UPDATE_STAFF",payload:ne}),s("Staff member updated","success")}else _(!1);H()},te=async U=>{if(r.departments.some(St=>St.managerId===U.id)){s("Cannot delete  this person is assigned as a department manager.","error");return}const ke=r.crossFunctionalTeams.some(St=>St.leadId===U.id),pn=r.teamMembers.some(St=>St.staffId===U.id);if(ke||pn){s("Cannot delete  this person is part of a cross-functional team.","error");return}_(!0);const{error:gn}=await Se.remove("staff",U.id);if(_(!1),gn){s(`Failed to delete staff: ${gn}`,"error");return}n({type:"DELETE_STAFF",payload:U.id}),s("Staff member deleted","success")},O=U=>{ve(ne=>ne.includes(U)?ne.filter(ke=>ke!==U):[...ne,U])},Z=C.filter(U=>U.id!==$&&U.id!==Y),Te=A.useMemo(()=>{if(!y)return null;const U=r.companyNumberAllocations.find(ke=>ke.assignToType===tt.Staff&&ke.staffId===y.id);if(!U)return null;const ne=r.companyNumbers.find(ke=>ke.id===U.companyNumberId);return(ne==null?void 0:ne.phoneNumber)||null},[y,r.companyNumberAllocations,r.companyNumbers]),Pe=A.useMemo(()=>{if(!y)return[];const U=[y.primaryFunctionId,y.secondaryFunctionId,...y.additionalFunctionIds||[]].filter(Boolean);return r.responsibilities.filter(ne=>U.includes(ne.functionId))},[y,r.responsibilities]),$e=[{key:"uid",header:"ID",render:U=>i.jsx("span",{className:"text-gray-400 text-xs font-mono",children:U.uid})},{key:"name",header:"Name",render:U=>i.jsx("span",{className:"font-semibold text-gray-900",children:pt(U)})},{key:"title",header:"Title",render:U=>{const ne=_e(U.gradeId),ke=Ce(U.primaryFunctionId);return i.jsxs("span",{className:"text-sm text-gray-600",children:[(ne==null?void 0:ne.name)||"-",", ",(ke==null?void 0:ke.name)||"-"]})}},{key:"department",header:"Department",render:U=>{var ne;return i.jsx("span",{className:"text-sm",children:((ne=xe(U.departmentId))==null?void 0:ne.name)||"-"})}},{key:"grade",header:"Grade",render:U=>{const ne=_e(U.gradeId);return ne?i.jsx(Le,{variant:Ie(U.gradeId),children:ne.name}):i.jsx("span",{className:"text-gray-300",children:"-"})}},{key:"email",header:"Email",render:U=>i.jsx("span",{className:"text-sm text-gray-500",children:Oi(U,r.appSettings)})},{key:"actions",header:"Actions",render:U=>i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(gt,{icon:nf,onClick:()=>we(U),variant:"primary",title:"View Profile"}),i.jsx(gt,{icon:An,onClick:()=>me(U),title:"Edit"}),i.jsx(gt,{icon:fn,onClick:()=>te(U),variant:"danger",title:"Delete"})]})}];return i.jsxs("div",{children:[i.jsx(ot,{title:"Staff Directory",subtitle:"Manage staff profiles, grades, and function assignments",action:i.jsx(Be,{onClick:ae,icon:hn,children:"Add Staff"})}),i.jsx("div",{className:"mb-6",children:i.jsx(sn,{cards:B})}),i.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[i.jsx("div",{className:"w-52",children:i.jsx(mn,{value:o,onChange:u,placeholder:"Search by name..."})}),i.jsxs("select",{value:d,onChange:U=>f(U.target.value),className:"px-3 py-2 border border-gray-200 rounded-lg text-sm bg-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"all",children:"All Departments"}),r.departments.map(U=>i.jsx("option",{value:U.id,children:U.name},U.id))]})]}),i.jsx(an,{columns:$e,data:G,emptyMessage:"No staff found."}),i.jsx(Ze,{isOpen:m==="add"||m==="edit",onClose:()=>!b&&H(),title:m==="add"?"Add Staff":"Edit Staff",footer:i.jsxs(i.Fragment,{children:[i.jsx(Be,{variant:"secondary",onClick:H,disabled:b,children:"Cancel"}),i.jsxs(Be,{onClick:L,disabled:!w.trim()||!j.trim()||!z||!$||b,children:[b&&i.jsx(Xe,{className:"w-4 h-4 animate-spin"}),b?"Saving...":m==="add"?"Add Staff":"Save Changes"]})]}),children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"text-sm font-medium text-gray-700 block mb-1.5",children:["First Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",value:w,onChange:U=>T(U.target.value),className:"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:b})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"text-sm font-medium text-gray-700 block mb-1.5",children:["Last Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",value:j,onChange:U=>E(U.target.value),className:"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:b})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-700 block mb-1.5",children:"Email (auto-generated)"}),i.jsx("input",{type:"text",value:N,readOnly:!0,className:"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm bg-gray-50 text-gray-500"})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-700 block mb-1.5",children:"Grade"}),i.jsxs("select",{value:D,onChange:U=>V(U.target.value),className:"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm bg-white focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:b,children:[i.jsx("option",{value:"",children:"No Grade"}),[...r.grades].sort((U,ne)=>U.level-ne.level).map(U=>i.jsx("option",{value:U.id,children:U.name},U.id))]})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"text-sm font-medium text-gray-700 block mb-1.5",children:["Department ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{value:z,onChange:U=>{q(U.target.value),M(""),re(""),ve([])},className:"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm bg-white focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:b,children:[i.jsx("option",{value:"",children:"Select department"}),r.departments.map(U=>i.jsx("option",{value:U.id,children:U.name},U.id))]})]})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"text-sm font-medium text-gray-700 block mb-1.5",children:["Primary Function ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{value:$,onChange:U=>M(U.target.value),className:"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm bg-white focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:b,children:[i.jsx("option",{value:"",children:"Select function"}),C.map(U=>i.jsx("option",{value:U.id,children:U.name},U.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-700 block mb-1.5",children:"Secondary Function"}),i.jsxs("select",{value:Y,onChange:U=>re(U.target.value),className:"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm bg-white focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:b,children:[i.jsx("option",{value:"",children:"None"}),C.filter(U=>U.id!==$).map(U=>i.jsx("option",{value:U.id,children:U.name},U.id))]})]}),Z.length>0&&i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-700 block mb-1.5",children:"Additional Functions"}),i.jsx("div",{className:"space-y-2 max-h-32 overflow-y-auto",children:Z.map(U=>{const ne=xe(U.departmentId);return i.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:K.includes(U.id),onChange:()=>O(U.id),className:"rounded border-gray-300 text-blue-600 accent-blue-600",disabled:b}),i.jsxs("span",{className:"text-sm text-gray-700",children:[U.name," ",i.jsxs("span",{className:"text-gray-400",children:["(",ne==null?void 0:ne.name,")"]})]})]},U.id)})})]})]})}),i.jsx(Ze,{isOpen:m==="view",onClose:H,title:"Staff Profile",footer:null,children:y&&(()=>{var Ht;const U=_e(y.gradeId),ne=xe(y.departmentId),ke=Ce(y.primaryFunctionId),pn=`${y.firstName[0]}${y.lastName[0]}`.toUpperCase(),gn=Oi(y,r.appSettings),St=Te;return i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[i.jsx("div",{className:"w-14 h-14 rounded-full bg-blue-100 flex items-center justify-center text-blue-600 font-semibold text-lg",children:pn}),i.jsxs("div",{children:[i.jsx("p",{className:"font-semibold text-gray-900 text-lg",children:pt(y)}),i.jsxs("p",{className:"text-sm text-gray-500",children:[(U==null?void 0:U.name)||"-",", ",(ke==null?void 0:ke.name)||"-"]})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-xs text-gray-400 mb-0.5",children:"Department"}),i.jsx("p",{className:"text-sm font-medium text-gray-900",children:(ne==null?void 0:ne.name)||"-"})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-xs text-gray-400 mb-0.5",children:"Grade"}),i.jsx("p",{className:"text-sm font-medium text-gray-900",children:(U==null?void 0:U.name)||"-"})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-xs text-gray-400 mb-0.5",children:"Email"}),i.jsx("p",{className:"text-sm text-gray-700",children:gn})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-xs text-gray-400 mb-0.5",children:"Phone"}),i.jsx("p",{className:"text-sm text-gray-700",children:St||"-"})]})]}),i.jsxs("div",{className:"mb-4",children:[i.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Assigned Functions"}),i.jsxs("div",{className:"flex flex-wrap gap-2",children:[i.jsxs(Le,{variant:"info",children:["Primary: ",(ke==null?void 0:ke.name)||"-"]}),y.secondaryFunctionId&&i.jsxs(Le,{variant:"neutral",children:["Secondary: ",((Ht=Ce(y.secondaryFunctionId))==null?void 0:Ht.name)||"-"]}),(y.additionalFunctionIds||[]).map(W=>{var fe;return i.jsx(Le,{variant:"neutral",children:((fe=Ce(W))==null?void 0:fe.name)||"-"},W)})]})]}),Pe.length>0&&i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Responsibilities"}),i.jsx("ul",{className:"space-y-1.5",children:Pe.map(W=>i.jsxs("li",{className:"flex items-center gap-2 text-sm text-gray-700",children:[i.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-blue-400 flex-shrink-0"}),W.name]},W.id))})]})]})})()})]})}function nv(){const r=rt(),n=jt(),s=Vt(),[o,u]=A.useState(""),[d,f]=A.useState("all"),[m,p]=A.useState(null),[y,v]=A.useState(null),[b,_]=A.useState(!1),[w,T]=A.useState(""),[j,E]=A.useState(""),[D,V]=A.useState(""),[z,q]=A.useState(""),[$,M]=A.useState([]),Y=O=>r.departments.find(Z=>Z.id===O),re=O=>O?r.staff.find(Z=>Z.id===O):void 0,K=O=>O?r.grades.find(Z=>Z.id===O):void 0,ve=O=>O?r.functions.find(Z=>Z.id===O):void 0,xe=O=>r.teamMembers.filter(Z=>Z.teamId===O),_e=O=>{var U;const Z=xe(O),Te=(U=r.crossFunctionalTeams.find(ne=>ne.id===O))==null?void 0:U.leadId,$e=[...Z.map(ne=>ne.staffId),Te].filter(Boolean).flatMap(ne=>{const ke=re(ne);return ke?[ke.primaryFunctionId,ke.secondaryFunctionId,...ke.additionalFunctionIds||[]].filter(Boolean):[]});return r.responsibilities.filter(ne=>$e.includes(ne.functionId))},Ce=r.crossFunctionalTeams.length,Ie=r.crossFunctionalTeams.filter(O=>O.leadId).length,Re=r.teamMembers.length,ie=r.crossFunctionalTeams.reduce((O,Z)=>O+_e(Z.id).length,0),he=[{label:"Total Teams",value:Ce,icon:i.jsx(Fi,{className:"w-5 h-5 text-blue-500"})},{label:"With Lead",value:Ie,icon:i.jsx(rn,{className:"w-5 h-5 text-green-500"})},{label:"Total Members",value:Re,icon:i.jsx(br,{className:"w-5 h-5 text-blue-500"})},{label:"Team Responsibilities",value:ie,icon:i.jsx(ia,{className:"w-5 h-5 text-blue-500"})}],x=A.useMemo(()=>r.crossFunctionalTeams.filter(O=>!(o&&!O.name.toLowerCase().includes(o.toLowerCase())||d!=="all"&&O.reportingDepartmentId!==d)),[r.crossFunctionalTeams,o,d]),B=()=>{var O;T(""),E(""),V(((O=r.departments[0])==null?void 0:O.id)||""),q(""),M([]),p("add"),v(null)},G=O=>{const Z=xe(O.id);T(O.name),E(O.purpose||""),V(O.reportingDepartmentId),q(O.leadId||""),M(Z.map(Te=>Te.staffId)),p("edit"),v(O)},C=O=>{p("view"),v(O)},N=()=>{b||(p(null),v(null))},ae=O=>{M(Z=>Z.includes(O)?Z.filter(Te=>Te!==O):[...Z,O])},me=async()=>{if(!w.trim()||!D)return;_(!0);const{data:O,error:Z}=await Se.create("cross_functional_team",{name:w.trim(),purpose:j.trim(),reportingDepartmentId:D,leadId:z||null});if(Z||!O){_(!1),s(`Failed to create team: ${Z??"Unknown error"}`,"error");return}let Te=[];if($.length>0){const Pe=$.map(ne=>({team_id:O.id,staff_id:ne})),{data:$e,error:U}=await Ye.from("team_member").insert(Pe).select();if(U){_(!1),s(`Team created, but failed to add members: ${U.message}`,"error"),n({type:"ADD_TEAM",payload:{team:O,members:[]}}),N();return}Te=$e.map(ne=>kt(ne))}_(!1),n({type:"ADD_TEAM",payload:{team:O,members:Te}}),s("Team created","success"),N()},we=async()=>{if(!w.trim()||!D||!y)return;_(!0);const{data:O,error:Z}=await Se.update("cross_functional_team",y.id,{name:w.trim(),purpose:j.trim(),reportingDepartmentId:D,leadId:z||null});if(Z||!O){_(!1),s(`Failed to update team: ${Z??"Unknown error"}`,"error");return}const{error:Te}=await Ye.from("team_member").delete().eq("team_id",y.id);if(Te){_(!1),s(`Team updated, but failed to update members: ${Te.message}`,"error");return}let Pe=[];if($.length>0){const $e=$.map(ke=>({team_id:y.id,staff_id:ke})),{data:U,error:ne}=await Ye.from("team_member").insert($e).select();if(ne){_(!1),s(`Team updated, but failed to add members: ${ne.message}`,"error"),n({type:"UPDATE_TEAM",payload:{team:O,members:[]}}),N();return}Pe=U.map(ke=>kt(ke))}_(!1),n({type:"UPDATE_TEAM",payload:{team:O,members:Pe}}),s("Team updated","success"),N()},H=()=>{if(m==="add")return me();if(m==="edit")return we()},L=async O=>{_(!0);const{error:Z}=await Se.remove("cross_functional_team",O.id);if(_(!1),Z){s(`Failed to delete team: ${Z}`,"error");return}n({type:"DELETE_TEAM",payload:O.id}),s("Team deleted","success")},te=[{key:"uid",header:"UID",render:O=>i.jsx("span",{className:"text-gray-400 text-xs font-mono",children:O.uid})},{key:"name",header:"Team Name",render:O=>i.jsx("span",{className:"font-semibold text-gray-900",children:O.name})},{key:"dept",header:"Reporting Dept",render:O=>{var Z;return i.jsx("span",{className:"text-sm",children:((Z=Y(O.reportingDepartmentId))==null?void 0:Z.name)||"-"})}},{key:"lead",header:"Lead",render:O=>{const Z=re(O.leadId);if(!Z)return i.jsx("span",{className:"text-gray-400 italic text-sm",children:"No lead"});const Te=`${Z.firstName[0]}${Z.lastName[0]}`.toUpperCase();return i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:"w-7 h-7 rounded-full bg-gray-100 flex items-center justify-center text-[10px] font-medium text-gray-500",children:Te}),i.jsx("span",{className:"text-sm text-gray-900",children:pt(Z)})]})}},{key:"members",header:"Members",render:O=>{const Z=xe(O.id).length;return i.jsxs("div",{className:"flex items-center gap-1.5",children:[i.jsx(br,{className:"w-3.5 h-3.5 text-gray-400"}),i.jsx("span",{className:"text-sm",children:Z})]})}},{key:"actions",header:"Actions",render:O=>i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(gt,{icon:nf,onClick:()=>C(O),variant:"primary",title:"View Details"}),i.jsx(gt,{icon:An,onClick:()=>G(O),title:"Edit"}),i.jsx(gt,{icon:fn,onClick:()=>L(O),variant:"danger",title:"Delete"})]})}];return i.jsxs("div",{children:[i.jsx(ot,{title:"Cross-Functional Teams",subtitle:"Manage teams that span across departments",action:i.jsx(Be,{onClick:B,icon:hn,children:"Add Team"})}),i.jsx("div",{className:"mb-6",children:i.jsx(sn,{cards:he})}),i.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[i.jsx("div",{className:"w-52",children:i.jsx(mn,{value:o,onChange:u,placeholder:"Search teams..."})}),i.jsxs("select",{value:d,onChange:O=>f(O.target.value),className:"px-3 py-2 border border-gray-200 rounded-lg text-sm bg-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"all",children:"All Departments"}),r.departments.map(O=>i.jsx("option",{value:O.id,children:O.name},O.id))]})]}),i.jsx(an,{columns:te,data:x,emptyMessage:"No teams found."}),i.jsx(Ze,{isOpen:m==="add"||m==="edit",onClose:N,title:m==="add"?"Create Team":"Edit Team",footer:i.jsxs(i.Fragment,{children:[i.jsx(Be,{variant:"secondary",onClick:N,disabled:b,children:"Cancel"}),i.jsxs(Be,{onClick:H,disabled:!w.trim()||!D||b,children:[b&&i.jsx(Xe,{className:"w-4 h-4 animate-spin"}),b?"Saving...":m==="add"?"Create Team":"Save Changes"]})]}),children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"text-sm font-medium text-gray-700 block mb-1.5",children:["Team Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",value:w,onChange:O=>T(O.target.value),placeholder:"Team name",className:"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:b})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-700 block mb-1.5",children:"Purpose"}),i.jsx("textarea",{value:j,onChange:O=>E(O.target.value),placeholder:"Team purpose",rows:3,className:"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 resize-y",disabled:b})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"text-sm font-medium text-gray-700 block mb-1.5",children:["Reporting Department ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("select",{value:D,onChange:O=>V(O.target.value),className:"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm bg-white focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:b,children:[i.jsx("option",{value:"",children:"Select department"}),r.departments.map(O=>i.jsx("option",{value:O.id,children:O.name},O.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-700 block mb-1.5",children:"Team Lead"}),i.jsxs("select",{value:z,onChange:O=>q(O.target.value),className:"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm bg-white focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:b,children:[i.jsx("option",{value:"",children:"No lead"}),r.staff.map(O=>i.jsx("option",{value:O.id,children:pt(O)},O.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-700 block mb-1.5",children:"Members"}),i.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto border border-gray-100 rounded-lg p-3",children:r.staff.map(O=>{const Z=Y(O.departmentId);return i.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:$.includes(O.id),onChange:()=>ae(O.id),className:"rounded border-gray-300 text-blue-600 accent-blue-600",disabled:b}),i.jsxs("span",{className:"text-sm text-gray-700",children:[pt(O)," ",i.jsxs("span",{className:"text-gray-400",children:["(",Z==null?void 0:Z.name,")"]})]})]},O.id)})})]})]})}),i.jsx(Ze,{isOpen:m==="view",onClose:N,title:"Team Details",footer:null,children:y&&(()=>{const O=Y(y.reportingDepartmentId),Z=re(y.leadId),Te=Z?K(Z.gradeId):void 0,Pe=Z?ve(Z.primaryFunctionId):void 0,$e=xe(y.id);return i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-bold text-gray-900",children:y.name}),y.purpose&&i.jsx("p",{className:"text-sm text-gray-500 mt-1",children:y.purpose}),i.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-4 mb-4",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-xs text-gray-400 mb-0.5",children:"Reporting Department"}),i.jsx("p",{className:"text-sm font-medium text-gray-900",children:(O==null?void 0:O.name)||"-"})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-xs text-gray-400 mb-0.5",children:"UID"}),i.jsx("p",{className:"text-sm font-medium text-gray-900",children:y.uid})]})]}),i.jsxs("div",{className:"mb-4",children:[i.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Team Lead"}),Z?i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs("div",{className:"w-9 h-9 rounded-full bg-blue-100 flex items-center justify-center text-blue-600 font-semibold text-xs",children:[Z.firstName[0],Z.lastName[0]]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-900",children:pt(Z)}),i.jsxs("p",{className:"text-xs text-gray-500",children:[(Te==null?void 0:Te.name)||"-",", ",(Pe==null?void 0:Pe.name)||"-"]})]})]}):i.jsx("p",{className:"text-sm text-gray-400 italic",children:"No lead assigned"})]}),i.jsxs("div",{children:[i.jsxs("p",{className:"text-sm font-medium text-gray-700 mb-2",children:["Members (",$e.length,")"]}),i.jsxs("div",{className:"space-y-2",children:[$e.map(U=>{const ne=re(U.staffId);if(!ne)return null;const ke=Y(ne.departmentId);return i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs("div",{className:"w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center text-[10px] font-medium text-gray-500",children:[ne.firstName[0],ne.lastName[0]]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-900",children:pt(ne)}),i.jsx("p",{className:"text-xs text-gray-500",children:(ke==null?void 0:ke.name)||"-"})]})]},U.id)}),$e.length===0&&i.jsx("p",{className:"text-sm text-gray-400 italic",children:"No members"})]})]})]})})()})]})}function rv(){const r=rt(),n=jt(),s=Vt(),[o,u]=A.useState(""),[d,f]=A.useState(null),[m,p]=A.useState(!1),y=A.useMemo(()=>r.users.filter(j=>{if(!o)return!0;const E=o.toLowerCase();return!!(j.username&&j.username.toLowerCase().includes(E)||j.email&&j.email.toLowerCase().includes(E))}),[r.users,o]),v=r.users.find(j=>j.id===d),b=async(j,E)=>{p(!0);const{error:D}=await Se.update("app_user",j,{role:E});if(p(!1),D){s(`Failed to update role: ${D}`,"error");return}n({type:"UPDATE_USER_ROLE",payload:{userId:j,role:E}}),s("Role updated","success"),f(null)},_=j=>{d&&b(d,j)},w=[{value:Yn.Admin,label:"Admin"},{value:Yn.SuperAdmin,label:"Super Admin"}],T=[{key:"user",header:"User",render:j=>i.jsx("span",{className:"text-sm text-gray-900",children:j.username||"-"})},{key:"email",header:"Email",render:j=>i.jsx("span",{className:"text-sm text-gray-500",children:j.email||"-"})},{key:"roles",header:"Roles",render:j=>j.role===Yn.SuperAdmin?i.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 rounded-full text-xs font-medium bg-blue-50 text-blue-700 border border-blue-200",children:[i.jsx(rn,{className:"w-3 h-3"}),j.role,i.jsx("button",{onClick:()=>b(j.id,Yn.Staff),disabled:m,className:"ml-0.5 hover:text-blue-900 transition-colors disabled:opacity-50",children:i.jsx(tr,{className:"w-3 h-3"})})]}):j.role===Yn.Admin?i.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 rounded-full text-xs font-medium bg-amber-50 text-amber-700 border border-amber-200",children:[i.jsx(rn,{className:"w-3 h-3"}),j.role,i.jsx("button",{onClick:()=>b(j.id,Yn.Staff),disabled:m,className:"ml-0.5 hover:text-amber-900 transition-colors disabled:opacity-50",children:i.jsx(tr,{className:"w-3 h-3"})})]}):i.jsx("span",{className:"text-sm text-gray-400",children:j.role})},{key:"actions",header:"Actions",render:j=>i.jsxs("button",{onClick:()=>f(j.id),disabled:m,className:"inline-flex items-center gap-1.5 px-3 py-1.5 border border-gray-200 rounded-lg text-sm text-gray-600 hover:bg-gray-50 transition-colors disabled:opacity-50",children:[i.jsx(br,{className:"w-3.5 h-3.5"}),"Role"]})}];return i.jsxs("div",{children:[i.jsx(ot,{title:"User Management",subtitle:"Manage user roles and permissions"}),i.jsx("div",{className:"flex items-center gap-3 mb-4",children:i.jsx("div",{className:"w-52",children:i.jsx(mn,{value:o,onChange:u,placeholder:"Search users..."})})}),i.jsx(an,{columns:T,data:y,emptyMessage:"No users found."}),i.jsx(Ze,{isOpen:!!d,onClose:()=>!m&&f(null),title:"Assign Role",footer:null,children:i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-700 block mb-2",children:"Role"}),m?i.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500 py-2",children:[i.jsx(Xe,{className:"w-4 h-4 animate-spin"}),"Updating role..."]}):i.jsx(Ys,{value:(v==null?void 0:v.role)||Yn.Staff,onChange:j=>_(j),options:w,placeholder:"Select role..."})]})})]})}function sv(){const r=rt(),[n,s]=A.useState(!1),[o,u]=A.useState({}),d=$=>r.departments.find(M=>M.id===$),f=$=>r.staff.find(M=>M.id===$),m=$=>r.functions.filter(M=>M.departmentId===$),p=$=>r.staff.filter(M=>M.departmentId===$),y=$=>{const M=m($).map(Y=>Y.id);return r.responsibilities.filter(Y=>M.includes(Y.functionId))},v=$=>r.teamMembers.filter(M=>M.teamId===$),b=r.grades.find($=>$.level===0),_=b?r.staff.find($=>$.gradeId===b.id):null,w=r.departments.map($=>{const M=Ks($,r.staff,r.grades,r.appSettings.maxManagerGradeLevel);return{...$,status:M}}),T=w.filter($=>$.status===Rt.Managed||$.status===Rt.Acting),j=w.filter($=>$.status===Rt.Unmanaged),E=()=>{if(n)u({}),s(!1);else{const $={};r.departments.forEach(M=>{$[M.id]=!0}),u($),s(!0)}},D=$=>{u(M=>({...M,[$]:!M[$]}))},V=({dept:$,isManaged:M})=>{const Y=$.managerId?f($.managerId):null,re=m($.id),K=p($.id),ve=y($.id),xe=o[$.id]||!1;return i.jsxs("div",{className:`bg-white rounded-lg border ${M?"border-gray-200":"border-red-200 border-dashed"} overflow-hidden`,children:[i.jsxs("div",{className:"p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:`w-2.5 h-2.5 rounded-full ${M?"bg-green-500":"bg-red-500"}`}),i.jsx("span",{className:"text-xs text-gray-400 font-mono",children:$.uid})]}),i.jsx(Le,{variant:M?"success":"error",children:M?"managed":"unmanaged"})]}),i.jsx("h3",{className:"font-semibold text-gray-900 text-sm",children:$.name}),i.jsx("p",{className:"text-xs text-gray-400 mt-0.5",children:Y?pt(Y):"No manager"}),i.jsxs("div",{className:"flex items-center gap-3 mt-3 text-xs text-gray-500",children:[i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx(Ui,{className:"w-3 h-3"}),re.length]}),i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx(br,{className:"w-3 h-3"}),K.length]}),i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx(ia,{className:"w-3 h-3"}),ve.length]})]})]}),i.jsxs("button",{onClick:()=>D($.id),className:"w-full flex items-center justify-center gap-1 py-2 border-t border-gray-100 text-xs text-gray-400 hover:bg-gray-50 transition-colors",children:[xe?i.jsx(ef,{className:"w-3 h-3"}):i.jsx(au,{className:"w-3 h-3"}),xe?"Hide functions":`${re.length} functions`]}),xe&&re.length>0&&i.jsx("div",{className:"border-t border-gray-100 px-4 py-2 space-y-1.5 bg-gray-50/50",children:re.map(_e=>i.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[i.jsx("span",{className:"text-gray-400 font-mono",children:_e.uid}),i.jsx("span",{className:"text-gray-700",children:_e.name}),_e.type===Nn.External?i.jsx(la,{className:"w-3 h-3 text-amber-500 ml-auto"}):i.jsx(ca,{className:"w-3 h-3 text-gray-400 ml-auto"})]},_e.id))})]})},z=({team:$})=>{const M=$.leadId?f($.leadId):null,Y=v($.id),K=[...Y.map(xe=>xe.staffId),$.leadId].filter(Boolean).flatMap(xe=>{const _e=f(xe);return _e?[_e.primaryFunctionId,_e.secondaryFunctionId,..._e.additionalFunctionIds||[]].filter(Boolean):[]}),ve=r.responsibilities.filter(xe=>K.includes(xe.functionId));return i.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[i.jsx("p",{className:"text-xs text-gray-400 font-mono mb-1",children:$.uid}),i.jsx("h3",{className:"font-semibold text-gray-900 text-sm",children:$.name}),i.jsxs("p",{className:"text-xs text-gray-400 mt-0.5",children:["Lead: ",M?pt(M):"No lead"]}),i.jsxs("div",{className:"flex items-center gap-3 mt-3 text-xs text-gray-500",children:[i.jsxs("span",{className:"flex items-center gap-1",title:"Members",children:[i.jsx(br,{className:"w-3 h-3"}),Y.length+(M?1:0)]}),i.jsxs("span",{className:"flex items-center gap-1",title:"Responsibilities",children:[i.jsx(ia,{className:"w-3 h-3"}),ve.length]})]})]})},q={};return r.crossFunctionalTeams.forEach($=>{const M=$.reportingDepartmentId;q[M]||(q[M]=[]),q[M].push($)}),i.jsxs("div",{children:[i.jsx(ot,{title:"Org Chart",subtitle:"Company hierarchy overview",action:i.jsx(Be,{onClick:E,variant:"secondary",icon:sf,children:n?"Collapse All":"Expand All"})}),_&&i.jsx("div",{className:"flex justify-center mb-6",children:i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute left-1/2 bottom-0 w-px h-6 bg-gray-200 translate-y-full"}),i.jsxs("div",{className:"bg-white rounded-xl border-2 border-blue-200 px-10 py-6 text-center shadow-sm",children:[i.jsx("div",{className:"w-14 h-14 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-3",children:i.jsxs("span",{className:"text-blue-600 font-bold text-lg",children:[_.firstName[0],_.lastName[0]]})}),i.jsx("p",{className:"font-semibold text-gray-900",children:pt(_)}),i.jsx("p",{className:"text-xs text-gray-400 mt-0.5",children:"MD"})]})]})}),T.length>0&&i.jsx("div",{className:"flex justify-center mb-2 mt-6",children:i.jsx("div",{className:"w-px h-6 bg-gray-200"})}),T.length>0&&i.jsx("div",{className:"mb-8",children:i.jsx("div",{className:"grid gap-4",style:{gridTemplateColumns:`repeat(${Math.min(T.length,5)}, minmax(0, 1fr))`},children:T.map($=>i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsx("div",{className:"w-px h-4 bg-gray-200 mb-2"}),i.jsx("div",{className:"w-full",children:i.jsx(V,{dept:$,isManaged:!0})})]},$.id))})}),j.length>0&&i.jsxs("div",{className:"mb-8 bg-red-50/40 rounded-xl border border-red-100 border-dashed p-5",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[i.jsx("span",{className:"w-2.5 h-2.5 rounded-full bg-red-500"}),i.jsx("span",{className:"text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Unmanaged Departments"}),i.jsx(Le,{variant:"error",children:j.length})]}),i.jsx("div",{className:"grid gap-4",style:{gridTemplateColumns:`repeat(${Math.min(j.length,5)}, minmax(0, 1fr))`},children:j.map($=>i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsx("div",{className:"w-px h-4 bg-gray-300 border-dashed mb-2",style:{borderLeft:"2px dashed #d1d5db"}}),i.jsx("div",{className:"w-full",children:i.jsx(V,{dept:$,isManaged:!1})})]},$.id))})]}),r.crossFunctionalTeams.length>0&&i.jsxs("div",{className:"bg-blue-50/30 rounded-xl border border-blue-100 border-dashed p-5",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[i.jsx(Fi,{className:"w-4 h-4 text-blue-500"}),i.jsx("span",{className:"text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Cross-Functional Teams"}),i.jsx(Le,{variant:"info",children:r.crossFunctionalTeams.length})]}),Object.entries(q).map(([$,M])=>{const Y=d($);return i.jsxs("div",{className:"mb-4 last:mb-0",children:[i.jsxs("p",{className:"text-xs text-gray-400 mb-2 flex items-center gap-1",children:[i.jsx("span",{className:"w-px h-3 bg-gray-300 inline-block"}),(Y==null?void 0:Y.name)||"Unknown"]}),i.jsx("div",{className:"grid gap-3 grid-cols-3",children:M.map(re=>i.jsx(z,{team:re},re.id))})]},$)})]})]})}function av(){const r=rt(),n=jt(),[s,o]=A.useState(""),[u,d]=A.useState("all"),[f,m]=A.useState("all"),[p,y]=A.useState(null),[v,b]=A.useState(""),[_,w]=A.useState(""),[T,j]=A.useState(""),[E,D]=A.useState(""),[V,z]=A.useState(!0),[q,$]=A.useState(""),M=A.useCallback(H=>r.departments.find(L=>L.id===H),[r.departments]),Y=A.useCallback(H=>r.functions.find(L=>L.id===H),[r.functions]),re=A.useCallback(H=>r.complianceTags.find(L=>L.id===H),[r.complianceTags]),K=A.useMemo(()=>r.responsibilities.filter(H=>H.isComplianceTagged),[r.responsibilities]),ve=K.length,xe=r.complianceTags.find(H=>H.name==="Annual"),_e=r.complianceTags.find(H=>H.name==="Transactional"),Ce=xe?K.filter(H=>H.complianceTagId===xe.id).length:0,Ie=_e?K.filter(H=>H.complianceTagId===_e.id).length:0,Re=K.filter(H=>H.sopLink&&H.sopLink.trim()!=="").length,ie=ve-Re,he=[{label:"Total Obligations",value:ve,icon:i.jsx(ca,{className:"w-5 h-5 text-blue-500"})},{label:"Annual",value:Ce,icon:i.jsx(Le,{variant:"info",children:"Annual"})},{label:"Transactional",value:Ie,icon:i.jsx(Le,{variant:"warning",children:"Transactional"})},{label:"SOP Coverage",value:`${Re}/${ve}`,icon:i.jsx(oa,{className:"w-5 h-5 text-blue-500"}),sub:ie>0?`${ie} missing`:"All covered"}],x=A.useMemo(()=>K.filter(H=>{if(s){const L=s.toLowerCase();if(!H.name.toLowerCase().includes(L)&&!(H.description||"").toLowerCase().includes(L))return!1}if(u!=="all"){const L=re(H.complianceTagId);if(!L||L.name.toLowerCase()!==u.toLowerCase())return!1}if(f!=="all"){const L=Y(H.functionId);if(!L||L.departmentId!==f)return!1}return!0}),[K,s,u,f,re,Y]),B=H=>{y(H),b(H.name),w(H.description||""),j(H.functionId),D(H.sopLink||""),z(H.isComplianceTagged),$(H.complianceTagId||"")},G=()=>{y(null)},C=()=>{!p||!v.trim()||(n({type:"UPDATE_RESPONSIBILITY",payload:{id:p.id,name:v.trim(),description:_.trim(),functionId:T,sopLink:E.trim(),isComplianceTagged:V,complianceTagId:V?q:null}}),G())},N=r.functions.map(H=>{const L=M(H.departmentId);return{id:H.id,label:`${H.name} (${(L==null?void 0:L.name)||""})`}}),ae=A.useMemo(()=>[...new Set(K.map(L=>{const te=re(L.complianceTagId);return te==null?void 0:te.name}).filter(L=>!!L))],[K,re]),me=A.useMemo(()=>[...new Set(K.map(L=>{const te=Y(L.functionId);return te==null?void 0:te.departmentId}).filter(L=>!!L))].map(L=>M(L)).filter(L=>!!L),[K,Y,M]),we=[{key:"uid",header:"UID",width:"60px",render:H=>i.jsx("span",{className:"text-gray-400 text-xs font-mono",children:H.uid})},{key:"name",header:"Responsibility",render:H=>i.jsxs("div",{children:[i.jsx("p",{className:"font-semibold text-blue-600 text-sm",children:H.name}),H.description&&i.jsx("p",{className:"text-xs text-gray-400 mt-0.5",children:H.description})]})},{key:"function",header:"Function / Team",render:H=>{const L=Y(H.functionId);return i.jsx("span",{className:"text-sm text-gray-700",children:(L==null?void 0:L.name)||""})}},{key:"department",header:"Department",render:H=>{const L=Y(H.functionId),te=L?M(L.departmentId):null;return i.jsx("span",{className:"text-sm text-gray-700",children:(te==null?void 0:te.name)||""})}},{key:"complianceType",header:"Compliance Type",render:H=>{const L=re(H.complianceTagId);return L?i.jsx(Le,{variant:L.name==="Annual"?"info":"warning",children:L.name}):i.jsx("span",{className:"text-gray-300",children:""})}},{key:"sop",header:"SOP",width:"80px",render:H=>H.sopLink&&H.sopLink.trim()!==""?i.jsx("a",{href:H.sopLink,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:text-blue-700",children:i.jsx(tf,{className:"w-4 h-4"})}):i.jsxs("span",{className:"flex items-center gap-1 text-amber-500 text-xs",children:[i.jsx(aa,{className:"w-3.5 h-3.5"})," Missing"]})},{key:"actions",header:"Actions",width:"60px",render:H=>i.jsx(gt,{icon:An,onClick:()=>B(H),title:"Edit"})}];return i.jsxs("div",{children:[i.jsx(ot,{title:"Compliance",subtitle:"All compliance-tagged obligations"}),i.jsx("div",{className:"mb-6",children:i.jsx(sn,{cards:he})}),i.jsxs("div",{className:"flex items-center gap-3 mb-4 flex-wrap",children:[i.jsx("div",{className:"w-52",children:i.jsx(mn,{value:s,onChange:o,placeholder:"Search obligations..."})}),i.jsxs("div",{className:"flex items-center gap-1.5",children:[i.jsx("span",{className:"text-xs text-gray-500",children:"Type:"}),i.jsxs("select",{value:u,onChange:H=>d(H.target.value),className:"px-2 py-1.5 border border-gray-200 rounded-lg text-sm bg-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"all",children:"All"}),ae.map(H=>i.jsx("option",{value:H,children:H},H))]})]}),i.jsxs("div",{className:"flex items-center gap-1.5",children:[i.jsx("span",{className:"text-xs text-gray-500",children:"Department:"}),i.jsxs("select",{value:f,onChange:H=>m(H.target.value),className:"px-2 py-1.5 border border-gray-200 rounded-lg text-sm bg-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"all",children:"All"}),me.map(H=>i.jsx("option",{value:H.id,children:H.name},H.id))]})]})]}),i.jsx(an,{columns:we,data:x,emptyMessage:"No compliance obligations found."}),i.jsx(Ze,{isOpen:!!p,onClose:G,title:"Edit Responsibility",footer:i.jsxs(i.Fragment,{children:[i.jsx(Be,{variant:"secondary",onClick:G,children:"Cancel"}),i.jsx(Be,{onClick:C,children:"Save Changes"})]}),children:p&&i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-700 block mb-1.5",children:"Name"}),i.jsx("input",{type:"text",value:v,onChange:H=>b(H.target.value),className:"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-700 block mb-1.5",children:"Description"}),i.jsx("textarea",{value:_,onChange:H=>w(H.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 resize-y"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-700 block mb-1.5",children:"Function"}),i.jsx("select",{value:T,onChange:H=>j(H.target.value),className:"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm bg-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:N.map(H=>i.jsx("option",{value:H.id,children:H.label},H.id))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-700 block mb-1.5",children:"SOP Link"}),i.jsx("input",{type:"text",value:E,onChange:H=>D(H.target.value),placeholder:"https://sop.acme.ae/...",className:"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("button",{onClick:()=>z(!V),className:`w-10 h-5 rounded-full transition-colors relative ${V?"bg-blue-600":"bg-gray-300"}`,children:i.jsx("span",{className:`absolute top-0.5 w-4 h-4 bg-white rounded-full shadow transition-transform ${V?"left-5":"left-0.5"}`})}),i.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Compliance required"})]}),V&&i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-700 block mb-1.5",children:"Compliance Type"}),i.jsxs("select",{value:q,onChange:H=>$(H.target.value),className:"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm bg-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[i.jsx("option",{value:"",children:"Select type"}),r.complianceTags.map(H=>i.jsx("option",{value:H.id,children:H.name},H.id))]})]})]})})]})}function uf({steps:r,responsibilities:n,functions:s,departments:o}){const u=[...r].sort((p,y)=>p.stepOrder-y.stepOrder),d=p=>n.find(y=>y.id===p),f=p=>s.find(y=>y.id===p),m=p=>o.find(y=>y.id===p);return i.jsxs("div",{className:"flex items-center gap-2 overflow-x-auto py-4 px-2",children:[i.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[i.jsxs("div",{className:"flex items-center gap-1.5 px-3 py-1.5 rounded-full border-2 border-blue-400 bg-blue-50 text-blue-600 text-xs font-bold whitespace-nowrap",children:[i.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500"}),"START"]}),i.jsx(Th,{className:"w-4 h-4 text-gray-300 flex-shrink-0"})]}),u.map(p=>{const y=d(p.responsibilityId),v=y?f(y.functionId):null,b=v?m(v.departmentId):null;return i.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[i.jsxs("div",{className:"border border-blue-200 rounded-lg px-4 py-2.5 bg-white min-w-[180px]",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-xs text-blue-500 font-semibold",children:p.stepOrder}),i.jsx("span",{className:"text-sm font-semibold text-gray-900",children:(y==null?void 0:y.name)||"Unknown"})]}),i.jsxs("p",{className:"text-xs text-gray-500 mt-0.5",children:[(v==null?void 0:v.name)||"-"," - ",(b==null?void 0:b.name)||"-"]})]}),i.jsx(Th,{className:"w-4 h-4 text-gray-300 flex-shrink-0"})]},p.id)}),i.jsxs("div",{className:"flex items-center gap-1.5 px-3 py-1.5 rounded-full border-2 border-green-400 bg-green-50 text-green-600 text-xs font-bold whitespace-nowrap flex-shrink-0",children:[i.jsx(rn,{className:"w-3 h-3"}),"END"]})]})}function iv(){var j;const r=rt(),[n,s]=A.useState(""),[o,u]=A.useState(null),d=E=>r.departments.find(D=>D.id===E),f=E=>r.workflowSteps.filter(D=>D.workflowId===E),m=r.workflows.filter(E=>E.status===En.Active).length,p=r.workflows.filter(E=>E.status===En.Draft).length,y=new Set(r.workflows.map(E=>E.ownerDepartmentId)).size,v=[{label:"Total Workflows",value:r.workflows.length,icon:i.jsx(Ii,{className:"w-5 h-5 text-blue-500"})},{label:"Active",value:m,icon:i.jsx(rn,{className:"w-5 h-5 text-green-500"})},{label:"Drafts",value:p,icon:i.jsx(oa,{className:"w-5 h-5 text-gray-400"})},{label:"Departments",value:y,icon:i.jsx(Cn,{className:"w-5 h-5 text-blue-500"})}],b=A.useMemo(()=>r.workflows.filter(E=>!(n&&!E.name.toLowerCase().includes(n.toLowerCase())&&!E.description.toLowerCase().includes(n.toLowerCase()))),[r.workflows,n]),_=[{key:"uid",header:"UID",render:E=>i.jsx("span",{className:"text-gray-400 text-xs font-mono",children:E.uid})},{key:"name",header:"Name",render:E=>i.jsx("button",{onClick:()=>u(E),className:"text-blue-600 hover:text-blue-800 font-medium text-sm hover:underline text-left",children:E.name})},{key:"description",header:"Description",render:E=>i.jsx("span",{className:"text-sm text-gray-600",children:E.description})},{key:"ownerDept",header:"Owner Dept",render:E=>{var D;return i.jsx("span",{className:"text-sm",children:((D=d(E.ownerDepartmentId))==null?void 0:D.name)||"-"})}},{key:"status",header:"Status",render:E=>i.jsx(Le,{variant:E.status===En.Active?"success":"warning",children:E.status})},{key:"steps",header:"Steps",render:E=>i.jsx("span",{className:"text-sm text-gray-600",children:f(E.id).length})}],w=o,T=w?f(w.id):[];return i.jsxs("div",{children:[i.jsx(ot,{title:"Workflows",subtitle:"Overview of all workflows across departments"}),i.jsx("div",{className:"mb-6",children:i.jsx(sn,{cards:v})}),i.jsx("div",{className:"flex items-center gap-3 mb-4",children:i.jsx("div",{className:"w-52",children:i.jsx(mn,{value:n,onChange:s,placeholder:"Search workflows..."})})}),i.jsx(an,{columns:_,data:b,emptyMessage:"No workflows found."}),i.jsx(Ze,{isOpen:!!w,onClose:()=>u(null),title:"Workflow Details",width:"max-w-2xl",footer:null,children:w&&i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-bold text-gray-900",children:w.name}),i.jsx("p",{className:"text-sm text-gray-500 mt-1",children:w.description}),i.jsxs("div",{className:"flex items-center gap-3 mt-3",children:[i.jsxs("div",{className:"flex items-center gap-1.5 text-sm text-gray-600",children:[i.jsx(Cn,{className:"w-4 h-4 text-gray-400"}),((j=d(w.ownerDepartmentId))==null?void 0:j.name)||"-"]}),i.jsx(Le,{variant:w.status===En.Active?"success":"warning",children:w.status})]}),i.jsx("div",{className:"mt-4 border-t border-gray-100 pt-4",children:i.jsx(uf,{workflow:w,steps:T,responsibilities:r.responsibilities,functions:r.functions,departments:r.departments})})]})})]})}function ov(){const r=rt(),n=jt(),s=Vt(),[o,u]=A.useState(""),[d,f]=A.useState(null),[m,p]=A.useState(null),[y,v]=A.useState(null),[b,_]=A.useState(!1),[w,T]=A.useState(""),[j,E]=A.useState(""),[D,V]=A.useState(""),[z,q]=A.useState(En.Draft),[$,M]=A.useState([]),[Y,re]=A.useState(""),K=L=>r.departments.find(te=>te.id===L),ve=L=>r.responsibilities.find(te=>te.id===L),xe=L=>r.functions.find(te=>te.id===L),_e=L=>r.workflowSteps.filter(te=>te.workflowId===L),Ce=A.useMemo(()=>r.workflows.filter(L=>!(o&&!L.name.toLowerCase().includes(o.toLowerCase())&&!L.description.toLowerCase().includes(o.toLowerCase()))),[r.workflows,o]),Ie=r.workflows.find(L=>L.id===d),Re=Ie?_e(Ie.id):[],ie=()=>{var L;T(""),E(""),V(((L=r.departments[0])==null?void 0:L.id)||""),q(En.Draft),M([]),re(""),p("add"),v(null)},he=L=>{const te=_e(L.id).sort((O,Z)=>O.stepOrder-Z.stepOrder);T(L.name),E(L.description||""),V(L.ownerDepartmentId),q(L.status),M(te.map((O,Z)=>({tempId:Ri(),responsibilityId:O.responsibilityId,stepOrder:Z+1}))),re(""),p("edit"),v(L)},x=()=>{b||(p(null),v(null))},B=()=>{Y&&(M(L=>[...L,{tempId:Ri(),responsibilityId:Y,stepOrder:L.length+1}]),re(""))},G=L=>{M(te=>te.filter(O=>O.tempId!==L).map((O,Z)=>({...O,stepOrder:Z+1})))},C=(L,te)=>{const O=[...$],Z=L+te;if(Z<0||Z>=O.length)return;const Te=O[L];O[L]=O[Z],O[Z]=Te,M(O.map((Pe,$e)=>({...Pe,stepOrder:$e+1})))},N=async()=>{if(!w.trim()||!D)return;_(!0);const{data:L,error:te}=await Se.create("workflow",{name:w.trim(),description:j.trim(),ownerDepartmentId:D,status:z});if(te||!L){_(!1),s(`Failed to create workflow: ${te??"Unknown error"}`,"error");return}let O=[];if($.length>0){const Z=$.map($e=>({workflow_id:L.id,responsibility_id:$e.responsibilityId,step_order:$e.stepOrder})),{data:Te,error:Pe}=await Ye.from("workflow_step").insert(Z).select();if(Pe){_(!1),s(`Workflow created, but failed to add steps: ${Pe.message}`,"error"),n({type:"ADD_WORKFLOW",payload:{workflow:L,steps:[]}}),x();return}O=Te.map($e=>kt($e))}_(!1),n({type:"ADD_WORKFLOW",payload:{workflow:L,steps:O}}),s("Workflow created","success"),x()},ae=async()=>{if(!w.trim()||!D||!y)return;_(!0);const{data:L,error:te}=await Se.update("workflow",y.id,{name:w.trim(),description:j.trim(),ownerDepartmentId:D,status:z});if(te||!L){_(!1),s(`Failed to update workflow: ${te??"Unknown error"}`,"error");return}const{error:O}=await Ye.from("workflow_step").delete().eq("workflow_id",y.id);if(O){_(!1),s(`Workflow updated, but failed to update steps: ${O.message}`,"error");return}let Z=[];if($.length>0){const Te=$.map(U=>({workflow_id:y.id,responsibility_id:U.responsibilityId,step_order:U.stepOrder})),{data:Pe,error:$e}=await Ye.from("workflow_step").insert(Te).select();if($e){_(!1),s(`Workflow updated, but failed to add steps: ${$e.message}`,"error"),n({type:"UPDATE_WORKFLOW",payload:{workflow:L,steps:[]}}),x();return}Z=Pe.map(U=>kt(U))}_(!1),n({type:"UPDATE_WORKFLOW",payload:{workflow:L,steps:Z}}),s("Workflow updated","success"),x()},me=()=>{if(m==="add")return N();if(m==="edit")return ae()},we=async L=>{_(!0);const{error:te}=await Se.remove("workflow",L.id);if(_(!1),te){s(`Failed to delete workflow: ${te}`,"error");return}n({type:"DELETE_WORKFLOW",payload:L.id}),d===L.id&&f(null),s("Workflow deleted","success")},H=r.responsibilities.map(L=>{const te=xe(L.functionId),O=te?K(te.departmentId):null;return{value:L.id,label:`${L.name} (${(te==null?void 0:te.name)||"-"} - ${(O==null?void 0:O.name)||"-"})`}});return i.jsxs("div",{children:[i.jsx(ot,{title:"Workflow Manager",subtitle:"Create and manage workflow sequences",action:i.jsx(Be,{onClick:ie,icon:hn,children:"New Workflow"})}),i.jsxs("div",{className:"flex items-start gap-2 mb-5 text-sm text-gray-500",children:[i.jsx(aa,{className:"w-4 h-4 text-gray-400 mt-0.5 flex-shrink-0"}),i.jsxs("span",{children:["To create workflows, your grade must be ","<="," Manager (max manager grade)"]})]}),i.jsx("div",{className:"bg-white rounded-lg border border-gray-200 mb-6 min-h-[120px] flex items-center justify-center",children:Ie?i.jsx(uf,{workflow:Ie,steps:Re,responsibilities:r.responsibilities,functions:r.functions,departments:r.departments}):i.jsxs("div",{className:"text-center py-8",children:[i.jsx(Ii,{className:"w-8 h-8 text-gray-300 mx-auto mb-2"}),i.jsx("p",{className:"text-sm text-gray-400",children:"Select a workflow below to view its diagram"})]})}),i.jsx("div",{className:"flex items-center gap-3 mb-4",children:i.jsx("div",{className:"w-52",children:i.jsx(mn,{value:o,onChange:u,placeholder:"Search workflows..."})})}),i.jsxs("div",{className:"space-y-2",children:[Ce.length===0&&i.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:i.jsx("p",{className:"text-gray-400 text-sm",children:"No workflows found."})}),Ce.map(L=>{const te=_e(L.id).length,O=d===L.id;return i.jsxs("div",{onClick:()=>f(O?null:L.id),className:`bg-white rounded-lg border p-4 flex items-center gap-4 cursor-pointer transition-colors ${O?"border-blue-400 bg-blue-50/30":"border-gray-200 hover:border-gray-300"}`,children:[i.jsx(Ii,{className:"w-5 h-5 text-gray-400 flex-shrink-0"}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"font-semibold text-gray-900 text-sm",children:L.name}),i.jsxs(Le,{variant:"neutral",children:[te," step",te!==1?"s":""]})]}),i.jsx("p",{className:"text-xs text-gray-500 mt-0.5 truncate",children:L.description})]}),i.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",onClick:Z=>Z.stopPropagation(),children:[i.jsx(gt,{icon:An,onClick:()=>he(L),title:"Edit"}),i.jsx(gt,{icon:fn,onClick:()=>we(L),variant:"danger",title:"Delete"})]})]},L.id)})]}),i.jsx(Ze,{isOpen:m==="add"||m==="edit",onClose:x,title:m==="add"?"New Workflow":"Edit Workflow",width:"max-w-lg",footer:i.jsxs(i.Fragment,{children:[i.jsx(Be,{variant:"secondary",onClick:x,disabled:b,children:"Cancel"}),i.jsxs(Be,{onClick:me,disabled:!w.trim()||!D||b,children:[b&&i.jsx(Xe,{className:"w-4 h-4 animate-spin"}),b?"Saving...":m==="add"?"Create Workflow":"Save Changes"]})]}),children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-700 block mb-1.5",children:"Name"}),i.jsx("input",{type:"text",value:w,onChange:L=>T(L.target.value),placeholder:"e.g. Tenant Onboarding",className:"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:b})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-700 block mb-1.5",children:"Description"}),i.jsx("textarea",{value:j,onChange:L=>E(L.target.value),placeholder:"Purpose of this workflow",rows:3,className:"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 resize-y",disabled:b})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-700 block mb-1.5",children:"Owner Department"}),i.jsx(Ys,{value:D,onChange:L=>V(L),options:r.departments.map(L=>({value:L.id,label:L.name})),placeholder:"Select department"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium text-gray-700 block mb-1.5",children:"Status"}),i.jsx(Ys,{value:z,onChange:L=>q(L),options:[{value:En.Draft,label:"Draft"},{value:En.Active,label:"Active"}],placeholder:"Select status"})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"text-sm font-medium text-gray-700 block mb-1.5",children:["Steps (",$.length,")"]}),i.jsxs("div",{className:"border border-gray-100 rounded-lg",children:[$.length>0&&i.jsx("div",{className:"divide-y divide-gray-50",children:$.map((L,te)=>{const O=ve(L.responsibilityId),Z=O?xe(O.functionId):null,Te=Z?K(Z.departmentId):null;return i.jsxs("div",{className:"flex items-center gap-3 px-3 py-2.5",children:[i.jsx("span",{className:"text-xs font-semibold text-gray-400 w-4 text-center",children:L.stepOrder}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("p",{className:"text-sm font-medium text-gray-900",children:(O==null?void 0:O.name)||"Unknown"}),i.jsxs("p",{className:"text-xs text-gray-500",children:[(Z==null?void 0:Z.name)||"-"," - ",(Te==null?void 0:Te.name)||"-"]})]}),i.jsxs("div",{className:"flex items-center gap-0.5 flex-shrink-0",children:[i.jsx("button",{onClick:()=>C(te,-1),disabled:te===0||b,className:"p-1 text-gray-400 hover:text-gray-600 disabled:opacity-30",children:i.jsx(ef,{className:"w-3.5 h-3.5"})}),i.jsx("button",{onClick:()=>C(te,1),disabled:te===$.length-1||b,className:"p-1 text-gray-400 hover:text-gray-600 disabled:opacity-30",children:i.jsx(au,{className:"w-3.5 h-3.5"})}),i.jsx("button",{onClick:()=>G(L.tempId),disabled:b,className:"p-1 text-red-400 hover:text-red-600 ml-1 disabled:opacity-30",children:i.jsx(tr,{className:"w-3.5 h-3.5"})})]})]},L.tempId)})}),i.jsxs("div",{className:"flex items-center gap-2 px-3 py-2.5 border-t border-gray-100",children:[i.jsx("div",{className:"flex-1",children:i.jsx(Ys,{value:Y,onChange:L=>re(L),options:H,placeholder:"Select responsibility to add"})}),i.jsx("button",{onClick:B,disabled:!Y||b,className:"p-2 text-blue-500 hover:text-blue-700 hover:bg-blue-50 rounded-lg transition-colors disabled:opacity-30",children:i.jsx(hn,{className:"w-4 h-4"})})]})]})]})]})})]})}function ql({size:r=40,className:n=""}){return i.jsx("div",{className:`flex items-center justify-center ${n}`,style:{width:r,height:r},children:i.jsxs("svg",{viewBox:"0 0 100 100",width:r,height:r,children:[i.jsx("rect",{x:"10",y:"35",width:"35",height:"55",rx:"3",fill:"#3B82F6",stroke:"#2563EB",strokeWidth:"2"}),i.jsx("rect",{x:"18",y:"45",width:"8",height:"6",rx:"1",fill:"#93C5FD"}),i.jsx("rect",{x:"30",y:"45",width:"8",height:"6",rx:"1",fill:"#93C5FD"}),i.jsx("rect",{x:"18",y:"56",width:"8",height:"6",rx:"1",fill:"#93C5FD"}),i.jsx("rect",{x:"30",y:"56",width:"8",height:"6",rx:"1",fill:"#93C5FD"}),i.jsx("rect",{x:"18",y:"67",width:"8",height:"6",rx:"1",fill:"#93C5FD"}),i.jsx("polygon",{points:"55,10 90,35 55,35",fill:"#3B82F6",stroke:"#2563EB",strokeWidth:"2"}),i.jsx("rect",{x:"55",y:"35",width:"35",height:"55",rx:"3",fill:"#3B82F6",stroke:"#2563EB",strokeWidth:"2"}),i.jsx("rect",{x:"63",y:"45",width:"8",height:"6",rx:"1",fill:"#93C5FD"}),i.jsx("rect",{x:"75",y:"45",width:"8",height:"6",rx:"1",fill:"#93C5FD"}),i.jsx("rect",{x:"63",y:"56",width:"8",height:"6",rx:"1",fill:"#93C5FD"}),i.jsx("rect",{x:"75",y:"56",width:"8",height:"6",rx:"1",fill:"#93C5FD"}),i.jsx("rect",{x:"63",y:"67",width:"8",height:"6",rx:"1",fill:"#93C5FD"}),i.jsx("path",{d:"M 15 78 Q 25 65 40 80 Q 55 90 75 72 Q 85 65 92 70",stroke:"#F59E0B",strokeWidth:"4",fill:"none",strokeLinecap:"round"})]})})}function lv(){var V,z;const r=rt(),[n,s]=A.useState(((V=r.staff[1])==null?void 0:V.id)||((z=r.staff[0])==null?void 0:z.id)||""),[o,u]=A.useState("card"),[d,f]=A.useState(!1),m=r.staff.find(q=>q.id===n),p=m?r.departments.find(q=>q.id===m.departmentId):null,y=m?r.grades.find(q=>q.id===m.gradeId):null,v=m?r.functions.find(q=>q.id===m.primaryFunctionId):null,b=m?Oi(m,r.appSettings):"",_=m?of(m):"",w=y&&v?`${y.name}, ${v.name}`:v?v.name:"",T=m?pt(m):"",j=r.companyProfile,E=r.staff.map(q=>{const $=r.departments.find(M=>M.id===q.departmentId);return{value:q.id,label:`${pt(q)} - ${($==null?void 0:$.name)||""}`}}),D=()=>{const q=[T,`${w} - ${(p==null?void 0:p.name)||""}`,`Email: ${b}`,`Phone: ${_}`,`Web: ${j.website}`,`${j.name} - ${j.location}`].join(`
`);navigator.clipboard.writeText(q).then(()=>{f(!0),setTimeout(()=>f(!1),2e3)}).catch(()=>{})};return i.jsxs("div",{children:[i.jsx(ot,{title:"Email & Card Creator",subtitle:"Generate business cards and email signatures for staff"}),i.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-5 mb-6",children:i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("label",{className:"text-sm font-medium text-gray-700 whitespace-nowrap",children:"Select Staff Member:"}),i.jsx("div",{className:"w-80",children:i.jsx("select",{value:n,onChange:q=>s(q.target.value),className:"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm bg-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:E.map(q=>i.jsx("option",{value:q.value,children:q.label},q.value))})})]})}),i.jsxs("div",{className:"flex gap-0 mb-6 border-b border-gray-200",children:[i.jsxs("button",{onClick:()=>u("card"),className:`flex items-center gap-2 px-4 py-2.5 text-sm font-medium border-b-2 transition-colors -mb-px ${o==="card"?"border-blue-600 text-blue-700":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[i.jsx(oa,{className:"w-4 h-4"})," Business Card"]}),i.jsxs("button",{onClick:()=>u("signature"),className:`flex items-center gap-2 px-4 py-2.5 text-sm font-medium border-b-2 transition-colors -mb-px ${o==="signature"?"border-blue-600 text-blue-700":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[i.jsx(ss,{className:"w-4 h-4"})," Email Signature"]})]}),o==="card"&&m&&i.jsxs("div",{className:"flex flex-col items-center gap-6",children:[i.jsx("div",{className:"w-[420px] h-[250px] rounded-xl overflow-hidden shadow-lg",style:{background:"linear-gradient(135deg, #3B82F6 0%, #1D4ED8 100%)"},children:i.jsxs("div",{className:"p-6 h-full flex flex-col justify-between text-white relative",children:[i.jsx("div",{className:"absolute top-5 right-5",children:i.jsx(ql,{size:44})}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-xl font-bold",children:T}),i.jsx("p",{className:"text-blue-100 text-sm mt-0.5",children:w}),i.jsx("p",{className:"text-blue-200 text-xs mt-0.5",children:(p==null?void 0:p.name)||""})]}),i.jsxs("div",{className:"space-y-1.5",children:[i.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[i.jsx(ss,{className:"w-3.5 h-3.5 text-blue-200"}),i.jsx("span",{className:"text-blue-50",children:b})]}),i.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[i.jsx(er,{className:"w-3.5 h-3.5 text-blue-200"}),i.jsx("span",{className:"text-blue-50",children:_})]}),i.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[i.jsx(la,{className:"w-3.5 h-3.5 text-blue-200"}),i.jsx("span",{className:"text-blue-50",children:j.website})]})]})]})}),i.jsx("div",{className:"w-[420px] h-[250px] rounded-xl overflow-hidden shadow-lg bg-white border border-gray-200",children:i.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-center p-6",children:[i.jsx(ql,{size:56,className:"mb-4"}),i.jsx("h4",{className:"text-lg font-bold text-gray-900",children:j.name}),i.jsx("p",{className:"text-sm text-gray-500 mt-1",children:j.location}),i.jsx("p",{className:"text-sm text-gray-400 mt-0.5",children:j.website})]})}),i.jsx("p",{className:"text-xs text-gray-400 mt-2",children:'Front and back preview - print-ready at 3.5" x 2"'})]}),o==="signature"&&m&&i.jsxs("div",{children:[i.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-5",children:[i.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Signature Preview"}),i.jsx(Be,{variant:"secondary",icon:d?rn:oa,onClick:D,children:d?"Copied!":"Copy Signature"})]}),i.jsx("div",{className:"border border-gray-200 rounded-lg p-5",children:i.jsxs("div",{className:"flex items-start gap-4",children:[i.jsx(ql,{size:48,className:"flex-shrink-0"}),i.jsxs("div",{className:"space-y-1.5",children:[i.jsx("p",{className:"font-bold text-gray-900",children:T}),i.jsxs("p",{className:"text-sm text-gray-600",children:[w," - ",(p==null?void 0:p.name)||""]}),i.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[i.jsx(ss,{className:"w-3.5 h-3.5 text-gray-400"}),i.jsx("span",{children:b})]}),i.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[i.jsx(er,{className:"w-3.5 h-3.5 text-gray-400"}),i.jsx("span",{children:_})]}),i.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[i.jsx(la,{className:"w-3.5 h-3.5 text-gray-400"}),i.jsx("a",{href:"#",className:"text-blue-600 hover:underline",children:j.website})]}),i.jsxs("p",{className:"text-xs text-gray-400 pt-1",children:[j.name," - ",j.location]})]})]})})]}),i.jsx("p",{className:"text-xs text-gray-400 mt-4",children:`Click "Copy Signature" and paste into your email client's signature settings (Gmail, Outlook, etc.)`})]}),!m&&i.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:i.jsx("p",{className:"text-gray-400 text-sm",children:"Select a staff member above to preview their business card and email signature."})})]})}function uv(){const r=rt(),n=jt(),[s,o]=A.useState(tt.Staff),[u,d]=A.useState(""),[f,m]=A.useState(""),[p,y]=A.useState("departments"),[v,b]=A.useState(""),_=r.companyNumberAllocations,w=new Set(_.map(x=>x.companyNumberId)),T=r.companyNumbers.filter(x=>!w.has(x.id)),j=r.companyNumbers.length,E=_.length,D=_.filter(x=>x.assignToType===tt.Department),V=_.filter(x=>x.assignToType===tt.Function),z=_.filter(x=>x.assignToType===tt.Staff),q=[{icon:i.jsx(er,{className:"w-5 h-5 text-gray-400"}),label:"Total / Available",value:`${j} / ${T.length}`,sub:`${E} allocated`},{icon:i.jsx(Cn,{className:"w-5 h-5 text-gray-400"}),label:"Department Lines",value:String(D.length),sub:`of ${r.departments.length} departments`},{icon:i.jsx(Ui,{className:"w-5 h-5 text-gray-400"}),label:"Function Lines",value:String(V.length),sub:`of ${r.functions.length} functions`},{icon:i.jsx(Fi,{className:"w-5 h-5 text-gray-400"}),label:"Staff Lines",value:String(z.length),sub:`of ${r.staff.length} staff`}],$=A.useMemo(()=>s===tt.Staff?r.staff.map(x=>{const B=r.departments.find(G=>G.id===x.departmentId);return{value:x.id,label:`${pt(x)} (${(B==null?void 0:B.name)||""})`}}):s===tt.Function?r.functions.map(x=>{const B=r.departments.find(G=>G.id===x.departmentId);return{value:x.id,label:`${x.name} (${(B==null?void 0:B.name)||""})`}}):s===tt.Department?r.departments.map(x=>({value:x.id,label:x.name})):[],[s,r.staff,r.functions,r.departments]),M=s===tt.Staff?"Staff Member":s===tt.Function?"Function":"Department",Y=()=>{if(!u||!f)return;const x={id:Ri(),companyNumberId:f,assignToType:s,staffId:s===tt.Staff?u:null,functionId:s===tt.Function?u:null,departmentId:s===tt.Department?u:null};n({type:"ALLOCATE_NUMBER",payload:x}),d(""),m("")},re=x=>{n({type:"RELEASE_NUMBER",payload:x})},K=x=>{o(x),d(""),m("")},ve=A.useMemo(()=>r.departments.map(x=>{const B=_.find(C=>C.assignToType===tt.Department&&C.departmentId===x.id),G=B?r.companyNumbers.find(C=>C.id===B.companyNumberId):null;return{id:x.id,name:x.name,phone:(G==null?void 0:G.phoneNumber)||null,allocationId:(B==null?void 0:B.id)||null}}).filter(x=>!v||x.name.toLowerCase().includes(v.toLowerCase())),[r.departments,_,r.companyNumbers,v]),xe=A.useMemo(()=>r.functions.map(x=>{const B=r.departments.find(we=>we.id===x.departmentId),G=_.find(we=>we.assignToType===tt.Function&&we.functionId===x.id),C=G?r.companyNumbers.find(we=>we.id===G.companyNumberId):null,N=(C==null?void 0:C.phoneNumber)||x.phone||null,ae=x.email||null,me=!!(N||ae);return{id:x.id,name:x.name,department:(B==null?void 0:B.name)||"-",type:x.type,phone:N,email:ae,hasContact:me,allocationId:(G==null?void 0:G.id)||null}}).filter(x=>!v||x.name.toLowerCase().includes(v.toLowerCase())||x.department.toLowerCase().includes(v.toLowerCase())),[r.functions,r.departments,_,r.companyNumbers,v]),_e=A.useMemo(()=>r.staff.map(x=>{const B=r.departments.find(N=>N.id===x.departmentId),G=_.find(N=>N.assignToType===tt.Staff&&N.staffId===x.id),C=G?r.companyNumbers.find(N=>N.id===G.companyNumberId):null;return{id:x.id,name:pt(x),department:(B==null?void 0:B.name)||"-",mobile:of(x),email:Oi(x,r.appSettings),companyPhone:(C==null?void 0:C.phoneNumber)||null,allocationId:(G==null?void 0:G.id)||null}}).filter(x=>!v||x.name.toLowerCase().includes(v.toLowerCase())||x.department.toLowerCase().includes(v.toLowerCase())),[r.staff,r.departments,_,r.companyNumbers,r.appSettings,v]),ie=p==="departments"?[{key:"name",header:"Department",render:x=>i.jsx("span",{className:"font-medium text-gray-900",children:x.name})},{key:"phone",header:"Phone",render:x=>i.jsx("span",{className:"text-sm text-gray-600 font-mono",children:x.phone||"-"})},{key:"status",header:"Status",render:x=>x.phone?i.jsx(Le,{variant:"info",children:"Assigned"}):i.jsx("span",{className:"text-gray-400 text-sm",children:"No number"})},{key:"action",header:"Action",render:x=>x.allocationId?i.jsx("button",{onClick:()=>re(x.allocationId),className:"text-sm text-blue-600 hover:text-blue-800 hover:underline",children:"Release"}):null}]:p==="functions"?[{key:"name",header:"Function",render:x=>i.jsx("span",{className:"font-medium text-gray-900",children:x.name})},{key:"department",header:"Department",render:x=>i.jsx("span",{className:"text-sm text-gray-600",children:x.department})},{key:"type",header:"Type",render:x=>i.jsx(Le,{variant:"neutral",children:x.type})},{key:"phone",header:"Phone",render:x=>i.jsx("span",{className:"text-sm text-gray-600 font-mono",children:x.phone||"-"})},{key:"email",header:"Email",render:x=>i.jsx("span",{className:"text-sm text-gray-600",children:x.email||"-"})},{key:"status",header:"Status",render:x=>x.hasContact?i.jsx(Le,{variant:"success",children:"Has contact"}):i.jsx("span",{className:"text-gray-400 text-sm",children:"No contact"})},{key:"action",header:"Action",render:x=>x.allocationId?i.jsx("button",{onClick:()=>re(x.allocationId),className:"text-sm text-blue-600 hover:text-blue-800 hover:underline",children:"Release"}):null}]:[{key:"name",header:"Name",render:x=>i.jsx("span",{className:"font-medium text-gray-900",children:x.name})},{key:"department",header:"Department",render:x=>i.jsx("span",{className:"text-sm text-gray-600",children:x.department})},{key:"phone",header:"Phone",render:x=>i.jsx("span",{className:"text-sm text-gray-600 font-mono",children:x.mobile})},{key:"email",header:"Email",render:x=>i.jsx("span",{className:"text-sm text-gray-600",children:x.email})},{key:"status",header:"Status",render:x=>x.companyPhone?i.jsx(Le,{variant:"info",children:"Assigned"}):i.jsx(Le,{variant:"info",children:"No phone"})},{key:"action",header:"Action",render:x=>x.allocationId?i.jsx("button",{onClick:()=>re(x.allocationId),className:"text-sm text-blue-600 hover:text-blue-800 hover:underline",children:"Release"}):null}],he=p==="departments"?ve:p==="functions"?xe:_e;return i.jsxs("div",{children:[i.jsx(ot,{title:"Contact Manager",subtitle:`Manage phone number allocations across ${j} defined company numbers`}),i.jsx("div",{className:"mb-6",children:i.jsx(sn,{cards:q})}),i.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-5 mb-6",children:[i.jsx("h3",{className:"text-base font-semibold text-gray-900 mb-4",children:"Allocate a Number"}),i.jsxs("div",{className:"flex items-end gap-4 flex-wrap",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1.5",children:"Step 1 - Assign To"}),i.jsxs("select",{value:s,onChange:x=>K(x.target.value),className:"px-3 py-2 border border-gray-200 rounded-lg text-sm bg-white focus:outline-none focus:ring-2 focus:ring-blue-500 w-40",children:[i.jsx("option",{value:tt.Staff,children:"Staff"}),i.jsx("option",{value:tt.Function,children:"Function"}),i.jsx("option",{value:tt.Department,children:"Department"})]})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-xs font-medium text-gray-500 mb-1.5",children:["Step 2 - ",M]}),i.jsxs("select",{value:u,onChange:x=>d(x.target.value),className:"px-3 py-2 border border-gray-200 rounded-lg text-sm bg-white focus:outline-none focus:ring-2 focus:ring-blue-500 w-64",children:[i.jsxs("option",{value:"",children:["Select ",M.toLowerCase()]}),$.map(x=>i.jsx("option",{value:x.value,children:x.label},x.value))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1.5",children:"Step 3 - Number"}),i.jsxs("select",{value:f,onChange:x=>m(x.target.value),disabled:T.length===0,className:"px-3 py-2 border border-gray-200 rounded-lg text-sm bg-white focus:outline-none focus:ring-2 focus:ring-blue-500 w-44 disabled:opacity-50",children:[i.jsx("option",{value:"",children:"Select number"}),T.map(x=>i.jsx("option",{value:x.id,children:x.phoneNumber},x.id))]})]}),i.jsx(Be,{onClick:Y,icon:er,disabled:!u||!f,children:"Allocate"})]})]}),i.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-5",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Contact Directory"}),i.jsx("div",{className:"w-52",children:i.jsx(mn,{value:v,onChange:b,placeholder:"Search..."})})]}),i.jsx("div",{className:"flex gap-0 mb-4 border-b border-gray-200",children:[{id:"departments",label:`Departments (${r.departments.length})`},{id:"functions",label:`Functions (${r.functions.length})`},{id:"staff",label:`Staff (${r.staff.length})`}].map(x=>i.jsx("button",{onClick:()=>y(x.id),className:`px-4 py-2 text-sm font-medium border-b-2 transition-colors -mb-px ${p===x.id?"border-blue-600 text-blue-700":"border-transparent text-gray-500 hover:text-gray-700"}`,children:x.label},x.id))}),he.length===0?i.jsx("div",{className:"p-8 text-center",children:i.jsx("p",{className:"text-sm text-gray-400",children:"No results found."})}):i.jsxs("table",{className:"w-full text-sm",children:[i.jsx("thead",{children:i.jsx("tr",{className:"border-b border-gray-100",children:ie.map(x=>i.jsx("th",{className:"px-4 py-3 text-left font-medium text-gray-500 whitespace-nowrap",children:x.header},x.key))})}),i.jsx("tbody",{children:he.map(x=>i.jsx("tr",{className:"border-b border-gray-50 hover:bg-gray-50/50 transition-colors",children:ie.map(B=>i.jsx("td",{className:"px-4 py-3 text-gray-700",children:B.render(x)},B.key))},x.id))})]})]})]})}const cv={"org-chart":{title:"Org Chart",subtitle:"Company hierarchy overview"},compliance:{title:"Compliance",subtitle:"All compliance-tagged obligations"},workflows:{title:"Workflows",subtitle:"Overview of all workflows across departments"},departments:{title:"Departments",subtitle:"Manage organisational departments and their managers"},functions:{title:"Functions",subtitle:"Manage functional areas within departments"},responsibilities:{title:"Responsibilities",subtitle:"All responsibilities across functions"},staff:{title:"Staff Directory",subtitle:"Manage staff profiles, grades, and function assignments"},"cross-functional-teams":{title:"Cross-Functional Teams",subtitle:"Manage teams that span across departments"},"workflow-manager":{title:"Workflow Manager",subtitle:"Create and manage workflow sequences"},"email-card-creator":{title:"Email & Card Creator",subtitle:"Generate business cards and email signatures for staff"},"contact-manager":{title:"Contact Manager",subtitle:"Manage phone number allocations"},"user-management":{title:"User Management",subtitle:"Manage user roles and permissions"}},dv={"org-chart":sv,compliance:av,workflows:iv,"workflow-manager":ov,departments:Yy,functions:Zy,responsibilities:ev,staff:tv,"cross-functional-teams":nv,"email-card-creator":lv,"contact-manager":uv,"compliance-tags":zy,grades:By,"email-format":qy,"manager-threshold":Vy,"company-numbers":Hy,"company-profile":Gy,"user-management":rv};function hv({pageId:r}){const n=dv[r];return n?i.jsx(n,{}):i.jsx(fv,{pageId:r})}function fv({pageId:r}){rt();const n=cv[r]??{title:r,subtitle:""};return i.jsxs("div",{children:[i.jsx(ot,{title:n.title,subtitle:n.subtitle}),i.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:i.jsxs("p",{className:"text-gray-400 text-sm",children:["Page not found: ",r]})})]})}class mv extends A.Component{constructor(s){super(s);Kd(this,"handleReload",()=>{this.setState({hasError:!1,error:null})});this.state={hasError:!1,error:null}}static getDerivedStateFromError(s){return{hasError:!0,error:s}}componentDidCatch(s,o){console.error("ErrorBoundary caught:",s,o.componentStack)}render(){return this.state.hasError?i.jsxs("div",{className:"flex flex-col items-center justify-center py-24 px-6 text-center",children:[i.jsx("div",{className:"w-14 h-14 rounded-full bg-red-50 flex items-center justify-center mb-4",children:i.jsx("svg",{className:"w-7 h-7 text-red-500",fill:"none",stroke:"currentColor",strokeWidth:2,viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v2m0 4h.01M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})})}),i.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-1",children:"Something went wrong"}),i.jsx("p",{className:"text-sm text-gray-500 mb-6 max-w-md",children:"An unexpected error occurred while rendering this page. You can try reloading the section or refreshing the browser."}),i.jsx("button",{onClick:this.handleReload,className:"px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700 transition-colors",children:"Reload"}),this.state.error&&i.jsx("pre",{className:"mt-6 text-xs text-gray-400 max-w-lg overflow-auto whitespace-pre-wrap",children:this.state.error.message})]}):this.props.children}}function pv(){return i.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:i.jsxs("div",{className:"text-center",children:[i.jsx(Xe,{className:"w-10 h-10 text-blue-500 animate-spin mx-auto mb-4"}),i.jsx("p",{className:"text-gray-600 text-sm",children:"Loading Seamless..."})]})})}function Rh({error:r,onRetry:n}){return i.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:i.jsxs("div",{className:"text-center max-w-md",children:[i.jsx(Oy,{className:"w-10 h-10 text-red-500 mx-auto mb-4"}),i.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Failed to load data"}),i.jsx("p",{className:"text-sm text-gray-600 mb-4",children:r}),i.jsxs("button",{onClick:n,className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700 transition-colors",children:[i.jsx(Cy,{className:"w-4 h-4"}),"Try Again"]})]})})}function gv({initialData:r}){const[n,s]=A.useReducer(py,r),[o,u]=A.useState(!0),[d,f]=A.useState("org-chart"),m=A.useCallback(w=>f(w),[]),p=A.useMemo(()=>({currentPage:d,navigate:m}),[d,m]),{toasts:y,showToast:v,dismissToast:b}=Dy(),_=A.useMemo(()=>({showToast:v}),[v]);return i.jsx(Qh.Provider,{value:n,children:i.jsx(Yh.Provider,{value:s,children:i.jsx(Xh.Provider,{value:p,children:i.jsxs(af.Provider,{value:_,children:[i.jsxs("div",{className:"min-h-screen bg-gray-50",children:[i.jsx(Uy,{isOpen:o}),i.jsx(Fy,{sidebarOpen:o,onToggleSidebar:()=>u(!o)}),i.jsx("main",{className:"pt-12 transition-all duration-200",style:{marginLeft:o?256:0},children:i.jsx("div",{className:"p-6",children:i.jsx(mv,{children:i.jsx(hv,{pageId:d})})})})]}),i.jsx($y,{toasts:y,onDismiss:b})]})})})})}function yv(){const{data:r,loading:n,error:s,refetch:o}=iy();return n?i.jsx(pv,{}):s?i.jsx(Rh,{error:s,onRetry:o}):r?i.jsx(gv,{initialData:r}):i.jsx(Rh,{error:"No data returned",onRetry:o})}function vv(){return i.jsx(X0,{children:i.jsx(ty,{children:i.jsx(yv,{})})})}const cf=document.getElementById("root");if(!cf)throw new Error("Root element not found");yp.createRoot(cf).render(i.jsx(A.StrictMode,{children:i.jsx(vv,{})}));
